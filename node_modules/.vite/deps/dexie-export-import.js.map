{
  "version": 3,
  "sources": ["../../.pnpm/tslib@2.3.1/node_modules/tslib/tslib.es6.js", "../../dexie-export-import/src/helpers.ts", "../../.pnpm/typeson@5.18.2_core-js-bundle@3.34.0_regenerator-runtime@0.13.11/node_modules/typeson/dist/typeson.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/node_modules/typeson/dist/typeson-esm.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/node_modules/base64-arraybuffer-es6/dist/base64-arraybuffer-es.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/user-object.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/presets/array-nonindex-keys.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/undef.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/primitive-objects.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/presets/special-numbers.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/nan.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/infinity.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/negative-infinity.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/date.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/regexp.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/map.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/set.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/arraybuffer.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/typed-arrays.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/dataview.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/intl-types.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/utils/stringArrayBuffer.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/file.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/bigint.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/bigint-object.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/cryptokey.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/presets/structured-cloning.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/imagedata.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/imagebitmap.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/filelist.js", "../../.pnpm/typeson-registry@1.0.0-alpha.39/node_modules/typeson-registry/types/blob.js", "../../.pnpm/base64-arraybuffer-es6@1.0.0/node_modules/base64-arraybuffer-es6/dist/base64-arraybuffer-es.js", "../../dexie-export-import/src/tson-typed-array.ts", "../../dexie-export-import/src/tson-arraybuffer.ts", "../../dexie-export-import/src/tson.ts", "../../dexie-export-import/src/export.ts", "../../dexie-export-import/src/json-structure.ts", "../../dexie-export-import/tools/build-configs/fake-stream.js", "../../.pnpm/github.com+dfahlander+clarinet@d1dc89f7e67488b16ad98b2464d29a9b3bc6f5ef/node_modules/clarinet/clarinet.js", "../../dexie-export-import/src/json-stream.ts", "../../dexie-export-import/src/import.ts", "../../dexie-export-import/src/dexie-export-import.ts"],
  "sourcesContent": ["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n", "import Dexie from 'dexie';\nimport { DexieExportedDatabase } from './json-structure';\n\nexport function getSchemaString(table: Dexie.Table<any, any>) {\n  const primKeyAndIndexes = [table.schema.primKey].concat(table.schema.indexes);\n  return primKeyAndIndexes.map(index => index.src).join(',');\n}\n\nexport function extractDbSchema(exportedDb: DexieExportedDatabase) {\n  const schema: {\n    [tableName: string]: string;\n  } = {};\n  for (const table of exportedDb.tables) {\n    schema[table.name] = table.schema;\n  }\n  return schema;\n}\n\n\n// Missing FileReaderSync type in standard typescript libs:\ninterface FileReaderSync {\n  readAsArrayBuffer(blob: Blob): ArrayBuffer;\n  readAsBinaryString(blob: Blob): string;\n  readAsDataURL(blob: Blob): string;\n  readAsText(blob: Blob, encoding?: string): string;\n}\ndeclare var FileReaderSync: {\n  prototype: FileReaderSync;\n  new(): FileReaderSync;\n};\n// -----------------------------------------------\n\nexport interface TypeMapper {\n  binary: ArrayBuffer;\n  text: string;\n}\n\nexport function readBlobAsync<T extends keyof TypeMapper>(blob: Blob, type: T): Promise<TypeMapper[T]> {\n  return new Promise<TypeMapper[T]>((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onabort = ev => reject(new Error(\"file read aborted\"));\n    reader.onerror = ev => reject((ev.target as any).error);\n    reader.onload = ev => resolve((ev.target as any).result);\n    if (type === 'binary')\n      reader.readAsArrayBuffer(blob);\n    else\n      reader.readAsText(blob);\n  });\n}\n\nexport function readBlobSync<T extends keyof TypeMapper>(blob: Blob, type: T): TypeMapper[T] {\n  if (typeof FileReaderSync === 'undefined') {\n    throw new Error('FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.');\n  }\n  const reader = new FileReaderSync(); // Requires worker environment\n  const data = type === 'binary' ?\n    reader.readAsArrayBuffer(blob) :\n    reader.readAsText(blob);\n\n  return data as TypeMapper[T];\n}\n", "(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.Typeson = factory());\n}(this, (function () { 'use strict';\n\n  function _typeof(obj) {\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function () {\n      var self = this,\n          args = arguments;\n      return new Promise(function (resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(Object(source), true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n      return;\n    }\n\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n  }\n\n  /**\n   * We keep this function minimized so if using two instances of this\n   *   library, where one is minimized and one is not, it will still work\n   *   with `hasConstructorOf`.\n   * With ES6 classes, we may be able to simply use `class TypesonPromise\n   *   extends Promise` and add a string tag for detection.\n   * @param {function} f\n   */\n  // eslint-disable-next-line max-len\n  // eslint-disable-next-line block-spacing, space-before-function-paren, space-before-blocks, space-infix-ops, semi, promise/avoid-new\n  var TypesonPromise = function TypesonPromise(f) {\n    _classCallCheck(this, TypesonPromise);\n\n    this.p = new Promise(f);\n  }; // eslint-disable-next-line max-len\n  // class TypesonPromise extends Promise {get[Symbol.toStringTag](){return 'TypesonPromise'};} // eslint-disable-line keyword-spacing, space-before-function-paren, space-before-blocks, block-spacing, semi\n\n\n  TypesonPromise.__typeson__type__ = 'TypesonPromise'; // Note: core-js-bundle provides a `Symbol` polyfill\n\n  /* istanbul ignore else */\n\n  if (typeof Symbol !== 'undefined') {\n    // Ensure `isUserObject` will return `false` for `TypesonPromise`\n    TypesonPromise.prototype[Symbol.toStringTag] = 'TypesonPromise';\n  }\n  /**\n   *\n   * @param {function} [onFulfilled]\n   * @param {function} [onRejected]\n   * @returns {TypesonPromise}\n   */\n\n\n  TypesonPromise.prototype.then = function (onFulfilled, onRejected) {\n    var _this = this;\n\n    return new TypesonPromise(function (typesonResolve, typesonReject) {\n      // eslint-disable-next-line promise/catch-or-return\n      _this.p.then(function (res) {\n        // eslint-disable-next-line promise/always-return\n        typesonResolve(onFulfilled ? onFulfilled(res) : res);\n      })[\"catch\"](function (res) {\n        return onRejected ? onRejected(res) : Promise.reject(res);\n      }).then(typesonResolve, typesonReject);\n    });\n  };\n  /**\n   *\n   * @param {function} onRejected\n   * @returns {TypesonPromise}\n   */\n\n\n  TypesonPromise.prototype[\"catch\"] = function (onRejected) {\n    return this.then(null, onRejected);\n  };\n  /**\n   *\n   * @param {Any} v\n   * @returns {TypesonPromise}\n   */\n\n\n  TypesonPromise.resolve = function (v) {\n    return new TypesonPromise(function (typesonResolve) {\n      typesonResolve(v);\n    });\n  };\n  /**\n   *\n   * @param {Any} v\n   * @returns {TypesonPromise}\n   */\n\n\n  TypesonPromise.reject = function (v) {\n    return new TypesonPromise(function (typesonResolve, typesonReject) {\n      typesonReject(v);\n    });\n  };\n\n  ['all', 'race'].forEach(function (meth) {\n    /**\n     *\n     * @param {Promise[]} promArr\n     * @returns {TypesonPromise}\n     */\n    TypesonPromise[meth] = function (promArr) {\n      return new TypesonPromise(function (typesonResolve, typesonReject) {\n        // eslint-disable-next-line promise/catch-or-return\n        Promise[meth](promArr.map(function (prom) {\n          return prom && prom.constructor && prom.constructor.__typeson__type__ === 'TypesonPromise' ? prom.p : prom;\n        })).then(typesonResolve, typesonReject);\n      });\n    };\n  });\n\n  var _ref = {},\n      toStr = _ref.toString,\n      hasOwn = {}.hasOwnProperty,\n      getProto = Object.getPrototypeOf,\n      fnToString = hasOwn.toString;\n  /**\n   * Second argument not in use internally, but provided for utility.\n   * @param {Any} v\n   * @param {boolean} catchCheck\n   * @returns {boolean}\n   */\n\n  function isThenable(v, catchCheck) {\n    return isObject(v) && typeof v.then === 'function' && (!catchCheck || typeof v[\"catch\"] === 'function');\n  }\n  /**\n   *\n   * @param {Any} val\n   * @returns {string}\n   */\n\n\n  function toStringTag(val) {\n    return toStr.call(val).slice(8, -1);\n  }\n  /**\n   * This function is dependent on both constructors\n   *   being identical so any minimization is expected of both.\n   * @param {Any} a\n   * @param {function} b\n   * @returns {boolean}\n   */\n\n\n  function hasConstructorOf(a, b) {\n    if (!a || _typeof(a) !== 'object') {\n      return false;\n    }\n\n    var proto = getProto(a);\n\n    if (!proto) {\n      return b === null;\n    }\n\n    var Ctor = hasOwn.call(proto, 'constructor') && proto.constructor;\n\n    if (typeof Ctor !== 'function') {\n      return b === null;\n    }\n\n    if (b === Ctor) {\n      return true;\n    }\n\n    if (b !== null && fnToString.call(Ctor) === fnToString.call(b)) {\n      return true;\n    }\n\n    if (typeof b === 'function' && typeof Ctor.__typeson__type__ === 'string' && Ctor.__typeson__type__ === b.__typeson__type__) {\n      return true;\n    }\n\n    return false;\n  }\n  /**\n   *\n   * @param {Any} val\n   * @returns {boolean}\n   */\n\n\n  function isPlainObject(val) {\n    // Mirrors jQuery's\n    if (!val || toStringTag(val) !== 'Object') {\n      return false;\n    }\n\n    var proto = getProto(val);\n\n    if (!proto) {\n      // `Object.create(null)`\n      return true;\n    }\n\n    return hasConstructorOf(val, Object);\n  }\n  /**\n   *\n   * @param {Any} val\n   * @returns {boolean}\n   */\n\n\n  function isUserObject(val) {\n    if (!val || toStringTag(val) !== 'Object') {\n      return false;\n    }\n\n    var proto = getProto(val);\n\n    if (!proto) {\n      // `Object.create(null)`\n      return true;\n    }\n\n    return hasConstructorOf(val, Object) || isUserObject(proto);\n  }\n  /**\n   *\n   * @param {Any} v\n   * @returns {boolean}\n   */\n\n\n  function isObject(v) {\n    return v && _typeof(v) === 'object';\n  }\n  /**\n   *\n   * @param {string} keyPathComponent\n   * @returns {string}\n   */\n\n\n  function escapeKeyPathComponent(keyPathComponent) {\n    return keyPathComponent.replace(/~/g, '~0').replace(/\\./g, '~1');\n  }\n  /**\n   *\n   * @param {string} keyPathComponent\n   * @returns {string}\n   */\n\n\n  function unescapeKeyPathComponent(keyPathComponent) {\n    return keyPathComponent.replace(/~1/g, '.').replace(/~0/g, '~');\n  }\n  /**\n   * @param {PlainObject|GenericArray} obj\n   * @param {string} keyPath\n   * @returns {Any}\n   */\n\n\n  function getByKeyPath(obj, keyPath) {\n    if (keyPath === '') {\n      return obj;\n    }\n\n    var period = keyPath.indexOf('.');\n\n    if (period > -1) {\n      var innerObj = obj[unescapeKeyPathComponent(keyPath.slice(0, period))];\n      return innerObj === undefined ? undefined : getByKeyPath(innerObj, keyPath.slice(period + 1));\n    }\n\n    return obj[unescapeKeyPathComponent(keyPath)];\n  }\n  /**\n   *\n   * @param {PlainObject} obj\n   * @param {string} keyPath\n   * @param {Any} value\n   * @returns {Any}\n   */\n\n\n  function setAtKeyPath(obj, keyPath, value) {\n    if (keyPath === '') {\n      return value;\n    }\n\n    var period = keyPath.indexOf('.');\n\n    if (period > -1) {\n      var innerObj = obj[unescapeKeyPathComponent(keyPath.slice(0, period))];\n      return setAtKeyPath(innerObj, keyPath.slice(period + 1), value);\n    }\n\n    obj[unescapeKeyPathComponent(keyPath)] = value;\n    return obj;\n  }\n  /**\n   *\n   * @param {external:JSON} value\n   * @returns {\"null\"|\"array\"|\"undefined\"|\"boolean\"|\"number\"|\"string\"|\n   *  \"object\"|\"symbol\"}\n   */\n\n\n  function getJSONType(value) {\n    return value === null ? 'null' : Array.isArray(value) ? 'array' : _typeof(value);\n  }\n\n  var keys = Object.keys,\n      isArray = Array.isArray,\n      hasOwn$1 = {}.hasOwnProperty,\n      internalStateObjPropsToIgnore = ['type', 'replaced', 'iterateIn', 'iterateUnsetNumeric'];\n  /**\n   * Handle plain object revivers first so reference setting can use\n   * revived type (e.g., array instead of object); assumes revived\n   * has same structure or will otherwise break subsequent references.\n   * @param {PlainObjectType} a\n   * @param {PlainObjectType} b\n   * @returns {1|-1|boolean}\n   */\n\n  function nestedPathsFirst(a, b) {\n    if (a.keypath === '') {\n      return -1;\n    }\n\n    var as = a.keypath.match(/\\./g) || 0;\n    var bs = b.keypath.match(/\\./g) || 0;\n\n    if (as) {\n      as = as.length;\n    }\n\n    if (bs) {\n      bs = bs.length;\n    }\n\n    return as > bs ? -1 : as < bs ? 1 : a.keypath < b.keypath ? -1 : a.keypath > b.keypath;\n  }\n  /**\n   * An instance of this class can be used to call `stringify()` and `parse()`.\n   * Typeson resolves cyclic references by default. Can also be extended to\n   * support custom types using the register() method.\n   *\n   * @class\n   * @param {{cyclic: boolean}} [options] - if cyclic (default true),\n   *   cyclic references will be handled gracefully.\n   */\n\n\n  var Typeson =\n  /*#__PURE__*/\n  function () {\n    function Typeson(options) {\n      _classCallCheck(this, Typeson);\n\n      this.options = options; // Replacers signature: replace (value). Returns falsy if not\n      //   replacing. Otherwise ['Date', value.getTime()]\n\n      this.plainObjectReplacers = [];\n      this.nonplainObjectReplacers = []; // Revivers: [{type => reviver}, {plain: boolean}].\n      //   Sample: [{'Date': value => new Date(value)}, {plain: false}]\n\n      this.revivers = {};\n      /** Types registered via `register()`. */\n\n      this.types = {};\n    }\n    /**\n    * @typedef {null|boolean|number|string|GenericArray|PlainObject} JSON\n    */\n\n    /**\n    * @callback JSONReplacer\n    * @param {\"\"|string} key\n    * @param {JSON} value\n    * @returns {number|string|boolean|null|PlainObject|undefined}\n    * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#The%20replacer%20parameter\n    */\n\n    /**\n     * Serialize given object to Typeson.\n     * Initial arguments work identical to those of `JSON.stringify`.\n     * The `replacer` argument has nothing to do with our replacers.\n     * @param {Any} obj\n     * @param {JSONReplacer|string[]} replacer\n     * @param {number|string} space\n     * @param {object} opts\n     * @returns {string|Promise} Promise resolves to a string\n     */\n\n\n    _createClass(Typeson, [{\n      key: \"stringify\",\n      value: function stringify(obj, replacer, space, opts) {\n        opts = _objectSpread2({}, this.options, {}, opts, {\n          stringification: true\n        });\n        var encapsulated = this.encapsulate(obj, null, opts);\n\n        if (isArray(encapsulated)) {\n          return JSON.stringify(encapsulated[0], replacer, space);\n        }\n\n        return encapsulated.then(function (res) {\n          return JSON.stringify(res, replacer, space);\n        });\n      }\n      /**\n       * Also sync but throws on non-sync result.\n       * @param {Any} obj\n       * @param {JSONReplacer|string[]} replacer\n       * @param {number|string} space\n       * @param {object} opts\n       * @returns {string}\n       */\n\n    }, {\n      key: \"stringifySync\",\n      value: function stringifySync(obj, replacer, space, opts) {\n        return this.stringify(obj, replacer, space, _objectSpread2({\n          throwOnBadSyncType: true\n        }, opts, {\n          sync: true\n        }));\n      }\n      /**\n       *\n       * @param {Any} obj\n       * @param {JSONReplacer|string[]} replacer\n       * @param {number|string} space\n       * @param {object} opts\n       * @returns {Promise<string>}\n       */\n\n    }, {\n      key: \"stringifyAsync\",\n      value: function stringifyAsync(obj, replacer, space, opts) {\n        return this.stringify(obj, replacer, space, _objectSpread2({\n          throwOnBadSyncType: true\n        }, opts, {\n          sync: false\n        }));\n      }\n      /**\n       * Parse Typeson back into an obejct.\n       * Initial arguments works identical to those of `JSON.parse()`.\n       * @param {string} text\n       * @param {function} reviver This JSON reviver has nothing to do with\n       *   our revivers.\n       * @param {object} opts\n       * @returns {external:JSON}\n       */\n\n    }, {\n      key: \"parse\",\n      value: function parse(text, reviver, opts) {\n        opts = _objectSpread2({}, this.options, {}, opts, {\n          parse: true\n        });\n        return this.revive(JSON.parse(text, reviver), opts);\n      }\n      /**\n      * Also sync but throws on non-sync result.\n      * @param {string} text\n      * @param {function} reviver This JSON reviver has nothing to do with\n      *   our revivers.\n      * @param {object} opts\n      * @returns {external:JSON}\n      */\n\n    }, {\n      key: \"parseSync\",\n      value: function parseSync(text, reviver, opts) {\n        return this.parse(text, reviver, _objectSpread2({\n          throwOnBadSyncType: true\n        }, opts, {\n          sync: true\n        }));\n      }\n      /**\n      * @param {string} text\n      * @param {function} reviver This JSON reviver has nothing to do with\n      *   our revivers.\n      * @param {object} opts\n      * @returns {Promise} Resolves to `external:JSON`\n      */\n\n    }, {\n      key: \"parseAsync\",\n      value: function parseAsync(text, reviver, opts) {\n        return this.parse(text, reviver, _objectSpread2({\n          throwOnBadSyncType: true\n        }, opts, {\n          sync: false\n        }));\n      }\n      /**\n       *\n       * @param {Any} obj\n       * @param {object} stateObj\n       * @param {object} [opts={}]\n       * @returns {string[]|false}\n       */\n\n    }, {\n      key: \"specialTypeNames\",\n      value: function specialTypeNames(obj, stateObj) {\n        var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        opts.returnTypeNames = true;\n        return this.encapsulate(obj, stateObj, opts);\n      }\n      /**\n       *\n       * @param {Any} obj\n       * @param {PlainObject} stateObj\n       * @param {PlainObject} [opts={}]\n       * @returns {Promise|GenericArray|PlainObject|string|false}\n       */\n\n    }, {\n      key: \"rootTypeName\",\n      value: function rootTypeName(obj, stateObj) {\n        var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        opts.iterateNone = true;\n        return this.encapsulate(obj, stateObj, opts);\n      }\n      /**\n       * Encapsulate a complex object into a plain Object by replacing\n       * registered types with plain objects representing the types data.\n       *\n       * This method is used internally by `Typeson.stringify()`.\n       * @param {Any} obj - Object to encapsulate.\n       * @param {PlainObject} stateObj\n       * @param {PlainObject} opts\n       * @returns {Promise|GenericArray|PlainObject|string|false}\n       */\n\n    }, {\n      key: \"encapsulate\",\n      value: function encapsulate(obj, stateObj, opts) {\n        opts = _objectSpread2({\n          sync: true\n        }, this.options, {}, opts);\n        var _opts = opts,\n            sync = _opts.sync;\n        var that = this,\n            types = {},\n            refObjs = [],\n            // For checking cyclic references\n        refKeys = [],\n            // For checking cyclic references\n        promisesDataRoot = []; // Clone the object deeply while at the same time replacing any\n        //   special types or cyclic reference:\n\n        var cyclic = 'cyclic' in opts ? opts.cyclic : true;\n        var _opts2 = opts,\n            encapsulateObserver = _opts2.encapsulateObserver;\n\n        var ret = _encapsulate('', obj, cyclic, stateObj || {}, promisesDataRoot);\n        /**\n         *\n         * @param {Any} ret\n         * @returns {GenericArray|PlainObject|string|false}\n         */\n\n\n        function finish(ret) {\n          // Add `$types` to result only if we ever bumped into a\n          //  special type (or special case where object has own `$types`)\n          var typeNames = Object.values(types);\n\n          if (opts.iterateNone) {\n            if (typeNames.length) {\n              return typeNames[0];\n            }\n\n            return Typeson.getJSONType(ret);\n          }\n\n          if (typeNames.length) {\n            if (opts.returnTypeNames) {\n              return _toConsumableArray(new Set(typeNames));\n            } // Special if array (or a primitive) was serialized\n            //   because JSON would ignore custom `$types` prop on it\n\n\n            if (!ret || !isPlainObject(ret) || // Also need to handle if this is an object with its\n            //   own `$types` property (to avoid ambiguity)\n            hasOwn$1.call(ret, '$types')) {\n              ret = {\n                $: ret,\n                $types: {\n                  $: types\n                }\n              };\n            } else {\n              ret.$types = types;\n            } // No special types\n\n          } else if (isObject(ret) && hasOwn$1.call(ret, '$types')) {\n            ret = {\n              $: ret,\n              $types: true\n            };\n          }\n\n          if (opts.returnTypeNames) {\n            return false;\n          }\n\n          return ret;\n        }\n        /**\n         *\n         * @param {Any} ret\n         * @param {GenericArray} promisesData\n         * @returns {Promise<Any>}\n         */\n\n\n        function checkPromises(_x, _x2) {\n          return _checkPromises.apply(this, arguments);\n        }\n        /**\n         *\n         * @param {object} stateObj\n         * @param {object} ownKeysObj\n         * @param {function} cb\n         * @returns {undefined}\n         */\n\n\n        function _checkPromises() {\n          _checkPromises = _asyncToGenerator(\n          /*#__PURE__*/\n          regeneratorRuntime.mark(function _callee2(ret, promisesData) {\n            var promResults;\n            return regeneratorRuntime.wrap(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    _context2.next = 2;\n                    return Promise.all(promisesData.map(function (pd) {\n                      return pd[1].p;\n                    }));\n\n                  case 2:\n                    promResults = _context2.sent;\n                    _context2.next = 5;\n                    return Promise.all(promResults.map(\n                    /*#__PURE__*/\n                    function () {\n                      var _ref = _asyncToGenerator(\n                      /*#__PURE__*/\n                      regeneratorRuntime.mark(function _callee(promResult) {\n                        var newPromisesData, _promisesData$splice, _promisesData$splice2, prData, _prData, keyPath, cyclic, stateObj, parentObj, key, detectedType, encaps, isTypesonPromise, encaps2;\n\n                        return regeneratorRuntime.wrap(function _callee$(_context) {\n                          while (1) {\n                            switch (_context.prev = _context.next) {\n                              case 0:\n                                newPromisesData = [];\n                                _promisesData$splice = promisesData.splice(0, 1), _promisesData$splice2 = _slicedToArray(_promisesData$splice, 1), prData = _promisesData$splice2[0];\n                                _prData = _slicedToArray(prData, 7), keyPath = _prData[0], cyclic = _prData[2], stateObj = _prData[3], parentObj = _prData[4], key = _prData[5], detectedType = _prData[6];\n                                encaps = _encapsulate(keyPath, promResult, cyclic, stateObj, newPromisesData, true, detectedType);\n                                isTypesonPromise = hasConstructorOf(encaps, TypesonPromise); // Handle case where an embedded custom type itself\n                                //   returns a `Typeson.Promise`\n\n                                if (!(keyPath && isTypesonPromise)) {\n                                  _context.next = 11;\n                                  break;\n                                }\n\n                                _context.next = 8;\n                                return encaps.p;\n\n                              case 8:\n                                encaps2 = _context.sent;\n                                parentObj[key] = encaps2;\n                                return _context.abrupt(\"return\", checkPromises(ret, newPromisesData));\n\n                              case 11:\n                                if (keyPath) {\n                                  parentObj[key] = encaps;\n                                } else if (isTypesonPromise) {\n                                  ret = encaps.p;\n                                } else {\n                                  // If this is itself a `Typeson.Promise` (because the\n                                  //   original value supplied was a `Promise` or\n                                  //   because the supplied custom type value resolved\n                                  //   to one), returning it below will be fine since\n                                  //   a `Promise` is expected anyways given current\n                                  //   config (and if not a `Promise`, it will be ready\n                                  //   as the resolve value)\n                                  ret = encaps;\n                                }\n\n                                return _context.abrupt(\"return\", checkPromises(ret, newPromisesData));\n\n                              case 13:\n                              case \"end\":\n                                return _context.stop();\n                            }\n                          }\n                        }, _callee);\n                      }));\n\n                      return function (_x3) {\n                        return _ref.apply(this, arguments);\n                      };\n                    }()));\n\n                  case 5:\n                    return _context2.abrupt(\"return\", ret);\n\n                  case 6:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee2);\n          }));\n          return _checkPromises.apply(this, arguments);\n        }\n\n        function _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, cb) {\n          Object.assign(stateObj, ownKeysObj);\n          var vals = internalStateObjPropsToIgnore.map(function (prop) {\n            var tmp = stateObj[prop];\n            delete stateObj[prop];\n            return tmp;\n          }); // eslint-disable-next-line callback-return\n\n          cb();\n          internalStateObjPropsToIgnore.forEach(function (prop, i) {\n            stateObj[prop] = vals[i];\n          });\n        }\n        /**\n         *\n         * @param {string} keypath\n         * @param {Any} value\n         * @param {boolean} cyclic\n         * @param {PlainObject} stateObj\n         * @param {boolean} promisesData\n         * @param {boolean} resolvingTypesonPromise\n         * @param {string} detectedType\n         * @returns {Any}\n         */\n\n\n        function _encapsulate(keypath, value, cyclic, stateObj, promisesData, resolvingTypesonPromise, detectedType) {\n          var ret;\n          var observerData = {};\n\n          var $typeof = _typeof(value);\n\n          var runObserver = encapsulateObserver ? function (obj) {\n            var type = detectedType || stateObj.type || Typeson.getJSONType(value);\n            encapsulateObserver(Object.assign(obj || observerData, {\n              keypath: keypath,\n              value: value,\n              cyclic: cyclic,\n              stateObj: stateObj,\n              promisesData: promisesData,\n              resolvingTypesonPromise: resolvingTypesonPromise,\n              awaitingTypesonPromise: hasConstructorOf(value, TypesonPromise)\n            }, {\n              type: type\n            }));\n          } : null;\n\n          if (['string', 'boolean', 'number', 'undefined'].includes($typeof)) {\n            if (value === undefined || $typeof === 'number' && (isNaN(value) || value === -Infinity || value === Infinity)) {\n              if (stateObj.replaced) {\n                ret = value;\n              } else {\n                ret = replace(keypath, value, stateObj, promisesData, false, resolvingTypesonPromise, runObserver);\n              }\n\n              if (ret !== value) {\n                observerData = {\n                  replaced: ret\n                };\n              }\n            } else {\n              ret = value;\n            }\n\n            if (runObserver) {\n              runObserver();\n            }\n\n            return ret;\n          }\n\n          if (value === null) {\n            if (runObserver) {\n              runObserver();\n            }\n\n            return value;\n          }\n\n          if (cyclic && !stateObj.iterateIn && !stateObj.iterateUnsetNumeric && value && _typeof(value) === 'object') {\n            // Options set to detect cyclic references and be able\n            //   to rewrite them.\n            var refIndex = refObjs.indexOf(value);\n\n            if (refIndex < 0) {\n              if (cyclic === true) {\n                refObjs.push(value);\n                refKeys.push(keypath);\n              }\n            } else {\n              types[keypath] = '#';\n\n              if (runObserver) {\n                runObserver({\n                  cyclicKeypath: refKeys[refIndex]\n                });\n              }\n\n              return '#' + refKeys[refIndex];\n            }\n          }\n\n          var isPlainObj = isPlainObject(value);\n          var isArr = isArray(value);\n          var replaced = // Running replace will cause infinite loop as will test\n          //   positive again\n          (isPlainObj || isArr) && (!that.plainObjectReplacers.length || stateObj.replaced) || stateObj.iterateIn ? // Optimization: if plain object and no plain-object\n          //   replacers, don't try finding a replacer\n          value : replace(keypath, value, stateObj, promisesData, isPlainObj || isArr, null, runObserver);\n          var clone;\n\n          if (replaced !== value) {\n            ret = replaced;\n            observerData = {\n              replaced: replaced\n            };\n          } else {\n            // eslint-disable-next-line no-lonely-if\n            if (keypath === '' && hasConstructorOf(value, TypesonPromise)) {\n              promisesData.push([keypath, value, cyclic, stateObj, undefined, undefined, stateObj.type]);\n              ret = value;\n            } else if (isArr && stateObj.iterateIn !== 'object' || stateObj.iterateIn === 'array') {\n              clone = new Array(value.length);\n              observerData = {\n                clone: clone\n              };\n            } else if (!['function', 'symbol'].includes(_typeof(value)) && !('toJSON' in value) && !hasConstructorOf(value, TypesonPromise) && !hasConstructorOf(value, Promise) && !hasConstructorOf(value, ArrayBuffer) || isPlainObj || stateObj.iterateIn === 'object') {\n              clone = {};\n\n              if (stateObj.addLength) {\n                clone.length = value.length;\n              }\n\n              observerData = {\n                clone: clone\n              };\n            } else {\n              ret = value; // Only clone vanilla objects and arrays\n            }\n          }\n\n          if (runObserver) {\n            runObserver();\n          }\n\n          if (opts.iterateNone) {\n            return clone || ret;\n          }\n\n          if (!clone) {\n            return ret;\n          } // Iterate object or array\n\n\n          if (stateObj.iterateIn) {\n            var _loop = function _loop(key) {\n              var ownKeysObj = {\n                ownKeys: hasOwn$1.call(value, key)\n              };\n\n              _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, function () {\n                var kp = keypath + (keypath ? '.' : '') + escapeKeyPathComponent(key);\n\n                var val = _encapsulate(kp, value[key], Boolean(cyclic), stateObj, promisesData, resolvingTypesonPromise);\n\n                if (hasConstructorOf(val, TypesonPromise)) {\n                  promisesData.push([kp, val, Boolean(cyclic), stateObj, clone, key, stateObj.type]);\n                } else if (val !== undefined) {\n                  clone[key] = val;\n                }\n              });\n            };\n\n            // eslint-disable-next-line guard-for-in\n            for (var key in value) {\n              _loop(key);\n            }\n\n            if (runObserver) {\n              runObserver({\n                endIterateIn: true,\n                end: true\n              });\n            }\n          } else {\n            // Note: Non-indexes on arrays won't survive stringify so\n            //  somewhat wasteful for arrays, but so too is iterating\n            //  all numeric indexes on sparse arrays when not wanted\n            //  or filtering own keys for positive integers\n            keys(value).forEach(function (key) {\n              var kp = keypath + (keypath ? '.' : '') + escapeKeyPathComponent(key);\n              var ownKeysObj = {\n                ownKeys: true\n              };\n\n              _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, function () {\n                var val = _encapsulate(kp, value[key], Boolean(cyclic), stateObj, promisesData, resolvingTypesonPromise);\n\n                if (hasConstructorOf(val, TypesonPromise)) {\n                  promisesData.push([kp, val, Boolean(cyclic), stateObj, clone, key, stateObj.type]);\n                } else if (val !== undefined) {\n                  clone[key] = val;\n                }\n              });\n            });\n\n            if (runObserver) {\n              runObserver({\n                endIterateOwn: true,\n                end: true\n              });\n            }\n          } // Iterate array for non-own numeric properties (we can't\n          //   replace the prior loop though as it iterates non-integer\n          //   keys)\n\n\n          if (stateObj.iterateUnsetNumeric) {\n            var vl = value.length;\n\n            var _loop2 = function _loop2(i) {\n              if (!(i in value)) {\n                // No need to escape numeric\n                var kp = keypath + (keypath ? '.' : '') + i;\n                var ownKeysObj = {\n                  ownKeys: false\n                };\n\n                _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, function () {\n                  var val = _encapsulate(kp, undefined, Boolean(cyclic), stateObj, promisesData, resolvingTypesonPromise);\n\n                  if (hasConstructorOf(val, TypesonPromise)) {\n                    promisesData.push([kp, val, Boolean(cyclic), stateObj, clone, i, stateObj.type]);\n                  } else if (val !== undefined) {\n                    clone[i] = val;\n                  }\n                });\n              }\n            };\n\n            for (var i = 0; i < vl; i++) {\n              _loop2(i);\n            }\n\n            if (runObserver) {\n              runObserver({\n                endIterateUnsetNumeric: true,\n                end: true\n              });\n            }\n          }\n\n          return clone;\n        }\n        /**\n         *\n         * @param {string} keypath\n         * @param {Any} value\n         * @param {PlainObject} stateObj\n         * @param {GenericArray} promisesData\n         * @param {boolean} plainObject\n         * @param {boolean} resolvingTypesonPromise\n         * @param {function} [runObserver]\n         * @returns {*}\n         */\n\n\n        function replace(keypath, value, stateObj, promisesData, plainObject, resolvingTypesonPromise, runObserver) {\n          // Encapsulate registered types\n          var replacers = plainObject ? that.plainObjectReplacers : that.nonplainObjectReplacers;\n          var i = replacers.length;\n\n          while (i--) {\n            var replacer = replacers[i];\n\n            if (replacer.test(value, stateObj)) {\n              var type = replacer.type;\n\n              if (that.revivers[type]) {\n                // Record the type only if a corresponding reviver\n                //   exists. This is to support specs where only\n                //   replacement is done.\n                // For example, ensuring deep cloning of the object,\n                //   or replacing a type to its equivalent without\n                //   the need to revive it.\n                var existing = types[keypath]; // type can comprise an array of types (see test\n                //   \"should support intermediate types\")\n\n                types[keypath] = existing ? [type].concat(existing) : type;\n              }\n\n              Object.assign(stateObj, {\n                type: type,\n                replaced: true\n              });\n\n              if ((sync || !replacer.replaceAsync) && !replacer.replace) {\n                if (runObserver) {\n                  runObserver({\n                    typeDetected: true\n                  });\n                }\n\n                return _encapsulate(keypath, value, cyclic && 'readonly', stateObj, promisesData, resolvingTypesonPromise, type);\n              }\n\n              if (runObserver) {\n                runObserver({\n                  replacing: true\n                });\n              } // Now, also traverse the result in case it contains its\n              //   own types to replace\n\n\n              var replaceMethod = sync || !replacer.replaceAsync ? 'replace' : 'replaceAsync';\n              return _encapsulate(keypath, replacer[replaceMethod](value, stateObj), cyclic && 'readonly', stateObj, promisesData, resolvingTypesonPromise, type);\n            }\n          }\n\n          return value;\n        }\n\n        return promisesDataRoot.length ? sync && opts.throwOnBadSyncType ? function () {\n          throw new TypeError('Sync method requested but async result obtained');\n        }() : Promise.resolve(checkPromises(ret, promisesDataRoot)).then(finish) : !sync && opts.throwOnBadSyncType ? function () {\n          throw new TypeError('Async method requested but sync result obtained');\n        }() // If this is a synchronous request for stringification, yet\n        //   a promise is the result, we don't want to resolve leading\n        //   to an async result, so we return an array to avoid\n        //   ambiguity\n        : opts.stringification && sync ? [finish(ret)] : sync ? finish(ret) : Promise.resolve(finish(ret));\n      }\n      /**\n       * Also sync but throws on non-sync result.\n       * @param {*} obj\n       * @param {object} stateObj\n       * @param {object} opts\n       * @returns {*}\n       */\n\n    }, {\n      key: \"encapsulateSync\",\n      value: function encapsulateSync(obj, stateObj, opts) {\n        return this.encapsulate(obj, stateObj, _objectSpread2({\n          throwOnBadSyncType: true\n        }, opts, {\n          sync: true\n        }));\n      }\n      /**\n       * @param {*} obj\n       * @param {object} stateObj\n       * @param {object} opts\n       * @returns {*}\n       */\n\n    }, {\n      key: \"encapsulateAsync\",\n      value: function encapsulateAsync(obj, stateObj, opts) {\n        return this.encapsulate(obj, stateObj, _objectSpread2({\n          throwOnBadSyncType: true\n        }, opts, {\n          sync: false\n        }));\n      }\n      /**\n       * Revive an encapsulated object.\n       * This method is used internally by `Typeson.parse()`.\n       * @param {object} obj - Object to revive. If it has `$types` member, the\n       *   properties that are listed there will be replaced with its true type\n       *   instead of just plain objects.\n       * @param {object} opts\n       * @throws TypeError If mismatch between sync/async type and result\n       * @returns {Promise|*} If async, returns a Promise that resolves to `*`\n       */\n\n    }, {\n      key: \"revive\",\n      value: function revive(obj, opts) {\n        var types = obj && obj.$types; // No type info added. Revival not needed.\n\n        if (!types) {\n          return obj;\n        } // Object happened to have own `$types` property but with\n        //   no actual types, so we unescape and return that object\n\n\n        if (types === true) {\n          return obj.$;\n        }\n\n        opts = _objectSpread2({\n          sync: true\n        }, this.options, {}, opts);\n        var _opts3 = opts,\n            sync = _opts3.sync;\n        var keyPathResolutions = [];\n        var stateObj = {};\n        var ignore$Types = true; // Special when root object is not a trivial Object, it will\n        //   be encapsulated in `$`. It will also be encapsulated in\n        //   `$` if it has its own `$` property to avoid ambiguity\n\n        if (types.$ && isPlainObject(types.$)) {\n          obj = obj.$;\n          types = types.$;\n          ignore$Types = false;\n        }\n\n        var that = this;\n        /**\n         * @callback RevivalReducer\n         * @param {Any} value\n         * @param {string} type\n         * @returns {Any}\n         */\n\n        /**\n         *\n         * @param {string} type\n         * @param {Any} val\n         * @returns {[type]} [description]\n         */\n\n        function executeReviver(type, val) {\n          var _ref2 = that.revivers[type] || [],\n              _ref3 = _slicedToArray(_ref2, 1),\n              reviver = _ref3[0];\n\n          if (!reviver) {\n            throw new Error('Unregistered type: ' + type);\n          } // Only `sync` expected here, as problematic async would\n          //  be missing both `reviver` and `reviverAsync`, and\n          //  encapsulation shouldn't have added types, so\n          //  should have made an early exit\n\n\n          if (sync && !('revive' in reviver)) {\n            // Just return value as is\n            return val;\n          }\n\n          return reviver[sync && reviver.revive ? 'revive' : !sync && reviver.reviveAsync ? 'reviveAsync' : 'revive'](val, stateObj);\n        }\n        /**\n         *\n         * @returns {void|TypesonPromise<void>}\n         */\n\n\n        function revivePlainObjects() {\n          // const references = [];\n          // const reviveTypes = [];\n          var plainObjectTypes = [];\n          Object.entries(types).forEach(function (_ref4) {\n            var _ref5 = _slicedToArray(_ref4, 2),\n                keypath = _ref5[0],\n                type = _ref5[1];\n\n            if (type === '#') {\n              /*\n              references.push({\n                  keypath,\n                  reference: getByKeyPath(obj, keypath)\n              });\n              */\n              return;\n            }\n\n            [].concat(type).forEach(function (type) {\n              var _ref6 = that.revivers[type] || [null, {}],\n                  _ref7 = _slicedToArray(_ref6, 2),\n                  plain = _ref7[1].plain;\n\n              if (!plain) {\n                // reviveTypes.push({keypath, type});\n                return;\n              }\n\n              plainObjectTypes.push({\n                keypath: keypath,\n                type: type\n              });\n              delete types[keypath]; // Avoid repeating\n            });\n          });\n\n          if (!plainObjectTypes.length) {\n            return undefined;\n          } // console.log(plainObjectTypes.sort(nestedPathsFirst));\n\n          /**\n          * @typedef {PlainObject} PlainObjectType\n          * @property {string} keypath\n          * @property {string} type\n          */\n\n\n          return plainObjectTypes.sort(nestedPathsFirst).reduce(function reducer(possibleTypesonPromise, _ref8) {\n            var keypath = _ref8.keypath,\n                type = _ref8.type;\n\n            if (isThenable(possibleTypesonPromise)) {\n              return possibleTypesonPromise.then(function (val) {\n                return reducer(val, {\n                  keypath: keypath,\n                  type: type\n                });\n              });\n            } // console.log('obj', JSON.stringify(keypath), obj);\n\n\n            var val = getByKeyPath(obj, keypath);\n            val = executeReviver(type, val);\n\n            if (hasConstructorOf(val, TypesonPromise)) {\n              return val.then(function (v) {\n                var newVal = setAtKeyPath(obj, keypath, v);\n\n                if (newVal === v) {\n                  obj = newVal;\n                }\n\n                return undefined;\n              });\n            }\n\n            var newVal = setAtKeyPath(obj, keypath, val);\n\n            if (newVal === val) {\n              obj = newVal;\n            }\n\n            return undefined;\n          }, undefined // This argument must be explicit\n          ); // references.forEach(({keypath, reference}) => {});\n          // reviveTypes.sort(nestedPathsFirst).forEach(() => {});\n        }\n\n        var revivalPromises = [];\n        /**\n         *\n         * @param {string} keypath\n         * @param {Any} value\n         * @param {?(Array|object)} target\n         * @param {Array|object} [clone]\n         * @param {string} [key]\n         * @returns {Any}\n         */\n\n        function _revive(keypath, value, target, clone, key) {\n          if (ignore$Types && keypath === '$types') {\n            return undefined;\n          }\n\n          var type = types[keypath];\n          var isArr = isArray(value);\n\n          if (isArr || isPlainObject(value)) {\n            var _clone = isArr ? new Array(value.length) : {}; // Iterate object or array\n\n\n            keys(value).forEach(function (k) {\n              var val = _revive(keypath + (keypath ? '.' : '') + escapeKeyPathComponent(k), value[k], target || _clone, _clone, k);\n\n              var set = function set(v) {\n                if (hasConstructorOf(v, Undefined)) {\n                  _clone[k] = undefined;\n                } else if (v !== undefined) {\n                  _clone[k] = v;\n                }\n\n                return v;\n              };\n\n              if (hasConstructorOf(val, TypesonPromise)) {\n                revivalPromises.push(val.then(function (ret) {\n                  return set(ret);\n                }));\n              } else {\n                set(val);\n              }\n            });\n            value = _clone; // Try to resolve cyclic reference as soon as available\n\n            while (keyPathResolutions.length) {\n              var _keyPathResolutions$ = _slicedToArray(keyPathResolutions[0], 4),\n                  _target = _keyPathResolutions$[0],\n                  keyPath = _keyPathResolutions$[1],\n                  _clone2 = _keyPathResolutions$[2],\n                  k = _keyPathResolutions$[3];\n\n              var val = getByKeyPath(_target, keyPath); // Typeson.Undefined not expected here as not cyclic or\n              //   `undefined`\n\n              if (val !== undefined) {\n                _clone2[k] = val;\n              } else {\n                break;\n              }\n\n              keyPathResolutions.splice(0, 1);\n            }\n          }\n\n          if (!type) {\n            return value;\n          }\n\n          if (type === '#') {\n            var _ret = getByKeyPath(target, value.slice(1));\n\n            if (_ret === undefined) {\n              // Cyclic reference not yet available\n              keyPathResolutions.push([target, value.slice(1), clone, key]);\n            }\n\n            return _ret;\n          } // `type` can be an array here\n\n\n          return [].concat(type).reduce(function reducer(val, typ) {\n            if (hasConstructorOf(val, TypesonPromise)) {\n              return val.then(function (v) {\n                // TypesonPromise here too\n                return reducer(v, typ);\n              });\n            }\n\n            return executeReviver(typ, val);\n          }, value);\n        }\n        /**\n         *\n         * @param {Any} retrn\n         * @returns {undefined|Any}\n         */\n\n\n        function checkUndefined(retrn) {\n          return hasConstructorOf(retrn, Undefined) ? undefined : retrn;\n        }\n\n        var possibleTypesonPromise = revivePlainObjects();\n        var ret;\n\n        if (hasConstructorOf(possibleTypesonPromise, TypesonPromise)) {\n          ret = possibleTypesonPromise.then(function () {\n            return obj;\n          });\n        } else {\n          ret = _revive('', obj, null);\n\n          if (revivalPromises.length) {\n            // Ensure children resolved\n            ret = TypesonPromise.resolve(ret).then(function (r) {\n              return TypesonPromise.all([// May be a TypesonPromise or not\n              r].concat(revivalPromises));\n            }).then(function (_ref9) {\n              var _ref10 = _slicedToArray(_ref9, 1),\n                  r = _ref10[0];\n\n              return r;\n            });\n          }\n        }\n\n        return isThenable(ret) ? sync && opts.throwOnBadSyncType ? function () {\n          throw new TypeError('Sync method requested but async result obtained');\n        }() : hasConstructorOf(ret, TypesonPromise) ? ret.p.then(checkUndefined) : ret : !sync && opts.throwOnBadSyncType ? function () {\n          throw new TypeError('Async method requested but sync result obtained');\n        }() : sync ? checkUndefined(ret) : Promise.resolve(checkUndefined(ret));\n      }\n      /**\n       * Also sync but throws on non-sync result.\n       * @param {Any} obj\n       * @param {object} opts\n       * @returns {Any}\n       */\n\n    }, {\n      key: \"reviveSync\",\n      value: function reviveSync(obj, opts) {\n        return this.revive(obj, _objectSpread2({\n          throwOnBadSyncType: true\n        }, opts, {\n          sync: true\n        }));\n      }\n      /**\n      * @param {Any} obj\n      * @param {object} opts\n      * @returns {Promise} Resolves to `*`\n      */\n\n    }, {\n      key: \"reviveAsync\",\n      value: function reviveAsync(obj, opts) {\n        return this.revive(obj, _objectSpread2({\n          throwOnBadSyncType: true\n        }, opts, {\n          sync: false\n        }));\n      }\n      /**\n       * Register types.\n       * For examples on how to use this method, see\n       *   {@link https://github.com/dfahlander/typeson-registry/tree/master/types}.\n       * @param {object.<string,Function[]>[]} typeSpecSets - Types and\n       *   their functions [test, encapsulate, revive];\n       * @param {object} opts\n       * @returns {Typeson}\n       */\n\n    }, {\n      key: \"register\",\n      value: function register(typeSpecSets, opts) {\n        opts = opts || {};\n        [].concat(typeSpecSets).forEach(function R(typeSpec) {\n          var _this = this;\n\n          // Allow arrays of arrays of arrays...\n          if (isArray(typeSpec)) {\n            return typeSpec.map(function (typSpec) {\n              return R.call(_this, typSpec);\n            });\n          }\n\n          typeSpec && keys(typeSpec).forEach(function (typeId) {\n            if (typeId === '#') {\n              throw new TypeError('# cannot be used as a type name as it is reserved ' + 'for cyclic objects');\n            } else if (Typeson.JSON_TYPES.includes(typeId)) {\n              throw new TypeError('Plain JSON object types are reserved as type names');\n            }\n\n            var spec = typeSpec[typeId];\n            var replacers = spec && spec.testPlainObjects ? this.plainObjectReplacers : this.nonplainObjectReplacers;\n            var existingReplacer = replacers.filter(function (r) {\n              return r.type === typeId;\n            });\n\n            if (existingReplacer.length) {\n              // Remove existing spec and replace with this one.\n              replacers.splice(replacers.indexOf(existingReplacer[0]), 1);\n              delete this.revivers[typeId];\n              delete this.types[typeId];\n            }\n\n            if (typeof spec === 'function') {\n              // Support registering just a class without replacer/reviver\n              var Class = spec;\n              spec = {\n                test: function test(x) {\n                  return x && x.constructor === Class;\n                },\n                replace: function replace(x) {\n                  return _objectSpread2({}, x);\n                },\n                revive: function revive(x) {\n                  return Object.assign(Object.create(Class.prototype), x);\n                }\n              };\n            } else if (isArray(spec)) {\n              var _spec = spec,\n                  _spec2 = _slicedToArray(_spec, 3),\n                  test = _spec2[0],\n                  replace = _spec2[1],\n                  revive = _spec2[2];\n\n              spec = {\n                test: test,\n                replace: replace,\n                revive: revive\n              };\n            }\n\n            if (!spec || !spec.test) {\n              return;\n            }\n\n            var replacerObj = {\n              type: typeId,\n              test: spec.test.bind(spec)\n            };\n\n            if (spec.replace) {\n              replacerObj.replace = spec.replace.bind(spec);\n            }\n\n            if (spec.replaceAsync) {\n              replacerObj.replaceAsync = spec.replaceAsync.bind(spec);\n            }\n\n            var start = typeof opts.fallback === 'number' ? opts.fallback : opts.fallback ? 0 : Infinity;\n\n            if (spec.testPlainObjects) {\n              this.plainObjectReplacers.splice(start, 0, replacerObj);\n            } else {\n              this.nonplainObjectReplacers.splice(start, 0, replacerObj);\n            } // Todo: We might consider a testAsync type\n\n\n            if (spec.revive || spec.reviveAsync) {\n              var reviverObj = {};\n\n              if (spec.revive) {\n                reviverObj.revive = spec.revive.bind(spec);\n              }\n\n              if (spec.reviveAsync) {\n                reviverObj.reviveAsync = spec.reviveAsync.bind(spec);\n              }\n\n              this.revivers[typeId] = [reviverObj, {\n                plain: spec.testPlainObjects\n              }];\n            } // Record to be retrieved via public types property.\n\n\n            this.types[typeId] = spec;\n          }, this);\n        }, this);\n        return this;\n      }\n    }]);\n\n    return Typeson;\n  }();\n  /**\n   * We keep this function minimized so if using two instances of this\n   * library, where one is minimized and one is not, it will still work\n   * with `hasConstructorOf`.\n   * @class\n   */\n\n\n  var Undefined = function Undefined() {\n    _classCallCheck(this, Undefined);\n  }; // eslint-disable-line space-before-blocks\n\n\n  Undefined.__typeson__type__ = 'TypesonUndefined'; // The following provide classes meant to avoid clashes with other values\n  // To insist `undefined` should be added\n\n  Typeson.Undefined = Undefined; // To support async encapsulation/stringification\n\n  Typeson.Promise = TypesonPromise; // Some fundamental type-checking utilities\n\n  Typeson.isThenable = isThenable;\n  Typeson.toStringTag = toStringTag;\n  Typeson.hasConstructorOf = hasConstructorOf;\n  Typeson.isObject = isObject;\n  Typeson.isPlainObject = isPlainObject;\n  Typeson.isUserObject = isUserObject;\n  Typeson.escapeKeyPathComponent = escapeKeyPathComponent;\n  Typeson.unescapeKeyPathComponent = unescapeKeyPathComponent;\n  Typeson.getByKeyPath = getByKeyPath;\n  Typeson.getJSONType = getJSONType;\n  Typeson.JSON_TYPES = ['null', 'boolean', 'number', 'string', 'array', 'object'];\n\n  return Typeson;\n\n})));\n", "function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\n/**\n* @callback TypesonFulfilled\n* @returns {Promise<any>|any}\n*/\n\n/**\n* @callback TypesonRejected\n* @returns {Promise<any>|any}\n*/\n\n/**\n * @callback TypesonResolve\n * @param {any} value\n * @returns {Promise<any>}\n */\n\n/**\n * @callback TypesonReject\n * @param {Error|any} error\n * @returns {Promise<any>}\n */\n\n/**\n * @callback TypesonResolveReject\n * @param {TypesonResolve} typesonResolve\n * @param {TypesonReject} typesonReject\n * @returns {Promise<any>}\n */\n\n/* eslint-disable block-spacing, space-before-function-paren,\n  space-before-blocks, space-infix-ops, semi, promise/avoid-new,\n  jsdoc/require-jsdoc */\n\n/**\n * We keep this function minimized so if using two instances of this\n *   library, where one is minimized and one is not, it will still work\n *   with `hasConstructorOf`.\n * With ES6 classes, we may be able to simply use `class TypesonPromise\n *   extends Promise` and add a string tag for detection.\n * @param {TypesonResolveReject} f\n */\nvar TypesonPromise = function TypesonPromise(f) {\n  _classCallCheck(this, TypesonPromise);\n\n  this.p = new Promise(f);\n};\n/* eslint-enable block-spacing, space-before-function-paren,\n  space-before-blocks, space-infix-ops, semi, promise/avoid-new,\n  jsdoc/require-jsdoc */\n// eslint-disable-next-line max-len\n// class TypesonPromise extends Promise {get[Symbol.toStringTag](){return 'TypesonPromise'};} // eslint-disable-line keyword-spacing, space-before-function-paren, space-before-blocks, block-spacing, semi\n\n\nTypesonPromise.__typeson__type__ = 'TypesonPromise'; // Note: core-js-bundle provides a `Symbol` polyfill\n\n/* istanbul ignore else */\n\nif (typeof Symbol !== 'undefined') {\n  // Ensure `isUserObject` will return `false` for `TypesonPromise`\n  TypesonPromise.prototype[Symbol.toStringTag] = 'TypesonPromise';\n}\n/**\n *\n * @param {TypesonFulfilled} [onFulfilled]\n * @param {TypesonRejected} [onRejected]\n * @returns {TypesonPromise}\n */\n\n\nTypesonPromise.prototype.then = function (onFulfilled, onRejected) {\n  var _this = this;\n\n  return new TypesonPromise(function (typesonResolve, typesonReject) {\n    // eslint-disable-next-line promise/catch-or-return\n    _this.p.then(function (res) {\n      // eslint-disable-next-line promise/always-return\n      typesonResolve(onFulfilled ? onFulfilled(res) : res);\n    })[\"catch\"](function (res) {\n      return onRejected ? onRejected(res) : Promise.reject(res);\n    }).then(typesonResolve, typesonReject);\n  });\n};\n/**\n *\n * @param {TypesonRejected} onRejected\n * @returns {TypesonPromise}\n */\n\n\nTypesonPromise.prototype[\"catch\"] = function (onRejected) {\n  return this.then(null, onRejected);\n};\n/**\n *\n * @param {any} v\n * @returns {TypesonPromise}\n */\n\n\nTypesonPromise.resolve = function (v) {\n  return new TypesonPromise(function (typesonResolve) {\n    typesonResolve(v);\n  });\n};\n/**\n *\n * @param {any} v\n * @returns {TypesonPromise}\n */\n\n\nTypesonPromise.reject = function (v) {\n  return new TypesonPromise(function (typesonResolve, typesonReject) {\n    typesonReject(v);\n  });\n};\n\n['all', 'race'].forEach(function (meth) {\n  /**\n   *\n   * @param {Promise<any>[]} promArr\n   * @returns {TypesonPromise}\n   */\n  TypesonPromise[meth] = function (promArr) {\n    return new TypesonPromise(function (typesonResolve, typesonReject) {\n      // eslint-disable-next-line promise/catch-or-return\n      Promise[meth](promArr.map(function (prom) {\n        return prom && prom.constructor && prom.constructor.__typeson__type__ === 'TypesonPromise' ? prom.p : prom;\n      })).then(typesonResolve, typesonReject);\n    });\n  };\n});\n\nvar _ref = {},\n    toStr = _ref.toString,\n    hasOwn$1 = {}.hasOwnProperty,\n    getProto = Object.getPrototypeOf,\n    fnToString = hasOwn$1.toString;\n/**\n * Second argument not in use internally, but provided for utility.\n * @param {any} v\n * @param {boolean} catchCheck\n * @returns {boolean}\n */\n\nfunction isThenable(v, catchCheck) {\n  return isObject(v) && typeof v.then === 'function' && (!catchCheck || typeof v[\"catch\"] === 'function');\n}\n/**\n *\n * @param {any} val\n * @returns {string}\n */\n\n\nfunction toStringTag(val) {\n  return toStr.call(val).slice(8, -1);\n}\n/**\n * This function is dependent on both constructors\n *   being identical so any minimization is expected of both.\n * @param {any} a\n * @param {GenericFunction} b\n * @returns {boolean}\n */\n\n\nfunction hasConstructorOf(a, b) {\n  if (!a || _typeof(a) !== 'object') {\n    return false;\n  }\n\n  var proto = getProto(a);\n\n  if (!proto) {\n    return b === null;\n  }\n\n  var Ctor = hasOwn$1.call(proto, 'constructor') && proto.constructor;\n\n  if (typeof Ctor !== 'function') {\n    return b === null;\n  }\n\n  if (b === Ctor) {\n    return true;\n  }\n\n  if (b !== null && fnToString.call(Ctor) === fnToString.call(b)) {\n    return true;\n  }\n\n  if (typeof b === 'function' && typeof Ctor.__typeson__type__ === 'string' && Ctor.__typeson__type__ === b.__typeson__type__) {\n    return true;\n  }\n\n  return false;\n}\n/**\n *\n * @param {any} val\n * @returns {boolean}\n */\n\n\nfunction isPlainObject(val) {\n  // Mirrors jQuery's\n  if (!val || toStringTag(val) !== 'Object') {\n    return false;\n  }\n\n  var proto = getProto(val);\n\n  if (!proto) {\n    // `Object.create(null)`\n    return true;\n  }\n\n  return hasConstructorOf(val, Object);\n}\n/**\n *\n * @param {any} val\n * @returns {boolean}\n */\n\n\nfunction isUserObject(val) {\n  if (!val || toStringTag(val) !== 'Object') {\n    return false;\n  }\n\n  var proto = getProto(val);\n\n  if (!proto) {\n    // `Object.create(null)`\n    return true;\n  }\n\n  return hasConstructorOf(val, Object) || isUserObject(proto);\n}\n/**\n *\n * @param {any} v\n * @returns {boolean}\n */\n\n\nfunction isObject(v) {\n  return v && _typeof(v) === 'object';\n}\n/**\n *\n * @param {string} keyPathComponent\n * @returns {string}\n */\n\n\nfunction escapeKeyPathComponent(keyPathComponent) {\n  return keyPathComponent.replace(/~/g, '~0').replace(/\\./g, '~1');\n}\n/**\n *\n * @param {string} keyPathComponent\n * @returns {string}\n */\n\n\nfunction unescapeKeyPathComponent(keyPathComponent) {\n  return keyPathComponent.replace(/~1/g, '.').replace(/~0/g, '~');\n}\n/**\n * @param {PlainObject|GenericArray} obj\n * @param {string} keyPath\n * @returns {any}\n */\n\n\nfunction getByKeyPath(obj, keyPath) {\n  if (keyPath === '') {\n    return obj;\n  }\n\n  var period = keyPath.indexOf('.');\n\n  if (period > -1) {\n    var innerObj = obj[unescapeKeyPathComponent(keyPath.slice(0, period))];\n    return innerObj === undefined ? undefined : getByKeyPath(innerObj, keyPath.slice(period + 1));\n  }\n\n  return obj[unescapeKeyPathComponent(keyPath)];\n}\n/**\n *\n * @param {PlainObject} obj\n * @param {string} keyPath\n * @param {any} value\n * @returns {any}\n */\n\n\nfunction setAtKeyPath(obj, keyPath, value) {\n  if (keyPath === '') {\n    return value;\n  }\n\n  var period = keyPath.indexOf('.');\n\n  if (period > -1) {\n    var innerObj = obj[unescapeKeyPathComponent(keyPath.slice(0, period))];\n    return setAtKeyPath(innerObj, keyPath.slice(period + 1), value);\n  }\n\n  obj[unescapeKeyPathComponent(keyPath)] = value;\n  return obj;\n}\n/**\n *\n * @param {external:JSON} value\n * @returns {\"null\"|\"array\"|\"undefined\"|\"boolean\"|\"number\"|\"string\"|\n *  \"object\"|\"symbol\"}\n */\n\n\nfunction getJSONType(value) {\n  return value === null ? 'null' : Array.isArray(value) ? 'array' : _typeof(value);\n}\n\nfunction _await(value, then, direct) {\n  if (direct) {\n    return then ? then(value) : value;\n  }\n\n  if (!value || !value.then) {\n    value = Promise.resolve(value);\n  }\n\n  return then ? value.then(then) : value;\n}\n\nvar keys = Object.keys,\n    isArray = Array.isArray,\n    hasOwn = {}.hasOwnProperty,\n    internalStateObjPropsToIgnore = ['type', 'replaced', 'iterateIn', 'iterateUnsetNumeric'];\n/**\n * Handle plain object revivers first so reference setting can use\n * revived type (e.g., array instead of object); assumes revived\n * has same structure or will otherwise break subsequent references.\n * @param {PlainObjectType} a\n * @param {PlainObjectType} b\n * @returns {1|-1|boolean}\n */\n\nfunction _async(f) {\n  return function () {\n    for (var args = [], i = 0; i < arguments.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    try {\n      return Promise.resolve(f.apply(this, args));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n}\n/**\n * @callback Tester\n * @param {any} value\n * @param {StateObject} stateobj\n * @returns {boolean}\n */\n\n/**\n* @callback Replacer\n* @param {any} value\n* @param {StateObject} stateObj\n* @returns {any} Should be JSON-stringifiable\n*/\n\n/**\n* @callback Reviver\n* @param {JSON} value\n* @param {StateObject} stateObj\n* @returns {any}\n*/\n\n/**\n* @typedef {PlainObject} TypesonOptions\n* @property {boolean} stringification Auto-set by `stringify`\n*/\n\n/**\n * An instance of this class can be used to call `stringify()` and `parse()`.\n * Typeson resolves cyclic references by default. Can also be extended to\n * support custom types using the register() method.\n *\n * @class\n * @param {{cyclic: boolean}} [options] - if cyclic (default true),\n *   cyclic references will be handled gracefully.\n */\n\n\nfunction _invoke(body, then) {\n  var result = body();\n\n  if (result && result.then) {\n    return result.then(then);\n  }\n\n  return then(result);\n}\n\nfunction nestedPathsFirst(a, b) {\n  if (a.keypath === '') {\n    return -1;\n  }\n\n  var as = a.keypath.match(/\\./g) || 0;\n  var bs = b.keypath.match(/\\./g) || 0;\n\n  if (as) {\n    as = as.length;\n  }\n\n  if (bs) {\n    bs = bs.length;\n  }\n\n  return as > bs ? -1 : as < bs ? 1 : a.keypath < b.keypath ? -1 : a.keypath > b.keypath;\n}\n\nvar Typeson = /*#__PURE__*/function () {\n  /**\n   * @param {TypesonOptions} options\n   */\n  function Typeson(options) {\n    _classCallCheck(this, Typeson);\n\n    this.options = options; // Replacers signature: replace (value). Returns falsy if not\n    //   replacing. Otherwise ['Date', value.getTime()]\n\n    this.plainObjectReplacers = [];\n    this.nonplainObjectReplacers = []; // Revivers: [{type => reviver}, {plain: boolean}].\n    //   Sample: [{'Date': value => new Date(value)}, {plain: false}]\n\n    this.revivers = {};\n    /** Types registered via `register()`. */\n\n    this.types = {};\n  }\n  /**\n  * @typedef {null|boolean|number|string|GenericArray|PlainObject} JSON\n  */\n\n  /**\n  * @callback JSONReplacer\n  * @param {\"\"|string} key\n  * @param {JSON} value\n  * @returns {number|string|boolean|null|PlainObject|undefined}\n  * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#The%20replacer%20parameter\n  */\n\n  /**\n   * Serialize given object to Typeson.\n   * Initial arguments work identical to those of `JSON.stringify`.\n   * The `replacer` argument has nothing to do with our replacers.\n   * @param {any} obj\n   * @param {JSONReplacer|string[]} replacer\n   * @param {number|string} space\n   * @param {TypesonOptions} opts\n   * @returns {string|Promise<string>} Promise resolves to a string\n   */\n\n\n  _createClass(Typeson, [{\n    key: \"stringify\",\n    value: function stringify(obj, replacer, space, opts) {\n      opts = _objectSpread2(_objectSpread2(_objectSpread2({}, this.options), opts), {}, {\n        stringification: true\n      });\n      var encapsulated = this.encapsulate(obj, null, opts);\n\n      if (isArray(encapsulated)) {\n        return JSON.stringify(encapsulated[0], replacer, space);\n      }\n\n      return encapsulated.then(function (res) {\n        return JSON.stringify(res, replacer, space);\n      });\n    }\n    /**\n     * Also sync but throws on non-sync result.\n     * @param {any} obj\n     * @param {JSONReplacer|string[]} replacer\n     * @param {number|string} space\n     * @param {TypesonOptions} opts\n     * @returns {string}\n     */\n\n  }, {\n    key: \"stringifySync\",\n    value: function stringifySync(obj, replacer, space, opts) {\n      return this.stringify(obj, replacer, space, _objectSpread2(_objectSpread2({\n        throwOnBadSyncType: true\n      }, opts), {}, {\n        sync: true\n      }));\n    }\n    /**\n     *\n     * @param {any} obj\n     * @param {JSONReplacer|string[]} replacer\n     * @param {number|string} space\n     * @param {TypesonOptions} opts\n     * @returns {Promise<string>}\n     */\n\n  }, {\n    key: \"stringifyAsync\",\n    value: function stringifyAsync(obj, replacer, space, opts) {\n      return this.stringify(obj, replacer, space, _objectSpread2(_objectSpread2({\n        throwOnBadSyncType: true\n      }, opts), {}, {\n        sync: false\n      }));\n    }\n    /**\n    * @callback JSONReviver\n    * @param {string} key\n    * @param {JSON} value\n    * @returns {JSON}\n    */\n\n    /**\n     * Parse Typeson back into an obejct.\n     * Initial arguments works identical to those of `JSON.parse()`.\n     * @param {string} text\n     * @param {JSONReviver} reviver This JSON reviver has nothing to do with\n     *   our revivers.\n     * @param {TypesonOptions} opts\n     * @returns {external:JSON}\n     */\n\n  }, {\n    key: \"parse\",\n    value: function parse(text, reviver, opts) {\n      opts = _objectSpread2(_objectSpread2(_objectSpread2({}, this.options), opts), {}, {\n        parse: true\n      });\n      return this.revive(JSON.parse(text, reviver), opts);\n    }\n    /**\n    * Also sync but throws on non-sync result.\n    * @param {string} text\n    * @param {JSONReviver} reviver This JSON reviver has nothing to do with\n    *   our revivers.\n    * @param {TypesonOptions} opts\n    * @returns {external:JSON}\n    */\n\n  }, {\n    key: \"parseSync\",\n    value: function parseSync(text, reviver, opts) {\n      return this.parse(text, reviver, _objectSpread2(_objectSpread2({\n        throwOnBadSyncType: true\n      }, opts), {}, {\n        sync: true\n      }));\n    }\n    /**\n    * @param {string} text\n    * @param {JSONReviver} reviver This JSON reviver has nothing to do with\n    *   our revivers.\n    * @param {TypesonOptions} opts\n    * @returns {Promise<external:JSON>} Resolves to `external:JSON`\n    */\n\n  }, {\n    key: \"parseAsync\",\n    value: function parseAsync(text, reviver, opts) {\n      return this.parse(text, reviver, _objectSpread2(_objectSpread2({\n        throwOnBadSyncType: true\n      }, opts), {}, {\n        sync: false\n      }));\n    }\n    /**\n    * @typedef {} StateObject\n    */\n\n    /**\n     *\n     * @param {any} obj\n     * @param {StateObject} stateObj\n     * @param {TypesonOptions} [opts={}]\n     * @returns {string[]|false}\n     */\n\n  }, {\n    key: \"specialTypeNames\",\n    value: function specialTypeNames(obj, stateObj) {\n      var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      opts.returnTypeNames = true;\n      return this.encapsulate(obj, stateObj, opts);\n    }\n    /**\n     *\n     * @param {any} obj\n     * @param {PlainObject} stateObj\n     * @param {PlainObject} [opts={}]\n     * @returns {Promise<any>|GenericArray|PlainObject|string|false}\n     */\n\n  }, {\n    key: \"rootTypeName\",\n    value: function rootTypeName(obj, stateObj) {\n      var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      opts.iterateNone = true;\n      return this.encapsulate(obj, stateObj, opts);\n    }\n    /**\n     * Encapsulate a complex object into a plain Object by replacing\n     * registered types with plain objects representing the types data.\n     *\n     * This method is used internally by `Typeson.stringify()`.\n     * @param {any} obj - Object to encapsulate.\n     * @param {PlainObject} stateObj\n     * @param {PlainObject} opts\n     * @returns {Promise<any>|GenericArray|PlainObject|string|false}\n     */\n\n  }, {\n    key: \"encapsulate\",\n    value: function encapsulate(obj, stateObj, opts) {\n      /**\n       *\n       * @param {any} ret\n       * @param {GenericArray} promisesData\n       * @returns {Promise<any>}\n       */\n      var checkPromises = _async(function (ret, promisesData) {\n        return _await(Promise.all(promisesData.map(function (pd) {\n          return pd[1].p;\n        })), function (promResults) {\n          return _await(Promise.all(promResults.map(_async(function (promResult) {\n            var _exit = false;\n            var newPromisesData = [];\n\n            var _promisesData$splice = promisesData.splice(0, 1),\n                _promisesData$splice2 = _slicedToArray(_promisesData$splice, 1),\n                prData = _promisesData$splice2[0];\n\n            var _prData = _slicedToArray(prData, 7),\n                keyPath = _prData[0],\n                cyclic = _prData[2],\n                stateObj = _prData[3],\n                parentObj = _prData[4],\n                key = _prData[5],\n                detectedType = _prData[6];\n\n            var encaps = _encapsulate(keyPath, promResult, cyclic, stateObj, newPromisesData, true, detectedType);\n\n            var isTypesonPromise = hasConstructorOf(encaps, TypesonPromise); // Handle case where an embedded custom type itself\n            //   returns a `Typeson.Promise`\n\n            return _invoke(function () {\n              if (keyPath && isTypesonPromise) {\n                return _await(encaps.p, function (encaps2) {\n                  parentObj[key] = encaps2;\n                  _exit = true;\n                  return checkPromises(ret, newPromisesData);\n                });\n              }\n            }, function (_result) {\n              if (_exit) return _result;\n\n              if (keyPath) {\n                parentObj[key] = encaps;\n              } else if (isTypesonPromise) {\n                ret = encaps.p;\n              } else {\n                // If this is itself a `Typeson.Promise` (because the\n                //   original value supplied was a `Promise` or\n                //   because the supplied custom type value resolved\n                //   to one), returning it below will be fine since\n                //   a `Promise` is expected anyways given current\n                //   config (and if not a `Promise`, it will be ready\n                //   as the resolve value)\n                ret = encaps;\n              }\n\n              return checkPromises(ret, newPromisesData);\n            });\n          }))), function () {\n            return ret;\n          });\n        });\n      });\n      /**\n      * @typedef {PlainObject} OwnKeysObject\n      * @property {boolean} ownKeys\n      */\n\n      /**\n      * @callback BuiltinStateObjectPropertiesCallback\n      * @returns {void}\n      */\n\n      /**\n       *\n       * @param {StateObject} stateObj\n       * @param {OwnKeysObject} ownKeysObj\n       * @param {BuiltinStateObjectPropertiesCallback} cb\n       * @returns {undefined}\n       */\n\n\n      opts = _objectSpread2(_objectSpread2({\n        sync: true\n      }, this.options), opts);\n      var _opts = opts,\n          sync = _opts.sync;\n      var that = this,\n          types = {},\n          refObjs = [],\n          // For checking cyclic references\n      refKeys = [],\n          // For checking cyclic references\n      promisesDataRoot = []; // Clone the object deeply while at the same time replacing any\n      //   special types or cyclic reference:\n\n      var cyclic = 'cyclic' in opts ? opts.cyclic : true;\n      var _opts2 = opts,\n          encapsulateObserver = _opts2.encapsulateObserver;\n\n      var ret = _encapsulate('', obj, cyclic, stateObj || {}, promisesDataRoot);\n      /**\n       *\n       * @param {any} ret\n       * @returns {GenericArray|PlainObject|string|false}\n       */\n\n\n      function finish(ret) {\n        // Add `$types` to result only if we ever bumped into a\n        //  special type (or special case where object has own `$types`)\n        var typeNames = Object.values(types);\n\n        if (opts.iterateNone) {\n          if (typeNames.length) {\n            return typeNames[0];\n          }\n\n          return Typeson.getJSONType(ret);\n        }\n\n        if (typeNames.length) {\n          if (opts.returnTypeNames) {\n            return _toConsumableArray(new Set(typeNames));\n          } // Special if array (or a primitive) was serialized\n          //   because JSON would ignore custom `$types` prop on it\n\n\n          if (!ret || !isPlainObject(ret) || // Also need to handle if this is an object with its\n          //   own `$types` property (to avoid ambiguity)\n          hasOwn.call(ret, '$types')) {\n            ret = {\n              $: ret,\n              $types: {\n                $: types\n              }\n            };\n          } else {\n            ret.$types = types;\n          } // No special types\n\n        } else if (isObject(ret) && hasOwn.call(ret, '$types')) {\n          ret = {\n            $: ret,\n            $types: true\n          };\n        }\n\n        if (opts.returnTypeNames) {\n          return false;\n        }\n\n        return ret;\n      }\n\n      function _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, cb) {\n        Object.assign(stateObj, ownKeysObj);\n        var vals = internalStateObjPropsToIgnore.map(function (prop) {\n          var tmp = stateObj[prop];\n          delete stateObj[prop];\n          return tmp;\n        }); // eslint-disable-next-line node/callback-return\n\n        cb();\n        internalStateObjPropsToIgnore.forEach(function (prop, i) {\n          stateObj[prop] = vals[i];\n        });\n      }\n      /**\n       *\n       * @param {string} keypath\n       * @param {any} value\n       * @param {boolean} cyclic\n       * @param {PlainObject} stateObj\n       * @param {boolean} promisesData\n       * @param {boolean} resolvingTypesonPromise\n       * @param {string} detectedType\n       * @returns {any}\n       */\n\n\n      function _encapsulate(keypath, value, cyclic, stateObj, promisesData, resolvingTypesonPromise, detectedType) {\n        var ret;\n        var observerData = {};\n\n        var $typeof = _typeof(value);\n\n        var runObserver = encapsulateObserver ? function (obj) {\n          var type = detectedType || stateObj.type || Typeson.getJSONType(value);\n          encapsulateObserver(Object.assign(obj || observerData, {\n            keypath: keypath,\n            value: value,\n            cyclic: cyclic,\n            stateObj: stateObj,\n            promisesData: promisesData,\n            resolvingTypesonPromise: resolvingTypesonPromise,\n            awaitingTypesonPromise: hasConstructorOf(value, TypesonPromise)\n          }, {\n            type: type\n          }));\n        } : null;\n\n        if (['string', 'boolean', 'number', 'undefined'].includes($typeof)) {\n          if (value === undefined || Number.isNaN(value) || value === Number.NEGATIVE_INFINITY || value === Number.POSITIVE_INFINITY) {\n            ret = stateObj.replaced ? value : replace(keypath, value, stateObj, promisesData, false, resolvingTypesonPromise, runObserver);\n\n            if (ret !== value) {\n              observerData = {\n                replaced: ret\n              };\n            }\n          } else {\n            ret = value;\n          }\n\n          if (runObserver) {\n            runObserver();\n          }\n\n          return ret;\n        }\n\n        if (value === null) {\n          if (runObserver) {\n            runObserver();\n          }\n\n          return value;\n        }\n\n        if (cyclic && !stateObj.iterateIn && !stateObj.iterateUnsetNumeric && value && _typeof(value) === 'object') {\n          // Options set to detect cyclic references and be able\n          //   to rewrite them.\n          var refIndex = refObjs.indexOf(value);\n\n          if (refIndex < 0) {\n            if (cyclic === true) {\n              refObjs.push(value);\n              refKeys.push(keypath);\n            }\n          } else {\n            types[keypath] = '#';\n\n            if (runObserver) {\n              runObserver({\n                cyclicKeypath: refKeys[refIndex]\n              });\n            }\n\n            return '#' + refKeys[refIndex];\n          }\n        }\n\n        var isPlainObj = isPlainObject(value);\n        var isArr = isArray(value);\n        var replaced = // Running replace will cause infinite loop as will test\n        //   positive again\n        (isPlainObj || isArr) && (!that.plainObjectReplacers.length || stateObj.replaced) || stateObj.iterateIn ? // Optimization: if plain object and no plain-object\n        //   replacers, don't try finding a replacer\n        value : replace(keypath, value, stateObj, promisesData, isPlainObj || isArr, null, runObserver);\n        var clone;\n\n        if (replaced !== value) {\n          ret = replaced;\n          observerData = {\n            replaced: replaced\n          };\n        } else {\n          // eslint-disable-next-line no-lonely-if\n          if (keypath === '' && hasConstructorOf(value, TypesonPromise)) {\n            promisesData.push([keypath, value, cyclic, stateObj, undefined, undefined, stateObj.type]);\n            ret = value;\n          } else if (isArr && stateObj.iterateIn !== 'object' || stateObj.iterateIn === 'array') {\n            // eslint-disable-next-line unicorn/no-new-array -- Sparse\n            clone = new Array(value.length);\n            observerData = {\n              clone: clone\n            };\n          } else if (!['function', 'symbol'].includes(_typeof(value)) && !('toJSON' in value) && !hasConstructorOf(value, TypesonPromise) && !hasConstructorOf(value, Promise) && !hasConstructorOf(value, ArrayBuffer) || isPlainObj || stateObj.iterateIn === 'object') {\n            clone = {};\n\n            if (stateObj.addLength) {\n              clone.length = value.length;\n            }\n\n            observerData = {\n              clone: clone\n            };\n          } else {\n            ret = value; // Only clone vanilla objects and arrays\n          }\n        }\n\n        if (runObserver) {\n          runObserver();\n        }\n\n        if (opts.iterateNone) {\n          return clone || ret;\n        }\n\n        if (!clone) {\n          return ret;\n        } // Iterate object or array\n\n\n        if (stateObj.iterateIn) {\n          var _loop = function _loop(key) {\n            var ownKeysObj = {\n              ownKeys: hasOwn.call(value, key)\n            };\n\n            _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, function () {\n              var kp = keypath + (keypath ? '.' : '') + escapeKeyPathComponent(key);\n\n              var val = _encapsulate(kp, value[key], Boolean(cyclic), stateObj, promisesData, resolvingTypesonPromise);\n\n              if (hasConstructorOf(val, TypesonPromise)) {\n                promisesData.push([kp, val, Boolean(cyclic), stateObj, clone, key, stateObj.type]);\n              } else if (val !== undefined) {\n                clone[key] = val;\n              }\n            });\n          };\n\n          // eslint-disable-next-line guard-for-in\n          for (var key in value) {\n            _loop(key);\n          }\n\n          if (runObserver) {\n            runObserver({\n              endIterateIn: true,\n              end: true\n            });\n          }\n        } else {\n          // Note: Non-indexes on arrays won't survive stringify so\n          //  somewhat wasteful for arrays, but so too is iterating\n          //  all numeric indexes on sparse arrays when not wanted\n          //  or filtering own keys for positive integers\n          keys(value).forEach(function (key) {\n            var kp = keypath + (keypath ? '.' : '') + escapeKeyPathComponent(key);\n            var ownKeysObj = {\n              ownKeys: true\n            };\n\n            _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, function () {\n              var val = _encapsulate(kp, value[key], Boolean(cyclic), stateObj, promisesData, resolvingTypesonPromise);\n\n              if (hasConstructorOf(val, TypesonPromise)) {\n                promisesData.push([kp, val, Boolean(cyclic), stateObj, clone, key, stateObj.type]);\n              } else if (val !== undefined) {\n                clone[key] = val;\n              }\n            });\n          });\n\n          if (runObserver) {\n            runObserver({\n              endIterateOwn: true,\n              end: true\n            });\n          }\n        } // Iterate array for non-own numeric properties (we can't\n        //   replace the prior loop though as it iterates non-integer\n        //   keys)\n\n\n        if (stateObj.iterateUnsetNumeric) {\n          var vl = value.length;\n\n          var _loop2 = function _loop2(i) {\n            if (!(i in value)) {\n              // No need to escape numeric\n              var kp = keypath + (keypath ? '.' : '') + i;\n              var ownKeysObj = {\n                ownKeys: false\n              };\n\n              _adaptBuiltinStateObjectProperties(stateObj, ownKeysObj, function () {\n                var val = _encapsulate(kp, undefined, Boolean(cyclic), stateObj, promisesData, resolvingTypesonPromise);\n\n                if (hasConstructorOf(val, TypesonPromise)) {\n                  promisesData.push([kp, val, Boolean(cyclic), stateObj, clone, i, stateObj.type]);\n                } else if (val !== undefined) {\n                  clone[i] = val;\n                }\n              });\n            }\n          };\n\n          for (var i = 0; i < vl; i++) {\n            _loop2(i);\n          }\n\n          if (runObserver) {\n            runObserver({\n              endIterateUnsetNumeric: true,\n              end: true\n            });\n          }\n        }\n\n        return clone;\n      }\n      /**\n      * @typedef {PlainObject} KeyPathEvent\n      * @property {string} cyclicKeypath\n      */\n\n      /**\n      * @typedef {PlainObject} EndIterateInEvent\n      * @property {boolean} endIterateIn\n      * @property {boolean} end\n      */\n\n      /**\n      * @typedef {PlainObject} EndIterateUnsetNumericEvent\n      * @property {boolean} endIterateUnsetNumeric\n      * @property {boolean} end\n      */\n\n      /**\n      * @typedef {PlainObject} TypeDetectedEvent\n      * @property {boolean} typeDetected\n      */\n\n      /**\n      * @typedef {PlainObject} ReplacingEvent\n      * @property {boolean} replacing\n      */\n\n      /**\n      * @callback Observer\n      * @param {KeyPathEvent|EndIterateInEvent|EndIterateUnsetNumericEvent|\n      * TypeDetectedEvent|ReplacingEvent} [event]\n      * @returns {void}\n      */\n\n      /**\n       *\n       * @param {string} keypath\n       * @param {any} value\n       * @param {PlainObject} stateObj\n       * @param {GenericArray} promisesData\n       * @param {boolean} plainObject\n       * @param {boolean} resolvingTypesonPromise\n       * @param {Observer} [runObserver]\n       * @returns {any}\n       */\n\n\n      function replace(keypath, value, stateObj, promisesData, plainObject, resolvingTypesonPromise, runObserver) {\n        // Encapsulate registered types\n        var replacers = plainObject ? that.plainObjectReplacers : that.nonplainObjectReplacers;\n        var i = replacers.length;\n\n        while (i--) {\n          var replacer = replacers[i];\n\n          if (replacer.test(value, stateObj)) {\n            var type = replacer.type;\n\n            if (that.revivers[type]) {\n              // Record the type only if a corresponding reviver\n              //   exists. This is to support specs where only\n              //   replacement is done.\n              // For example, ensuring deep cloning of the object,\n              //   or replacing a type to its equivalent without\n              //   the need to revive it.\n              var existing = types[keypath]; // type can comprise an array of types (see test\n              //   \"should support intermediate types\")\n\n              types[keypath] = existing ? [type].concat(existing) : type;\n            }\n\n            Object.assign(stateObj, {\n              type: type,\n              replaced: true\n            });\n\n            if ((sync || !replacer.replaceAsync) && !replacer.replace) {\n              if (runObserver) {\n                runObserver({\n                  typeDetected: true\n                });\n              }\n\n              return _encapsulate(keypath, value, cyclic && 'readonly', stateObj, promisesData, resolvingTypesonPromise, type);\n            }\n\n            if (runObserver) {\n              runObserver({\n                replacing: true\n              });\n            } // Now, also traverse the result in case it contains its\n            //   own types to replace\n\n\n            var replaceMethod = sync || !replacer.replaceAsync ? 'replace' : 'replaceAsync';\n            return _encapsulate(keypath, replacer[replaceMethod](value, stateObj), cyclic && 'readonly', stateObj, promisesData, resolvingTypesonPromise, type);\n          }\n        }\n\n        return value;\n      }\n\n      return promisesDataRoot.length ? sync && opts.throwOnBadSyncType ? function () {\n        throw new TypeError('Sync method requested but async result obtained');\n      }() : Promise.resolve(checkPromises(ret, promisesDataRoot)).then(finish) : !sync && opts.throwOnBadSyncType ? function () {\n        throw new TypeError('Async method requested but sync result obtained');\n      }() // If this is a synchronous request for stringification, yet\n      //   a promise is the result, we don't want to resolve leading\n      //   to an async result, so we return an array to avoid\n      //   ambiguity\n      : opts.stringification && sync ? [finish(ret)] : sync ? finish(ret) : Promise.resolve(finish(ret));\n    }\n    /**\n     * Also sync but throws on non-sync result.\n     * @param {any} obj\n     * @param {StateObject} stateObj\n     * @param {TypesonOptions} opts\n     * @returns {any}\n     */\n\n  }, {\n    key: \"encapsulateSync\",\n    value: function encapsulateSync(obj, stateObj, opts) {\n      return this.encapsulate(obj, stateObj, _objectSpread2(_objectSpread2({\n        throwOnBadSyncType: true\n      }, opts), {}, {\n        sync: true\n      }));\n    }\n    /**\n     * @param {any} obj\n     * @param {StateObject} stateObj\n     * @param {TypesonOptions} opts\n     * @returns {any}\n     */\n\n  }, {\n    key: \"encapsulateAsync\",\n    value: function encapsulateAsync(obj, stateObj, opts) {\n      return this.encapsulate(obj, stateObj, _objectSpread2(_objectSpread2({\n        throwOnBadSyncType: true\n      }, opts), {}, {\n        sync: false\n      }));\n    }\n    /**\n     * Revive an encapsulated object.\n     * This method is used internally by `Typeson.parse()`.\n     * @param {PlainObject} obj - Object to revive. If it has `$types` member,\n     *   the properties that are listed there will be replaced with its true\n     *   type instead of just plain objects.\n     * @param {TypesonOptions} opts\n     * @throws TypeError If mismatch between sync/async type and result\n     * @returns {Promise<any>|any} If async, returns a Promise that resolves\n     * to `any`.\n     */\n\n  }, {\n    key: \"revive\",\n    value: function revive(obj, opts) {\n      var types = obj && obj.$types; // No type info added. Revival not needed.\n\n      if (!types) {\n        return obj;\n      } // Object happened to have own `$types` property but with\n      //   no actual types, so we unescape and return that object\n\n\n      if (types === true) {\n        return obj.$;\n      }\n\n      opts = _objectSpread2(_objectSpread2({\n        sync: true\n      }, this.options), opts);\n      var _opts3 = opts,\n          sync = _opts3.sync;\n      var keyPathResolutions = [];\n      var stateObj = {};\n      var ignore$Types = true; // Special when root object is not a trivial Object, it will\n      //   be encapsulated in `$`. It will also be encapsulated in\n      //   `$` if it has its own `$` property to avoid ambiguity\n\n      if (types.$ && isPlainObject(types.$)) {\n        obj = obj.$;\n        types = types.$;\n        ignore$Types = false;\n      }\n\n      var that = this;\n      /**\n       * @callback RevivalReducer\n       * @param {any} value\n       * @param {string} type\n       * @returns {any}\n       */\n\n      /**\n       *\n       * @param {string} type\n       * @param {any} val\n       * @throws {Error}\n       * @returns {any}\n       */\n\n      function executeReviver(type, val) {\n        var _ref = that.revivers[type] || [],\n            _ref2 = _slicedToArray(_ref, 1),\n            reviver = _ref2[0];\n\n        if (!reviver) {\n          throw new Error('Unregistered type: ' + type);\n        } // Only `sync` expected here, as problematic async would\n        //  be missing both `reviver` and `reviverAsync`, and\n        //  encapsulation shouldn't have added types, so\n        //  should have made an early exit\n\n\n        if (sync && !('revive' in reviver)) {\n          // Just return value as is\n          return val;\n        }\n\n        return reviver[sync && reviver.revive ? 'revive' : !sync && reviver.reviveAsync ? 'reviveAsync' : 'revive'](val, stateObj);\n      }\n      /**\n       *\n       * @returns {void|TypesonPromise<void>}\n       */\n\n\n      function revivePlainObjects() {\n        // const references = [];\n        // const reviveTypes = [];\n        var plainObjectTypes = [];\n        Object.entries(types).forEach(function (_ref3) {\n          var _ref4 = _slicedToArray(_ref3, 2),\n              keypath = _ref4[0],\n              type = _ref4[1];\n\n          if (type === '#') {\n            /*\n            references.push({\n                keypath,\n                reference: getByKeyPath(obj, keypath)\n            });\n            */\n            return;\n          }\n\n          [].concat(type).forEach(function (type) {\n            var _ref5 = that.revivers[type] || [null, {}],\n                _ref6 = _slicedToArray(_ref5, 2),\n                plain = _ref6[1].plain;\n\n            if (!plain) {\n              // reviveTypes.push({keypath, type});\n              return;\n            }\n\n            plainObjectTypes.push({\n              keypath: keypath,\n              type: type\n            });\n            delete types[keypath]; // Avoid repeating\n          });\n        });\n\n        if (!plainObjectTypes.length) {\n          return undefined;\n        } // console.log(plainObjectTypes.sort(nestedPathsFirst));\n\n        /**\n        * @typedef {PlainObject} PlainObjectType\n        * @property {string} keypath\n        * @property {string} type\n        */\n\n\n        return plainObjectTypes.sort(nestedPathsFirst).reduce(function reducer(possibleTypesonPromise, _ref7) {\n          var keypath = _ref7.keypath,\n              type = _ref7.type;\n\n          if (isThenable(possibleTypesonPromise)) {\n            return possibleTypesonPromise.then(function (val) {\n              return reducer(val, {\n                keypath: keypath,\n                type: type\n              });\n            });\n          } // console.log('obj', JSON.stringify(keypath), obj);\n\n\n          var val = getByKeyPath(obj, keypath);\n          val = executeReviver(type, val);\n\n          if (hasConstructorOf(val, TypesonPromise)) {\n            return val.then(function (v) {\n              var newVal = setAtKeyPath(obj, keypath, v);\n\n              if (newVal === v) {\n                obj = newVal;\n              }\n\n              return undefined;\n            });\n          }\n\n          var newVal = setAtKeyPath(obj, keypath, val);\n\n          if (newVal === val) {\n            obj = newVal;\n          }\n\n          return undefined;\n        }, undefined // This argument must be explicit\n        ); // references.forEach(({keypath, reference}) => {});\n        // reviveTypes.sort(nestedPathsFirst).forEach(() => {});\n      }\n\n      var revivalPromises = [];\n      /**\n       *\n       * @param {string} keypath\n       * @param {any} value\n       * @param {?(GenericArray|PlainObject)} target\n       * @param {GenericArray|PlainObject} [clone]\n       * @param {string} [key]\n       * @returns {any}\n       */\n\n      function _revive(keypath, value, target, clone, key) {\n        if (ignore$Types && keypath === '$types') {\n          return undefined;\n        }\n\n        var type = types[keypath];\n        var isArr = isArray(value);\n\n        if (isArr || isPlainObject(value)) {\n          // eslint-disable-next-line unicorn/no-new-array -- Sparse\n          var _clone = isArr ? new Array(value.length) : {}; // Iterate object or array\n\n\n          keys(value).forEach(function (k) {\n            var val = _revive(keypath + (keypath ? '.' : '') + escapeKeyPathComponent(k), value[k], target || _clone, _clone, k);\n\n            var set = function set(v) {\n              if (hasConstructorOf(v, Undefined)) {\n                _clone[k] = undefined;\n              } else if (v !== undefined) {\n                _clone[k] = v;\n              }\n\n              return v;\n            };\n\n            if (hasConstructorOf(val, TypesonPromise)) {\n              revivalPromises.push(val.then(function (ret) {\n                return set(ret);\n              }));\n            } else {\n              set(val);\n            }\n          });\n          value = _clone; // Try to resolve cyclic reference as soon as available\n\n          while (keyPathResolutions.length) {\n            var _keyPathResolutions$ = _slicedToArray(keyPathResolutions[0], 4),\n                _target = _keyPathResolutions$[0],\n                keyPath = _keyPathResolutions$[1],\n                _clone2 = _keyPathResolutions$[2],\n                k = _keyPathResolutions$[3];\n\n            var val = getByKeyPath(_target, keyPath); // Typeson.Undefined not expected here as not cyclic or\n            //   `undefined`\n\n            if (val !== undefined) {\n              _clone2[k] = val;\n            } else {\n              break;\n            }\n\n            keyPathResolutions.splice(0, 1);\n          }\n        }\n\n        if (!type) {\n          return value;\n        }\n\n        if (type === '#') {\n          var _ret = getByKeyPath(target, value.slice(1));\n\n          if (_ret === undefined) {\n            // Cyclic reference not yet available\n            keyPathResolutions.push([target, value.slice(1), clone, key]);\n          }\n\n          return _ret;\n        } // `type` can be an array here\n\n\n        return [].concat(type).reduce(function reducer(val, typ) {\n          if (hasConstructorOf(val, TypesonPromise)) {\n            return val.then(function (v) {\n              // TypesonPromise here too\n              return reducer(v, typ);\n            });\n          }\n\n          return executeReviver(typ, val);\n        }, value);\n      }\n      /**\n       *\n       * @param {any} retrn\n       * @returns {undefined|any}\n       */\n\n\n      function checkUndefined(retrn) {\n        return hasConstructorOf(retrn, Undefined) ? undefined : retrn;\n      }\n\n      var possibleTypesonPromise = revivePlainObjects();\n      var ret;\n\n      if (hasConstructorOf(possibleTypesonPromise, TypesonPromise)) {\n        ret = possibleTypesonPromise.then(function () {\n          return obj;\n        });\n      } else {\n        ret = _revive('', obj, null);\n\n        if (revivalPromises.length) {\n          // Ensure children resolved\n          ret = TypesonPromise.resolve(ret).then(function (r) {\n            return TypesonPromise.all([// May be a TypesonPromise or not\n            r].concat(revivalPromises));\n          }).then(function (_ref8) {\n            var _ref9 = _slicedToArray(_ref8, 1),\n                r = _ref9[0];\n\n            return r;\n          });\n        }\n      }\n\n      return isThenable(ret) ? sync && opts.throwOnBadSyncType ? function () {\n        throw new TypeError('Sync method requested but async result obtained');\n      }() : hasConstructorOf(ret, TypesonPromise) ? ret.p.then(checkUndefined) : ret : !sync && opts.throwOnBadSyncType ? function () {\n        throw new TypeError('Async method requested but sync result obtained');\n      }() : sync ? checkUndefined(ret) : Promise.resolve(checkUndefined(ret));\n    }\n    /**\n     * Also sync but throws on non-sync result.\n     * @param {any} obj\n     * @param {TypesonOptions} opts\n     * @returns {any}\n     */\n\n  }, {\n    key: \"reviveSync\",\n    value: function reviveSync(obj, opts) {\n      return this.revive(obj, _objectSpread2(_objectSpread2({\n        throwOnBadSyncType: true\n      }, opts), {}, {\n        sync: true\n      }));\n    }\n    /**\n    * @param {any} obj\n    * @param {TypesonOptions} opts\n    * @returns {Promise<any>}\n    */\n\n  }, {\n    key: \"reviveAsync\",\n    value: function reviveAsync(obj, opts) {\n      return this.revive(obj, _objectSpread2(_objectSpread2({\n        throwOnBadSyncType: true\n      }, opts), {}, {\n        sync: false\n      }));\n    }\n    /**\n    * @typedef {Tester|Replacer|Reviver} Spec\n    */\n\n    /**\n     * Register types.\n     * For examples on how to use this method, see\n     *   {@link https://github.com/dfahlander/typeson-registry/tree/master/types}.\n     * @param {object<string,Spec[]>[]} typeSpecSets -\n     * Types and their functions [test, encapsulate, revive];\n     * @param {TypesonOptions} opts\n     * @returns {Typeson}\n     */\n\n  }, {\n    key: \"register\",\n    value: function register(typeSpecSets, opts) {\n      opts = opts || {};\n      [].concat(typeSpecSets).forEach(function R(typeSpec) {\n        var _this = this;\n\n        // Allow arrays of arrays of arrays...\n        if (isArray(typeSpec)) {\n          return typeSpec.map(function (typSpec) {\n            return R.call(_this, typSpec);\n          });\n        }\n\n        typeSpec && keys(typeSpec).forEach(function (typeId) {\n          if (typeId === '#') {\n            throw new TypeError('# cannot be used as a type name as it is reserved ' + 'for cyclic objects');\n          } else if (Typeson.JSON_TYPES.includes(typeId)) {\n            throw new TypeError('Plain JSON object types are reserved as type names');\n          }\n\n          var spec = typeSpec[typeId];\n          var replacers = spec && spec.testPlainObjects ? this.plainObjectReplacers : this.nonplainObjectReplacers;\n          var existingReplacer = replacers.filter(function (r) {\n            return r.type === typeId;\n          });\n\n          if (existingReplacer.length) {\n            // Remove existing spec and replace with this one.\n            replacers.splice(replacers.indexOf(existingReplacer[0]), 1);\n            delete this.revivers[typeId];\n            delete this.types[typeId];\n          }\n\n          if (typeof spec === 'function') {\n            // Support registering just a class without replacer/reviver\n            var Class = spec;\n            spec = {\n              test: function test(x) {\n                return x && x.constructor === Class;\n              },\n              replace: function replace(x) {\n                return _objectSpread2({}, x);\n              },\n              revive: function revive(x) {\n                return Object.assign(Object.create(Class.prototype), x);\n              }\n            };\n          } else if (isArray(spec)) {\n            var _spec = spec,\n                _spec2 = _slicedToArray(_spec, 3),\n                test = _spec2[0],\n                replace = _spec2[1],\n                revive = _spec2[2];\n\n            spec = {\n              test: test,\n              replace: replace,\n              revive: revive\n            };\n          }\n\n          if (!spec || !spec.test) {\n            return;\n          }\n\n          var replacerObj = {\n            type: typeId,\n            test: spec.test.bind(spec)\n          };\n\n          if (spec.replace) {\n            replacerObj.replace = spec.replace.bind(spec);\n          }\n\n          if (spec.replaceAsync) {\n            replacerObj.replaceAsync = spec.replaceAsync.bind(spec);\n          }\n\n          var start = typeof opts.fallback === 'number' ? opts.fallback : opts.fallback ? 0 : Number.POSITIVE_INFINITY;\n\n          if (spec.testPlainObjects) {\n            this.plainObjectReplacers.splice(start, 0, replacerObj);\n          } else {\n            this.nonplainObjectReplacers.splice(start, 0, replacerObj);\n          } // Todo: We might consider a testAsync type\n\n\n          if (spec.revive || spec.reviveAsync) {\n            var reviverObj = {};\n\n            if (spec.revive) {\n              reviverObj.revive = spec.revive.bind(spec);\n            }\n\n            if (spec.reviveAsync) {\n              reviverObj.reviveAsync = spec.reviveAsync.bind(spec);\n            }\n\n            this.revivers[typeId] = [reviverObj, {\n              plain: spec.testPlainObjects\n            }];\n          } // Record to be retrieved via public types property.\n\n\n          this.types[typeId] = spec;\n        }, this);\n      }, this);\n      return this;\n    }\n  }]);\n\n  return Typeson;\n}();\n/**\n * We keep this function minimized so if using two instances of this\n * library, where one is minimized and one is not, it will still work\n * with `hasConstructorOf`.\n * @class\n */\n\n\nvar Undefined = function Undefined() {\n  _classCallCheck(this, Undefined);\n}; // eslint-disable-line space-before-blocks\n\n\nUndefined.__typeson__type__ = 'TypesonUndefined'; // The following provide classes meant to avoid clashes with other values\n// To insist `undefined` should be added\n\nTypeson.Undefined = Undefined; // To support async encapsulation/stringification\n\nTypeson.Promise = TypesonPromise; // Some fundamental type-checking utilities\n\nTypeson.isThenable = isThenable;\nTypeson.toStringTag = toStringTag;\nTypeson.hasConstructorOf = hasConstructorOf;\nTypeson.isObject = isObject;\nTypeson.isPlainObject = isPlainObject;\nTypeson.isUserObject = isUserObject;\nTypeson.escapeKeyPathComponent = escapeKeyPathComponent;\nTypeson.unescapeKeyPathComponent = unescapeKeyPathComponent;\nTypeson.getByKeyPath = getByKeyPath;\nTypeson.getJSONType = getJSONType;\nTypeson.JSON_TYPES = ['null', 'boolean', 'number', 'string', 'array', 'object'];\n\nexport default Typeson;\n", "/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2017 Brett Zamir, 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\nvar chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'; // Use a lookup table to find the index.\n\nvar lookup = new Uint8Array(256);\n\nfor (var i = 0; i < chars.length; i++) {\n  lookup[chars.charCodeAt(i)] = i;\n}\n/**\n * @param {ArrayBuffer} arraybuffer\n * @param {Integer} byteOffset\n * @param {Integer} lngth\n * @returns {string}\n */\n\n\nvar encode = function encode(arraybuffer, byteOffset, lngth) {\n  if (lngth === null || lngth === undefined) {\n    lngth = arraybuffer.byteLength; // Needed for Safari\n  }\n\n  var bytes = new Uint8Array(arraybuffer, byteOffset || 0, // Default needed for Safari\n  lngth);\n  var len = bytes.length;\n  var base64 = '';\n\n  for (var _i = 0; _i < len; _i += 3) {\n    base64 += chars[bytes[_i] >> 2];\n    base64 += chars[(bytes[_i] & 3) << 4 | bytes[_i + 1] >> 4];\n    base64 += chars[(bytes[_i + 1] & 15) << 2 | bytes[_i + 2] >> 6];\n    base64 += chars[bytes[_i + 2] & 63];\n  }\n\n  if (len % 3 === 2) {\n    base64 = base64.slice(0, -1) + '=';\n  } else if (len % 3 === 1) {\n    base64 = base64.slice(0, -2) + '==';\n  }\n\n  return base64;\n};\n/**\n * @param {string} base64\n * @returns {ArrayBuffer}\n */\n\nvar decode = function decode(base64) {\n  var len = base64.length;\n  var bufferLength = base64.length * 0.75;\n  var p = 0;\n  var encoded1, encoded2, encoded3, encoded4;\n\n  if (base64[base64.length - 1] === '=') {\n    bufferLength--;\n\n    if (base64[base64.length - 2] === '=') {\n      bufferLength--;\n    }\n  }\n\n  var arraybuffer = new ArrayBuffer(bufferLength),\n      bytes = new Uint8Array(arraybuffer);\n\n  for (var _i2 = 0; _i2 < len; _i2 += 4) {\n    encoded1 = lookup[base64.charCodeAt(_i2)];\n    encoded2 = lookup[base64.charCodeAt(_i2 + 1)];\n    encoded3 = lookup[base64.charCodeAt(_i2 + 2)];\n    encoded4 = lookup[base64.charCodeAt(_i2 + 3)];\n    bytes[p++] = encoded1 << 2 | encoded2 >> 4;\n    bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;\n    bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;\n  }\n\n  return arraybuffer;\n};\n\nexport { decode, encode };\n", "import Typeson from 'typeson';\n\nconst userObject = {\n    userObject: {\n        test (x, stateObj) { return Typeson.isUserObject(x); },\n        replace (n) { return {...n}; },\n        revive (s) { return s; }\n    }\n};\n\nexport default userObject;\n", "const arrayNonindexKeys = [\n    {\n        arrayNonindexKeys: {\n            testPlainObjects: true,\n            test (x, stateObj) {\n                if (Array.isArray(x)) {\n                    if (\n                        // By avoiding serializing arrays into objects which\n                        //  have only positive-integer keys, we reduce\n                        //  size and improve revival performance; arrays with\n                        //  non-index keys will be larger however\n                        Object.keys(x).some((k) => {\n                            //  No need to check for `isNaN` or\n                            //   `isNaN(Number.parseInt())` as `NaN` will be\n                            //   treated as a string.\n                            //  No need to do check as\n                            //   `Number.parseInt(Number())` since scientific\n                            //   notation will be pre-resolved if a number\n                            //   was given, and it will otherwise be a string\n                            return String(Number.parseInt(k)) !== k;\n                        })\n                    ) {\n                        stateObj.iterateIn = 'object';\n                        stateObj.addLength = true;\n                    }\n                    return true;\n                }\n                return false;\n            },\n            replace (a, stateObj) {\n                // Catch sparse undefined\n                stateObj.iterateUnsetNumeric = true;\n                return a;\n            },\n            revive (o) {\n                if (Array.isArray(o)) {\n                    return o;\n                }\n                const arr = [];\n                // No map here as may be a sparse array (including\n                //   with `length` set)\n                // Todo: Reenable when Node `engines` >= 7\n                // Object.entries(o).forEach(([key, val]) => {\n                Object.keys(o).forEach((key) => {\n                    const val = o[key];\n                    arr[key] = val;\n                });\n                return arr;\n            }\n        }\n    },\n    {\n        sparseUndefined: {\n            test (x, stateObj) {\n                return typeof x === 'undefined' && stateObj.ownKeys === false;\n            },\n            replace (n) { return 0; },\n            revive (s) { return undefined; } // Will avoid adding anything\n        }\n    }\n];\n\nexport default arrayNonindexKeys;\n", "// This does not preserve `undefined` in sparse arrays; see the `undefined`\n//  or `sparse-undefined` preset\nimport Typeson from 'typeson';\n\nconst undef = {\n    undef: {\n        test (x, stateObj) {\n            return typeof x === 'undefined' &&\n                (stateObj.ownKeys || !('ownKeys' in stateObj));\n        },\n        replace (n) { return 0; },\n        revive (s) {\n            // Will add `undefined` (returning `undefined` would instead\n            //   avoid explicitly setting)\n            return new Typeson.Undefined();\n        }\n    }\n};\n\nexport default undef;\n", "// This module is for objectified primitives (such as `new Number(3)` or\n//      `new String(\"foo\")`)\n/* eslint-disable no-new-wrappers, unicorn/new-for-builtins */\nimport Typeson from 'typeson';\n\nconst primitiveObjects = {\n    // String Object (not primitive string which need no type spec)\n    StringObject: {\n        test (x) {\n            return Typeson.toStringTag(x) === 'String' && typeof x === 'object';\n        },\n        replace (s) { return String(s); }, // convert to primitive string\n        revive (s) { return new String(s); } // Revive to an objectified string\n    },\n    // Boolean Object (not primitive boolean which need no type spec)\n    BooleanObject: {\n        test (x) {\n            return Typeson.toStringTag(x) === 'Boolean' &&\n                typeof x === 'object';\n        },\n        replace (b) { return Boolean(b); }, // convert to primitive boolean\n        revive (b) {\n            // Revive to an objectified Boolean\n            return new Boolean(b);\n        }\n    },\n    // Number Object (not primitive number which need no type spec)\n    NumberObject: {\n        test (x) {\n            return Typeson.toStringTag(x) === 'Number' && typeof x === 'object';\n        },\n        replace (n) { return Number(n); }, // convert to primitive number\n        revive (n) { return new Number(n); } // Revive to an objectified number\n    }\n};\n/* eslint-enable no-new-wrappers, unicorn/new-for-builtins */\n\nexport default primitiveObjects;\n", "import nan from '../types/nan.js';\nimport infinity from '../types/infinity.js';\nimport NegativeInfinity from '../types/negative-infinity.js';\n\nconst specialNumbers = [\n    nan,\n    infinity,\n    NegativeInfinity\n];\n\nexport default specialNumbers;\n", "const nan = {\n    nan: {\n        test (x) { return Number.isNaN(x); },\n        replace (n) { return 'NaN'; },\n        revive (s) { return Number.NaN; }\n    }\n};\n\nexport default nan;\n", "const infinity = {\n    infinity: {\n        test (x) { return x === Number.POSITIVE_INFINITY; },\n        replace (n) { return 'Infinity'; },\n        revive (s) { return Number.POSITIVE_INFINITY; }\n    }\n};\n\nexport default infinity;\n", "const negativeInfinity = {\n    negativeInfinity: {\n        test (x) { return x === Number.NEGATIVE_INFINITY; },\n        replace (n) { return '-Infinity'; },\n        revive (s) { return Number.NEGATIVE_INFINITY; }\n    }\n};\n\nexport default negativeInfinity;\n", "import Typeson from 'typeson';\n\nconst date = {\n    date: {\n        test (x) { return Typeson.toStringTag(x) === 'Date'; },\n        replace (dt) {\n            const time = dt.getTime();\n            if (Number.isNaN(time)) {\n                return 'NaN';\n            }\n            return time;\n        },\n        revive (time) {\n            if (time === 'NaN') {\n                return new Date(Number.NaN);\n            }\n            return new Date(time);\n        }\n    }\n};\n\nexport default date;\n", "import Typeson from 'typeson';\n\nconst regexp = {\n    regexp: {\n        test (x) { return Typeson.toStringTag(x) === 'RegExp'; },\n        replace (rexp) {\n            return {\n                source: rexp.source,\n                flags: (rexp.global ? 'g' : '') +\n                    (rexp.ignoreCase ? 'i' : '') +\n                    (rexp.multiline ? 'm' : '') +\n                    (rexp.sticky ? 'y' : '') +\n                    (rexp.unicode ? 'u' : '')\n            };\n        },\n        revive ({source, flags}) { return new RegExp(source, flags); }\n    }\n};\n\nexport default regexp;\n", "import Typeson from 'typeson';\n\nconst map = {\n    map: {\n        test (x) { return Typeson.toStringTag(x) === 'Map'; },\n        replace (mp) { return [...mp.entries()]; },\n        revive (entries) { return new Map(entries); }\n    }\n};\n\nexport default map;\n", "import Typeson from 'typeson';\n\nconst set = {\n    set: {\n        test (x) { return Typeson.toStringTag(x) === 'Set'; },\n        replace (st) {\n            return [...st.values()];\n        },\n        revive (values) { return new Set(values); }\n    }\n};\n\nexport default set;\n", "import Typeson from 'typeson';\nimport {encode, decode} from 'base64-arraybuffer-es6';\n\nconst arraybuffer = {\n    arraybuffer: {\n        test (x) { return Typeson.toStringTag(x) === 'ArrayBuffer'; },\n        replace (b, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            const index = stateObj.buffers.indexOf(b);\n            if (index > -1) {\n                return {index};\n            }\n            stateObj.buffers.push(b);\n            return encode(b);\n        },\n        revive (b64, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            if (typeof b64 === 'object') {\n                return stateObj.buffers[b64.index];\n            }\n            const buffer = decode(b64);\n            stateObj.buffers.push(buffer);\n            return buffer;\n        }\n    }\n};\n\nexport default arraybuffer;\n\n// See also typed-arrays!\n", "/* eslint-env browser, node */\nimport Typeson from 'typeson';\nimport {encode, decode} from 'base64-arraybuffer-es6';\n\n/* istanbul ignore next */\nconst _global = typeof self === 'undefined' ? global : self;\n\nconst typedArrays = {};\n[\n    'Int8Array',\n    'Uint8Array',\n    'Uint8ClampedArray',\n    'Int16Array',\n    'Uint16Array',\n    'Int32Array',\n    'Uint32Array',\n    'Float32Array',\n    'Float64Array'\n].forEach(function (typeName) {\n    const arrType = typeName;\n    const TypedArray = _global[arrType];\n    /* istanbul ignore if */\n    if (!TypedArray) {\n        return;\n    }\n    typedArrays[typeName.toLowerCase()] = {\n        test (x) { return Typeson.toStringTag(x) === arrType; },\n        replace ({buffer, byteOffset, length: l}, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            const index = stateObj.buffers.indexOf(buffer);\n            if (index > -1) {\n                return {index, byteOffset, length: l};\n            }\n            stateObj.buffers.push(buffer);\n            return {\n                encoded: encode(buffer),\n                byteOffset,\n                length: l\n            };\n        },\n        revive (b64Obj, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            const {byteOffset, length: len, encoded, index} = b64Obj;\n            let buffer;\n            if ('index' in b64Obj) {\n                buffer = stateObj.buffers[index];\n            } else {\n                buffer = decode(encoded);\n                stateObj.buffers.push(buffer);\n            }\n            return new TypedArray(buffer, byteOffset, len);\n        }\n    };\n});\n\nexport default typedArrays;\n", "import Typeson from 'typeson';\nimport {encode, decode} from 'base64-arraybuffer-es6';\n\nconst dataview = {\n    dataview: {\n        test (x) { return Typeson.toStringTag(x) === 'DataView'; },\n        replace ({buffer, byteOffset, byteLength}, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            const index = stateObj.buffers.indexOf(buffer);\n            if (index > -1) {\n                return {index, byteOffset, byteLength};\n            }\n            stateObj.buffers.push(buffer);\n            return {\n                encoded: encode(buffer),\n                byteOffset,\n                byteLength\n            };\n        },\n        revive (b64Obj, stateObj) {\n            if (!stateObj.buffers) {\n                stateObj.buffers = [];\n            }\n            const {byteOffset, byteLength, encoded, index} = b64Obj;\n            let buffer;\n            if ('index' in b64Obj) {\n                buffer = stateObj.buffers[index];\n            } else {\n                buffer = decode(encoded);\n                stateObj.buffers.push(buffer);\n            }\n            return new DataView(buffer, byteOffset, byteLength);\n        }\n    }\n};\n\nexport default dataview;\n", "import Typeson from 'typeson';\n\nconst IntlCollator = {\n    test (x) { return Typeson.hasConstructorOf(x, Intl.Collator); },\n    replace (c) { return c.resolvedOptions(); },\n    revive (options) { return new Intl.Collator(options.locale, options); }\n};\n\nconst IntlDateTimeFormat = {\n    test (x) { return Typeson.hasConstructorOf(x, Intl.DateTimeFormat); },\n    replace (dtf) { return dtf.resolvedOptions(); },\n    revive (options) {\n        return new Intl.DateTimeFormat(options.locale, options);\n    }\n};\n\nconst IntlNumberFormat = {\n    test (x) { return Typeson.hasConstructorOf(x, Intl.NumberFormat); },\n    replace (nf) { return nf.resolvedOptions(); },\n    revive (options) { return new Intl.NumberFormat(options.locale, options); }\n};\n\nconst intlTypes = {\n    IntlCollator,\n    IntlDateTimeFormat,\n    IntlNumberFormat\n};\n\nexport default intlTypes;\n", "/**\n * Not currently in use internally, but provided for parity.\n * @param {ArrayBuffer} buf\n * @returns {Uint8Array}\n */\nfunction arraybuffer2string (buf) {\n    return new Uint8Array(buf).reduce(\n        (s, byte) => s + String.fromCharCode(byte), ''\n    );\n}\n\n/**\n *\n * @param {string} str\n * @returns {ArrayBuffer}\n */\nfunction string2arraybuffer (str) {\n    /*\n    // UTF-8 approaches\n    const utf8 = unescape(encodeURIComponent(str));\n    const arr = new Uint8Array(utf8.length);\n    for (let i = 0; i < utf8.length; i++) {\n        arr[i] = utf8.charCodeAt(i);\n    }\n    return arr.buffer;\n\n    const utf8 = [];\n    for (let i = 0; i < str.length; i++) {\n        let charcode = str.charCodeAt(i);\n        if (charcode < 0x80) utf8.push(charcode);\n        else if (charcode < 0x800) {\n            utf8.push(0xc0 | (charcode >> 6),\n                0x80 | (charcode & 0x3f));\n        } else if (charcode < 0xd800 || charcode >= 0xe000) {\n            utf8.push(0xe0 | (charcode >> 12),\n                0x80 | ((charcode >> 6) & 0x3f),\n                0x80 | (charcode & 0x3f));\n        // surrogate pair\n        } else {\n            i++;\n            // UTF-16 encodes 0x10000-0x10FFFF by\n            // subtracting 0x10000 and splitting the\n            // 20 bits of 0x0-0xFFFFF into two halves\n            charcode = 0x10000 + (((charcode & 0x3ff) << 10) |\n                (str.charCodeAt(i) & 0x3ff));\n            utf8.push(0xf0 | (charcode >> 18),\n                0x80 | ((charcode >> 12) & 0x3f),\n                0x80 | ((charcode >> 6) & 0x3f),\n                0x80 | (charcode & 0x3f));\n        }\n    }\n    return utf8;\n    */\n    /*\n    // Working UTF-16 options (equivalents)\n    const buf = new ArrayBuffer(str.length * 2); // 2 bytes for each char\n    const bufView = new Uint16Array(buf);\n    for (let i = 0, strLen = str.length; i < strLen; i++) {\n        bufView[i] = str.charCodeAt(i);\n    }\n    return buf;\n    */\n\n    const array = new Uint8Array(str.length);\n    for (let i = 0; i < str.length; i++) {\n        array[i] = str.charCodeAt(i); // & 0xff;\n    }\n    return array.buffer;\n}\nexport {arraybuffer2string, string2arraybuffer};\n", "/* globals XMLHttpRequest, File, FileReader */\nimport Typeson from 'typeson';\nimport {string2arraybuffer} from '../utils/stringArrayBuffer.js';\n\nconst file = {\n    file: {\n        test (x) { return Typeson.toStringTag(x) === 'File'; },\n        replace (f) { // Sync\n            const req = new XMLHttpRequest();\n            req.overrideMimeType('text/plain; charset=x-user-defined');\n            req.open('GET', URL.createObjectURL(f), false); // Sync\n            req.send();\n\n            // Seems not feasible to accurately simulate\n            /* istanbul ignore next */\n            if (req.status !== 200 && req.status !== 0) {\n                throw new Error('Bad File access: ' + req.status);\n            }\n            return {\n                type: f.type,\n                stringContents: req.responseText,\n                name: f.name,\n                lastModified: f.lastModified\n            };\n        },\n        revive ({name, type, stringContents, lastModified}) {\n            return new File([string2arraybuffer(stringContents)], name, {\n                type,\n                lastModified\n            });\n        },\n        replaceAsync (f) {\n            return new Typeson.Promise(function (resolve, reject) {\n                /*\n                if (f.isClosed) { // On MDN, but not in https://w3c.github.io/FileAPI/#dfn-Blob\n                    reject(new Error('The File is closed'));\n                    return;\n                }\n                */\n                const reader = new FileReader();\n                reader.addEventListener('load', function () {\n                    resolve({\n                        type: f.type,\n                        stringContents: reader.result,\n                        name: f.name,\n                        lastModified: f.lastModified\n                    });\n                });\n                // Seems not feasible to accurately simulate\n                /* istanbul ignore next */\n                reader.addEventListener('error', function () {\n                    reject(reader.error);\n                });\n                reader.readAsBinaryString(f);\n            });\n        }\n    }\n};\n\nexport default file;\n", "/* globals BigInt */\n\nconst bigint = {\n    bigint: {\n        test (x) {\n            return typeof x === 'bigint';\n        },\n        replace (n) { return String(n); },\n        revive (s) { return BigInt(s); }\n    }\n};\n\nexport default bigint;\n", "/* globals BigInt */\nimport Typeson from 'typeson';\n\nconst bigintObject = {\n    bigintObject: {\n        test (x) {\n            return typeof x === 'object' && Typeson.hasConstructorOf(x, BigInt);\n        },\n        replace (n) { return String(n); },\n        revive (s) {\n            // Filed this to avoid error: https://github.com/eslint/eslint/issues/11810\n            // eslint-disable-next-line no-new-object\n            return new Object(BigInt(s));\n        }\n    }\n};\n\nexport default bigintObject;\n", "/* globals crypto */\nimport Typeson from 'typeson';\n\nconst cryptokey = {\n    cryptokey: {\n        test (x) {\n            return Typeson.toStringTag(x) === 'CryptoKey' && x.extractable;\n        },\n        replaceAsync (key) {\n            return new Typeson.Promise((resolve, reject) => {\n                // eslint-disable-next-line promise/catch-or-return\n                crypto.subtle.exportKey('jwk', key).catch(\n                    /* eslint-disable promise/prefer-await-to-callbacks */\n                    // istanbul ignore next\n                    (err) => {\n                        /* eslint-enable promise/prefer-await-to-callbacks */\n                        // eslint-disable-next-line max-len\n                        // istanbul ignore next -- Our format should be valid and our key extractable\n                        reject(err);\n                    }\n                // eslint-disable-next-line max-len\n                // eslint-disable-next-line promise/always-return, promise/prefer-await-to-then\n                ).then((jwk) => {\n                    resolve({\n                        jwk,\n                        algorithm: key.algorithm,\n                        usages: key.usages\n                    });\n                });\n            });\n        },\n        revive ({jwk, algorithm, usages}) {\n            return crypto.subtle.importKey('jwk', jwk, algorithm, true, usages);\n        }\n    }\n};\n\nexport default cryptokey;\n", "/* This preset includes types for the Structured Cloning Algorithm. */\n\nimport userObject from '../types/user-object.js';\nimport arrayNonindexKeys from './array-nonindex-keys.js';\nimport undef from '../types/undef.js';\nimport primitiveObjects from '../types/primitive-objects.js';\nimport specialNumbers from './special-numbers.js';\nimport date from '../types/date.js';\nimport regexp from '../types/regexp.js';\nimport map from '../types/map.js';\nimport set from '../types/set.js';\nimport arraybuffer from '../types/arraybuffer.js';\nimport typedArrays from '../types/typed-arrays.js';\nimport dataview from '../types/dataview.js';\nimport intlTypes from '../types/intl-types.js';\n\nimport imagedata from '../types/imagedata.js';\nimport imagebitmap from '../types/imagebitmap.js'; // Async return\nimport file from '../types/file.js';\nimport filelist from '../types/filelist.js';\nimport blob from '../types/blob.js';\nimport bigint from '../types/bigint.js';\nimport bigintObject from '../types/bigint-object.js';\n\nimport cryptokey from '../types/cryptokey.js';\n\nconst expObj = [\n    // Todo: Might also register synchronous `ImageBitmap` and\n    //    `Blob`/`File`/`FileList`?\n    // ES5\n    userObject, // Processed last (non-builtin)\n\n    undef,\n    arrayNonindexKeys, primitiveObjects, specialNumbers,\n    date, regexp,\n\n    // Non-built-ins\n    imagedata,\n    imagebitmap, // Async return\n    file,\n    filelist,\n    blob\n].concat(\n    // ES2015 (ES6)\n    /* istanbul ignore next */\n    typeof Map === 'function' ? map : [],\n    /* istanbul ignore next */\n    typeof Set === 'function' ? set : [],\n    /* istanbul ignore next */\n    typeof ArrayBuffer === 'function' ? arraybuffer : [],\n    /* istanbul ignore next */\n    typeof Uint8Array === 'function' ? typedArrays : [],\n    /* istanbul ignore next */\n    typeof DataView === 'function' ? dataview : [],\n    /* istanbul ignore next */\n    typeof Intl !== 'undefined' ? intlTypes : [],\n    /* istanbul ignore next */\n    typeof crypto !== 'undefined' ? cryptokey : [],\n    /* istanbul ignore next */\n    typeof BigInt !== 'undefined' ? [bigint, bigintObject] : []\n);\nexport default expObj;\n", "/* globals ImageData */\n// `ImageData` is browser / DOM specific (though `node-canvas` has it\n//   available on `Canvas`).\n\nimport Typeson from 'typeson';\n\nconst imagedata = {\n    imagedata: {\n        test (x) { return Typeson.toStringTag(x) === 'ImageData'; },\n        replace (d) {\n            return {\n                // Ensure `length` gets preserved for revival\n                array: [...d.data],\n                width: d.width,\n                height: d.height\n            };\n        },\n        revive (o) {\n            return new ImageData(\n                new Uint8ClampedArray(o.array), o.width, o.height\n            );\n        }\n    }\n};\n\nexport default imagedata;\n", "/* globals createImageBitmap */\n// `ImageBitmap` is browser / DOM specific. It also can only work\n//  same-domain (or CORS)\n\nimport Typeson from 'typeson';\n\nconst imagebitmap = {\n    imagebitmap: {\n        test (x) {\n            return Typeson.toStringTag(x) === 'ImageBitmap' ||\n                // In Node, our polyfill sets the dataset on a canvas\n                //  element as JSDom no longer allows overriding toStringTag\n                (x && x.dataset && x.dataset.toStringTag === 'ImageBitmap');\n        },\n        replace (bm) {\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            ctx.drawImage(bm, 0, 0);\n            // Although `width` and `height` are part of `ImageBitMap`,\n            //   these will be auto-created for us when reviving with the\n            //   data URL (and they are not settable even if they weren't)\n            // return {\n            //   width: bm.width, height: bm.height, dataURL: canvas.toDataURL()\n            // };\n            return canvas.toDataURL();\n        },\n        revive (o) {\n            /*\n            var req = new XMLHttpRequest();\n            req.open('GET', o, false); // Sync\n            if (req.status !== 200 && req.status !== 0) {\n              throw new Error('Bad ImageBitmap access: ' + req.status);\n            }\n            req.send();\n            return req.responseText;\n            */\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            const img = document.createElement('img');\n            // The onload is needed by some browsers per http://stackoverflow.com/a/4776378/271577\n            img.addEventListener('load', function () {\n                ctx.drawImage(img, 0, 0);\n            });\n            img.src = o;\n            // Works in contexts allowing an `ImageBitmap` (We might use\n            //   `OffscreenCanvas.transferToBitmap` when supported)\n            return canvas;\n        },\n        reviveAsync (o) {\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            const img = document.createElement('img');\n            // The onload is needed by some browsers per http://stackoverflow.com/a/4776378/271577\n            img.addEventListener('load', function () {\n                ctx.drawImage(img, 0, 0);\n            });\n            img.src = o; // o.dataURL;\n            return createImageBitmap(canvas); // Returns a promise\n        }\n    }\n};\n\nexport default imagebitmap;\n", "import Typeson from 'typeson';\nimport file from './file.js';\n\nconst filelist = {\n    file: file.file,\n    filelist: {\n        test (x) { return Typeson.toStringTag(x) === 'FileList'; },\n        replace (fl) {\n            const arr = [];\n            for (let i = 0; i < fl.length; i++) {\n                arr[i] = fl.item(i);\n            }\n            return arr;\n        },\n        revive (o) {\n            /**\n             * `FileList` polyfill.\n             */\n            class FileList {\n                /**\n                 * Set private properties and length.\n                 */\n                constructor () {\n                    // eslint-disable-next-line prefer-rest-params\n                    this._files = arguments[0];\n                    this.length = this._files.length;\n                }\n                /**\n                 * @param {Integer} index\n                 * @returns {File}\n                 */\n                item (index) {\n                    return this._files[index];\n                }\n                /* eslint-disable class-methods-use-this */\n                /**\n                 * @returns {\"FileList\"}\n                 */\n                get [Symbol.toStringTag] () {\n                    /* eslint-enable class-methods-use-this */\n                    return 'FileList';\n                }\n            }\n            return new FileList(o);\n        }\n    }\n};\n\nexport default filelist;\n", "/* globals XMLHttpRequest, Blob, FileReader */\nimport Typeson from 'typeson';\nimport {string2arraybuffer} from '../utils/stringArrayBuffer.js';\n\nconst blob = {\n    blob: {\n        test (x) { return Typeson.toStringTag(x) === 'Blob'; },\n        replace (b) { // Sync\n            const req = new XMLHttpRequest();\n            req.overrideMimeType('text/plain; charset=x-user-defined');\n            req.open('GET', URL.createObjectURL(b), false); // Sync\n            req.send();\n\n            // Seems not feasible to accurately simulate\n            /* istanbul ignore next */\n            if (req.status !== 200 && req.status !== 0) {\n                throw new Error('Bad Blob access: ' + req.status);\n            }\n            return {\n                type: b.type,\n                stringContents: req.responseText\n            };\n        },\n        revive ({type, stringContents}) {\n            return new Blob([string2arraybuffer(stringContents)], {type});\n        },\n        replaceAsync (b) {\n            return new Typeson.Promise((resolve, reject) => {\n                /*\n                if (b.isClosed) { // On MDN, but not in https://w3c.github.io/FileAPI/#dfn-Blob\n                    reject(new Error('The Blob is closed'));\n                    return;\n                }\n                */\n                const reader = new FileReader();\n                reader.addEventListener('load', () => {\n                    resolve({\n                        type: b.type,\n                        stringContents: reader.result\n                    });\n                });\n                // Seems not feasible to accurately simulate\n                /* istanbul ignore next */\n                reader.addEventListener('error', () => {\n                    reject(reader.error);\n                });\n                reader.readAsBinaryString(b);\n            });\n        }\n    }\n};\n\nexport default blob;\n", "/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2017 Brett Zamir, 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\nvar chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'; // Use a lookup table to find the index.\n\nvar lookup = new Uint8Array(256);\n\nfor (var i = 0; i < chars.length; i++) {\n  lookup[chars.codePointAt(i)] = i;\n}\n/**\n * @param {ArrayBuffer} arraybuffer\n * @param {Integer} byteOffset\n * @param {Integer} lngth\n * @returns {string}\n */\n\n\nvar encode = function encode(arraybuffer, byteOffset, lngth) {\n  if (lngth === null || lngth === undefined) {\n    lngth = arraybuffer.byteLength; // Needed for Safari\n  }\n\n  var bytes = new Uint8Array(arraybuffer, byteOffset || 0, // Default needed for Safari\n  lngth);\n  var len = bytes.length;\n  var base64 = '';\n\n  for (var _i = 0; _i < len; _i += 3) {\n    base64 += chars[bytes[_i] >> 2];\n    base64 += chars[(bytes[_i] & 3) << 4 | bytes[_i + 1] >> 4];\n    base64 += chars[(bytes[_i + 1] & 15) << 2 | bytes[_i + 2] >> 6];\n    base64 += chars[bytes[_i + 2] & 63];\n  }\n\n  if (len % 3 === 2) {\n    base64 = base64.slice(0, -1) + '=';\n  } else if (len % 3 === 1) {\n    base64 = base64.slice(0, -2) + '==';\n  }\n\n  return base64;\n};\n/**\n * @param {string} base64\n * @returns {ArrayBuffer}\n */\n\nvar decode = function decode(base64) {\n  var len = base64.length;\n  var bufferLength = base64.length * 0.75;\n  var p = 0;\n  var encoded1, encoded2, encoded3, encoded4;\n\n  if (base64[base64.length - 1] === '=') {\n    bufferLength--;\n\n    if (base64[base64.length - 2] === '=') {\n      bufferLength--;\n    }\n  }\n\n  var arraybuffer = new ArrayBuffer(bufferLength),\n      bytes = new Uint8Array(arraybuffer);\n\n  for (var _i2 = 0; _i2 < len; _i2 += 4) {\n    encoded1 = lookup[base64.codePointAt(_i2)];\n    encoded2 = lookup[base64.codePointAt(_i2 + 1)];\n    encoded3 = lookup[base64.codePointAt(_i2 + 2)];\n    encoded4 = lookup[base64.codePointAt(_i2 + 3)];\n    bytes[p++] = encoded1 << 2 | encoded2 >> 4;\n    bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;\n    bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;\n  }\n\n  return arraybuffer;\n};\n\nexport { decode, encode };\n", "declare var global;\n\n/* eslint-env browser, node */\nimport Typeson from 'typeson';\nimport {encode, decode} from 'base64-arraybuffer-es6';\n\nconst _global = typeof self === 'undefined' ? global : self;\n\nconst exportObj = {};\n[\n    'Int8Array',\n    'Uint8Array',\n    'Uint8ClampedArray',\n    'Int16Array',\n    'Uint16Array',\n    'Int32Array',\n    'Uint32Array',\n    'Float32Array',\n    'Float64Array'\n].forEach(function (typeName) {\n    const arrType = typeName;\n    const TypedArray = _global[arrType];\n    if (TypedArray) {\n        exportObj[typeName.toLowerCase()+\"2\"] = {\n            test (x) { return Typeson.toStringTag(x) === arrType; },\n            replace ({buffer, byteOffset, length}) {\n                return {\n                    buffer,\n                    byteOffset,\n                    length\n                };\n            },\n            revive (b64Obj) {\n                const {buffer, byteOffset, length} = b64Obj;\n                return new TypedArray(buffer, byteOffset, length);\n            }\n        };\n    }\n});\n\nexport default exportObj;\n", "import Typeson from 'typeson';\nimport {encode, decode} from 'base64-arraybuffer-es6';\n\nexport default {\n    arraybuffer: {\n        test (x) { return Typeson.toStringTag(x) === 'ArrayBuffer'; },\n        replace (b) {\n            return encode(b, 0, b.byteLength);\n        },\n        revive (b64) {\n            const buffer = decode(b64);\n            return buffer;\n        }\n    }\n};\n\n// See also typed-arrays!\n", "import Typeson from 'typeson';\nimport StructuredCloning from 'typeson-registry/dist/presets/structured-cloning';\nimport { encode as encodeB64, decode as decodeB64 } from 'base64-arraybuffer-es6';\nimport Dexie from 'dexie';\nimport { readBlobSync, readBlobAsync } from './helpers';\nimport typedArray from './tson-typed-array';\nimport arrayBuffer from './tson-arraybuffer';\n\nexport const TSON = new Typeson().register(StructuredCloning);\n\nconst readBlobsSynchronously = 'FileReaderSync' in self; // true in workers only.\n\nlet blobsToAwait: any[] = [];\nlet blobsToAwaitPos = 0;\n\n// Need to patch encapsulateAsync as it does not work as of typeson 5.8.2\n// Also, current version of typespn-registry-1.0.0-alpha.21 does not\n// encapsulate/revive Blobs correctly (fails one of the unit tests in\n// this library (test 'export-format'))\nTSON.register([\n  arrayBuffer,\n  typedArray, {\n    blob2: {\n      test(x) { return Typeson.toStringTag(x) === 'Blob'; },\n      replace(b) {\n          if (b.isClosed) { // On MDN, but not in https://w3c.github.io/FileAPI/#dfn-Blob\n            throw new Error('The Blob is closed');\n          }\n          if (readBlobsSynchronously) {\n            const data = readBlobSync(b, 'binary');\n            const base64 = encodeB64(data, 0, data.byteLength);\n            return {\n              type: b.type,\n              data: base64\n            }\n          } else {\n            blobsToAwait.push(b); // This will also make TSON.mustFinalize() return true.\n            const result = {\n              type: b.type,\n              data: {start: blobsToAwaitPos, end: blobsToAwaitPos + b.size}\n            }\n            blobsToAwaitPos += b.size;\n            return result;\n          }\n      },\n      finalize(b, ba: ArrayBuffer) {\n        b.data = encodeB64(ba, 0, ba.byteLength);\n      },\n      revive ({type, data}) {\n        return new Blob([decodeB64(data)], {type});\n      }\n    }\n  }\n]);\n\nTSON.mustFinalize = ()=>blobsToAwait.length > 0;\n\nTSON.finalize = async (items?: any[]) => {\n  const allChunks = await readBlobAsync(new Blob(blobsToAwait), 'binary');\n  if (items) {\n    for (const item of items) {\n      // Manually go through all \"blob\" types in the result\n      // and lookup the data slice they point at.\n      if (item.$types) {\n        let types = item.$types;\n        const arrayType = types.$;\n        if (arrayType) types = types.$;\n        for (let keyPath in types) {\n          const typeName = types[keyPath];\n          const typeSpec = TSON.types[typeName];\n          if (typeSpec && typeSpec.finalize) {\n            const b = Dexie.getByKeyPath(item, arrayType ? \"$.\" + keyPath : keyPath);\n            typeSpec.finalize(b, allChunks.slice(b.start, b.end));\n          }\n        }\n      }\n    }\n  }\n  // Free up memory\n  blobsToAwait = [];\n}\n", "\nimport Dexie from 'dexie';\nimport { getSchemaString, extractDbSchema } from './helpers';\nimport { DexieExportedTable, DexieExportJsonStructure } from './json-structure';\nimport { TSON } from './tson';\n\nexport interface ExportOptions {\n  skipTables?: string[],\n  noTransaction?: boolean;\n  numRowsPerChunk?: number;\n  prettyJson?: boolean;\n  filter?: (table: string, value: any, key?: any) => boolean;\n  transform?: (table: string, value: any, key?: any) => ({value: any, key?: any});\n  progressCallback?: (progress: ExportProgress) => boolean;\n}\n\nexport interface ExportProgress {\n  totalTables: number;\n  completedTables: number;\n  totalRows: number | undefined;\n  completedRows: number;\n  done: boolean;\n}\n\nconst DEFAULT_ROWS_PER_CHUNK = 2000;\n\nexport async function exportDB(db: Dexie, options?: ExportOptions): Promise<Blob> {\n  options = options || {};\n  const skipTables = options.skipTables? options.skipTables: []\n  const targetTables = db.tables.filter((x)=> !skipTables.includes(x.name))\n  const slices: (string | Blob)[] = [];\n  const tables = targetTables.map(table => ({\n    name: table.name,\n    schema: getSchemaString(table),\n    rowCount: 0\n  }));\n  const {prettyJson} = options!;\n  const emptyExport: DexieExportJsonStructure = {\n    formatName: \"dexie\",\n    formatVersion: 1,\n    data: {\n      databaseName: db.name,\n      databaseVersion: db.verno,\n      tables: tables,\n      data: []\n    }\n  };\n  \n  const {progressCallback} = options!;\n  const progress: ExportProgress = {\n    done: false,\n    completedRows: 0,\n    completedTables: 0,\n    totalRows: NaN,\n    totalTables: tables.length\n  };\n\n  try {\n    if (options!.noTransaction) {\n      await exportAll();\n    } else {\n      await db.transaction('r', db.tables, exportAll);\n    }\n  } finally {\n    TSON.finalize(); // Free up mem if error has occurred\n  }\n\n  return new Blob(slices,{type: \"text/json\"});\n\n  async function exportAll() {\n    // Count rows:\n    const tablesRowCounts = await Promise.all(targetTables.map(table => table.count()));\n    tablesRowCounts.forEach((rowCount, i) => tables[i].rowCount = rowCount);\n    progress.totalRows = tablesRowCounts.reduce((p,c)=>p+c);\n\n    // Write first JSON slice\n    const emptyExportJson = JSON.stringify(emptyExport, undefined, prettyJson ? 2 : undefined);\n    const posEndDataArray = emptyExportJson.lastIndexOf(']');\n    const firstJsonSlice = emptyExportJson.substring(0, posEndDataArray);\n    slices.push(firstJsonSlice);\n\n    const filter = options!.filter;\n    const transform = options!.transform;\n\n    for (const {name: tableName} of tables) {\n      const table = db.table(tableName);\n      const {primKey} = table.schema;\n      const inbound = !!primKey.keyPath;\n      const LIMIT = options!.numRowsPerChunk || DEFAULT_ROWS_PER_CHUNK;\n      const emptyTableExport: DexieExportedTable = inbound ? {\n        tableName: table.name,\n        inbound: true,\n        rows: []\n      } : {\n        tableName: table.name,\n        inbound: false,\n        rows: []\n      };\n      let emptyTableExportJson = JSON.stringify(emptyTableExport, undefined, prettyJson ? 2 : undefined);\n      if (prettyJson) {\n        // Increase indentation according to this:\n        // {\n        //   ...\n        //   data: [\n        //     ...\n        //     data: [\n        // 123456<---- here\n        //     ] \n        //   ]\n        // }\n        emptyTableExportJson = emptyTableExportJson.split('\\n').join('\\n    ');\n      }\n      const posEndRowsArray = emptyTableExportJson.lastIndexOf(']');\n      slices.push(emptyTableExportJson.substring(0, posEndRowsArray));\n      let lastKey: any = null;\n      let lastNumRows = 0;\n      let mayHaveMoreRows = true;\n      while (mayHaveMoreRows) {\n        if (progressCallback) {\n          // Keep ongoing transaction private\n          Dexie.ignoreTransaction(()=>progressCallback(progress));\n        }\n        const chunkedCollection = lastKey == null ?\n          table.limit(LIMIT) :\n          table.where(':id').above(lastKey).limit(LIMIT);\n\n        const values = await chunkedCollection.toArray();\n\n        if (values.length === 0) break;\n\n        if (lastKey != null && lastNumRows > 0) {\n          // Not initial chunk. Must add a comma:\n          slices.push(\",\");\n          if (prettyJson) {\n            slices.push(\"\\n      \");\n          }\n        }\n\n        mayHaveMoreRows = values.length === LIMIT;\n        \n        if (inbound) {\n          const filteredValues = filter ?\n            values.filter(value => filter(tableName, value)) :\n            values;\n\n          const transformedValues = transform ?\n            filteredValues.map(value => transform(tableName, value).value) :\n            filteredValues;\n\n          const tsonValues = transformedValues.map(value => TSON.encapsulate(value));\n          if (TSON.mustFinalize()) {\n            await Dexie.waitFor(TSON.finalize(tsonValues));\n          }\n\n          let json = JSON.stringify(tsonValues, undefined, prettyJson ? 2 : undefined);\n          if (prettyJson) json = json.split('\\n').join('\\n      ');\n\n          // By generating a blob here, we give web platform the opportunity to store the contents\n          // on disk and release RAM.\n          slices.push(new Blob([json.substring(1, json.length - 1)]));\n          lastNumRows = transformedValues.length;\n          lastKey = values.length > 0 ?\n            Dexie.getByKeyPath(values[values.length -1], primKey.keyPath as string) :\n            null;\n        } else {\n          const keys = await chunkedCollection.primaryKeys();\n          let keyvals = keys.map((key, i) => [key, values[i]]);\n          if (filter) keyvals = keyvals.filter(([key, value]) => filter(tableName, value, key));\n          if (transform) keyvals = keyvals.map(([key, value]) => {\n            const transformResult = transform(tableName, value, key);\n            return [transformResult.key, transformResult.value];\n          });\n\n          const tsonTuples = keyvals.map(tuple => TSON.encapsulate(tuple));\n          if (TSON.mustFinalize()) {\n            await Dexie.waitFor(TSON.finalize(tsonTuples));\n          }\n\n          let json = JSON.stringify(tsonTuples, undefined, prettyJson ? 2 : undefined);\n          if (prettyJson) json = json.split('\\n').join('\\n      ');\n\n          // By generating a blob here, we give web platform the opportunity to store the contents\n          // on disk and release RAM.\n          slices.push(new Blob([json.substring(1, json.length - 1)]));\n          lastNumRows = keyvals.length;\n          lastKey = keys.length > 0 ?\n            keys[keys.length - 1] :\n            null;\n        }\n        progress.completedRows += values.length;\n      }\n      slices.push(emptyTableExportJson.substr(posEndRowsArray)); // \"]}\"\n      progress.completedTables += 1;\n      if (progress.completedTables < progress.totalTables) {\n        slices.push(\",\");\n      }\n    }\n    slices.push(emptyExportJson.substr(posEndDataArray));\n    progress.done = true;\n    if (progressCallback) {\n      // Keep ongoing transaction private\n      Dexie.ignoreTransaction(()=>progressCallback(progress));\n    }\n  }\n}\n", "export const VERSION = 1;\n\n/** Same as DexieExportJsonStructure but without the data.data array */\nexport interface DexieExportJsonMeta {\n  formatName: 'dexie';\n  formatVersion: typeof VERSION;\n  data: {\n    databaseName: string;\n    databaseVersion: number;\n    tables: Array<{\n      name: string;\n      schema: string;\n      rowCount: number;\n    }>;\n  }\n}\n\nexport interface DexieExportJsonStructure extends DexieExportJsonMeta {\n  formatName: 'dexie';\n  formatVersion: typeof VERSION;\n  data: {\n    databaseName: string;\n    databaseVersion: number;\n    tables: Array<{\n      name: string;\n      schema: string;\n      rowCount: number;\n    }>;\n    data: Array<{\n      tableName: string;\n      inbound: boolean;\n      rows: any[];\n    }>;\n  }\n}\n\nexport type DexieExportedDatabase = DexieExportJsonStructure[\"data\"];\nexport type DexieExportedTable = DexieExportedDatabase[\"data\"][number];\n", "module.exports = {Stream: function(){}};\n\n", ";(function (clarinet) {\n  \"use strict\";\n\n  // non node-js needs to set clarinet debug on root\n  var env =(typeof process === 'object' && process.env)\n    ? process.env\n    : self;\n\n  clarinet.parser            = function (opt) { return new CParser(opt);};\n  clarinet.CParser           = CParser;\n  clarinet.CStream           = CStream;\n  clarinet.createStream      = createStream;\n  clarinet.MAX_BUFFER_LENGTH = 10 * 1024 * 1024;\n  clarinet.DEBUG             = (env.CDEBUG==='debug');\n  clarinet.INFO              = (env.CDEBUG==='debug' || env.CDEBUG==='info');\n  clarinet.EVENTS            =\n    [ \"value\"\n    , \"string\"\n    , \"key\"\n    , \"openobject\"\n    , \"closeobject\"\n    , \"openarray\"\n    , \"closearray\"\n    , \"error\"\n    , \"end\"\n    , \"ready\"\n    ];\n\n  var buffers     = {\n        textNode: undefined,\n        numberNode: \"\"\n    }\n    , streamWraps = clarinet.EVENTS.filter(function (ev) {\n          return ev !== \"error\" && ev !== \"end\";\n        })\n    , S           = 0\n    , Stream\n    ;\n\n  clarinet.STATE =\n    { BEGIN                             : S++\n    , VALUE                             : S++ // general stuff\n    , OPEN_OBJECT                       : S++ // {\n    , CLOSE_OBJECT                      : S++ // }\n    , OPEN_ARRAY                        : S++ // [\n    , CLOSE_ARRAY                       : S++ // ]\n    , TEXT_ESCAPE                       : S++ // \\ stuff\n    , STRING                            : S++ // \"\"\n    , BACKSLASH                         : S++\n    , END                               : S++ // No more stack\n    , OPEN_KEY                          : S++ // , \"a\"\n    , CLOSE_KEY                         : S++ // :\n    , TRUE                              : S++ // r\n    , TRUE2                             : S++ // u\n    , TRUE3                             : S++ // e\n    , FALSE                             : S++ // a\n    , FALSE2                            : S++ // l\n    , FALSE3                            : S++ // s\n    , FALSE4                            : S++ // e\n    , NULL                              : S++ // u\n    , NULL2                             : S++ // l\n    , NULL3                             : S++ // l\n    , NUMBER_DECIMAL_POINT              : S++ // .\n    , NUMBER_DIGIT                      : S++ // [0-9]\n    };\n\n  for (var s_ in clarinet.STATE) clarinet.STATE[clarinet.STATE[s_]] = s_;\n\n  // switcharoo\n  S = clarinet.STATE;\n\n  const Char = {\n    tab                 : 0x09,     // \\t\n    lineFeed            : 0x0A,     // \\n\n    carriageReturn      : 0x0D,     // \\r\n    space               : 0x20,     // \" \"\n\n    doubleQuote         : 0x22,     // \"\n    plus                : 0x2B,     // +\n    comma               : 0x2C,     // ,\n    minus               : 0x2D,     // -\n    period              : 0x2E,     // .\n\n    _0                  : 0x30,     // 0\n    _9                  : 0x39,     // 9\n\n    colon               : 0x3A,     // :\n\n    E                   : 0x45,     // E\n\n    openBracket         : 0x5B,     // [\n    backslash           : 0x5C,     // \\\n    closeBracket        : 0x5D,     // ]\n\n    a                   : 0x61,     // a\n    b                   : 0x62,     // b\n    e                   : 0x65,     // e \n    f                   : 0x66,     // f\n    l                   : 0x6C,     // l\n    n                   : 0x6E,     // n\n    r                   : 0x72,     // r\n    s                   : 0x73,     // s\n    t                   : 0x74,     // t\n    u                   : 0x75,     // u\n\n    openBrace           : 0x7B,     // {\n    closeBrace          : 0x7D,     // }\n  }\n\n  if (!Object.create) {\n    Object.create = function (o) {\n      function f () { this[\"__proto__\"] = o; }\n      f.prototype = o;\n      return new f;\n    };\n  }\n\n  if (!Object.getPrototypeOf) {\n    Object.getPrototypeOf = function (o) {\n      return o[\"__proto__\"];\n    };\n  }\n\n  if (!Object.keys) {\n    Object.keys = function (o) {\n      var a = [];\n      for (var i in o) if (o.hasOwnProperty(i)) a.push(i);\n      return a;\n    };\n  }\n\n  function checkBufferLength (parser) {\n    var maxAllowed = Math.max(clarinet.MAX_BUFFER_LENGTH, 10)\n      , maxActual = 0\n      ;\n    for (var buffer in buffers) {\n      var len = parser[buffer] === undefined ? 0 : parser[buffer].length;\n      if (len > maxAllowed) {\n        switch (buffer) {\n          case \"text\":\n            closeText(parser);\n          break;\n\n          default:\n            error(parser, \"Max buffer length exceeded: \"+ buffer);\n        }\n      }\n      maxActual = Math.max(maxActual, len);\n    }\n    parser.bufferCheckPosition = (clarinet.MAX_BUFFER_LENGTH - maxActual)\n                               + parser.position;\n  }\n\n  function clearBuffers (parser) {\n    for (var buffer in buffers) {\n      parser[buffer] = buffers[buffer];\n    }\n  }\n\n  var stringTokenPattern = /[\\\\\"\\n]/g;\n\n  function CParser (opt) {\n    if (!(this instanceof CParser)) return new CParser (opt);\n\n    var parser = this;\n    clearBuffers(parser);\n    parser.bufferCheckPosition = clarinet.MAX_BUFFER_LENGTH;\n    parser.q        = parser.c = parser.p = \"\";\n    parser.opt      = opt || {};\n    parser.closed   = parser.closedRoot = parser.sawRoot = false;\n    parser.tag      = parser.error = null;\n    parser.state    = S.BEGIN;\n    parser.stack    = new Array();\n    // mostly just for error reporting\n    parser.position = parser.column = 0;\n    parser.line     = 1;\n    parser.slashed  = false;\n    parser.unicodeI = 0;\n    parser.unicodeS = null;\n    parser.depth    = 0;\n    emit(parser, \"onready\");\n  }\n\n  CParser.prototype =\n    { end    : function () { end(this); }\n    , write  : write\n    , resume : function () { this.error = null; return this; }\n    , close  : function () { return this.write(null); }\n    };\n\n  try        { Stream = require(\"stream\").Stream; }\n  catch (ex) { Stream = function () {}; }\n\n  function createStream (opt) { return new CStream(opt); }\n\n  function CStream (opt) {\n    if (!(this instanceof CStream)) return new CStream(opt);\n\n    this._parser = new CParser(opt);\n    this.writable = true;\n    this.readable = true;\n\n    //var Buffer = this.Buffer || function Buffer () {}; // if we don't have Buffers, fake it so we can do `var instanceof Buffer` and not throw an error\n    this.bytes_remaining = 0; // number of bytes remaining in multi byte utf8 char to read after split boundary\n    this.bytes_in_sequence = 0; // bytes in multi byte utf8 char to read\n    this.temp_buffs = { \"2\": new Buffer(2), \"3\": new Buffer(3), \"4\": new Buffer(4) }; // for rebuilding chars split before boundary is reached\n    this.string = '';\n\n    var me = this;\n    Stream.apply(me);\n\n    this._parser.onend = function () { me.emit(\"end\"); };\n    this._parser.onerror = function (er) {\n      me.emit(\"error\", er);\n      me._parser.error = null;\n    };\n\n    streamWraps.forEach(function (ev) {\n      Object.defineProperty(me, \"on\" + ev,\n        { get          : function () { return me._parser[\"on\" + ev]; }\n        , set          : function (h) {\n            if (!h) {\n              me.removeAllListeners(ev);\n              me._parser[\"on\"+ev] = h;\n              return h;\n            }\n            me.on(ev, h);\n          }\n        , enumerable   : true\n        , configurable : false\n        });\n    });\n  }\n\n  CStream.prototype = Object.create(Stream.prototype,\n    { constructor: { value: CStream } });\n\n  CStream.prototype.write = function (data) {\n    data = new Buffer(data);\n    for (var i = 0; i < data.length; i++) {\n      var n = data[i];\n\n      // check for carry over of a multi byte char split between data chunks\n      // & fill temp buffer it with start of this data chunk up to the boundary limit set in the last iteration\n      if (this.bytes_remaining > 0) {\n        for (var j = 0; j < this.bytes_remaining; j++) {\n          this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence - this.bytes_remaining + j] = data[j];\n        }\n        this.string = this.temp_buffs[this.bytes_in_sequence].toString();\n        this.bytes_in_sequence = this.bytes_remaining = 0;\n\n        // move iterator forward by number of byte read during sequencing\n        i = i + j - 1;\n\n        // pass data to parser and move forward to parse rest of data\n        this._parser.write(this.string);\n        this.emit(\"data\", this.string);\n        continue;\n      }\n\n      // if no remainder bytes carried over, parse multi byte (>=128) chars one at a time\n      if (this.bytes_remaining === 0 && n >= 128) {\n        if ((n >= 194) && (n <= 223)) this.bytes_in_sequence = 2;\n        if ((n >= 224) && (n <= 239)) this.bytes_in_sequence = 3;\n        if ((n >= 240) && (n <= 244)) this.bytes_in_sequence = 4;\n        if ((this.bytes_in_sequence + i) > data.length) { // if bytes needed to complete char fall outside data length, we have a boundary split\n\n          for (var k = 0; k <= (data.length - 1 - i); k++) {\n            this.temp_buffs[this.bytes_in_sequence][k] = data[i + k]; // fill temp data of correct size with bytes available in this chunk\n          }\n          this.bytes_remaining = (i + this.bytes_in_sequence) - data.length;\n\n          // immediately return as we need another chunk to sequence the character\n          return true;\n        } else {\n          this.string = data.slice(i, (i + this.bytes_in_sequence)).toString();\n          i = i + this.bytes_in_sequence - 1;\n\n          this._parser.write(this.string);\n          this.emit(\"data\", this.string);\n          continue;\n        }\n      }\n\n      // is there a range of characters that are immediately parsable?\n      for (var p = i; p < data.length; p++) {\n        if (data[p] >= 128) break;\n      }\n      this.string = data.slice(i, p).toString();\n      this._parser.write(this.string);\n      this.emit(\"data\", this.string);\n      i = p - 1;\n\n      // handle any remaining characters using multibyte logic\n      continue;\n    }\n  };\n\n  CStream.prototype.end = function (chunk) {\n    if (chunk && chunk.length) this._parser.write(chunk.toString());\n    this._parser.end();\n    return true;\n  };\n\n  CStream.prototype.on = function (ev, handler) {\n    var me = this;\n    if (!me._parser[\"on\"+ev] && streamWraps.indexOf(ev) !== -1) {\n      me._parser[\"on\"+ev] = function () {\n        var args = arguments.length === 1 ? [arguments[0]]\n                 : Array.apply(null, arguments);\n        args.splice(0, 0, ev);\n        me.emit.apply(me, args);\n      };\n    }\n    return Stream.prototype.on.call(me, ev, handler);\n  };\n\n  CStream.prototype.destroy = function () {\n    clearBuffers(this._parser);\n    this.emit(\"close\");\n  };\n\n  function emit(parser, event, data) {\n    if(clarinet.INFO) console.log('-- emit', event, data);\n    if (parser[event]) parser[event](data);\n  }\n\n  function emitNode(parser, event, data) {\n    closeValue(parser);\n    emit(parser, event, data);\n  }\n\n  function closeValue(parser, event) {\n    parser.textNode = textopts(parser.opt, parser.textNode);\n    if (parser.textNode !== undefined) {\n      emit(parser, (event ? event : \"onvalue\"), parser.textNode);\n    }\n    parser.textNode = undefined;\n  }\n\n  function closeNumber(parser) {\n    if (parser.numberNode)\n      emit(parser, \"onvalue\", parseFloat(parser.numberNode));\n    parser.numberNode = \"\";\n  }\n\n  function textopts (opt, text) {\n    if (text === undefined) {\n      return text;\n    }\n    if (opt.trim) text = text.trim();\n    if (opt.normalize) text = text.replace(/\\s+/g, \" \");\n    return text;\n  }\n\n  function error (parser, er) {\n    closeValue(parser);\n    er += \"\\nLine: \"+parser.line+\n          \"\\nColumn: \"+parser.column+\n          \"\\nChar: \"+parser.c;\n    er = new Error(er);\n    parser.error = er;\n    emit(parser, \"onerror\", er);\n    return parser;\n  }\n\n  function end(parser) {\n    if (parser.state !== S.VALUE || parser.depth !== 0)\n      error(parser, \"Unexpected end\");\n\n    closeValue(parser);\n    parser.c      = \"\";\n    parser.closed = true;\n    emit(parser, \"onend\");\n    CParser.call(parser, parser.opt);\n    return parser;\n  }\n\n  function isWhitespace(c) {\n    return c === Char.carriageReturn || c === Char.lineFeed || c === Char.space || c === Char.tab;\n  }\n\n  function write (chunk) {\n    var parser = this;\n    if (this.error) throw this.error;\n    if (parser.closed) return error(parser,\n      \"Cannot write after close. Assign an onready handler.\");\n    if (chunk === null) return end(parser);\n    var i = 0, c = chunk.charCodeAt(0), p = parser.p;\n    if (clarinet.DEBUG) console.log('write -> [' + chunk + ']');\n    while (c) {\n      p = c;\n      parser.c = c = chunk.charCodeAt(i++);\n      // if chunk doesnt have next, like streaming char by char\n      // this way we need to check if previous is really previous\n      // if not we need to reset to what the parser says is the previous\n      // from buffer\n      if(p !== c ) parser.p = p;\n      else p = parser.p;\n\n      if(!c) break;\n\n      if (clarinet.DEBUG) console.log(i,c,clarinet.STATE[parser.state]);\n      parser.position ++;\n      if (c === Char.lineFeed) {\n        parser.line ++;\n        parser.column = 0;\n      } else parser.column ++;\n      switch (parser.state) {\n\n        case S.BEGIN:\n          if (c === Char.openBrace) parser.state = S.OPEN_OBJECT;\n          else if (c === Char.openBracket) parser.state = S.OPEN_ARRAY;\n          else if (!isWhitespace(c))\n            error(parser, \"Non-whitespace before {[.\");\n        continue;\n\n        case S.OPEN_KEY:\n        case S.OPEN_OBJECT:\n          if (isWhitespace(c)) continue;\n          if(parser.state === S.OPEN_KEY) parser.stack.push(S.CLOSE_KEY);\n          else {\n            if(c === Char.closeBrace) {\n              emit(parser, 'onopenobject');\n              this.depth++;\n              emit(parser, 'oncloseobject');\n              this.depth--;\n              parser.state = parser.stack.pop() || S.VALUE;\n              continue;\n            } else  parser.stack.push(S.CLOSE_OBJECT);\n          }\n          if(c === Char.doubleQuote) parser.state = S.STRING;\n          else error(parser, \"Malformed object key should start with \\\"\");\n        continue;\n\n        case S.CLOSE_KEY:\n        case S.CLOSE_OBJECT:\n          if (isWhitespace(c)) continue;\n          var event = (parser.state === S.CLOSE_KEY) ? 'key' : 'object';\n          if(c === Char.colon) {\n            if(parser.state === S.CLOSE_OBJECT) {\n              parser.stack.push(S.CLOSE_OBJECT);\n              closeValue(parser, 'onopenobject');\n               this.depth++;\n            } else closeValue(parser, 'onkey');\n            parser.state  = S.VALUE;\n          } else if (c === Char.closeBrace) {\n            emitNode(parser, 'oncloseobject');\n            this.depth--;\n            parser.state = parser.stack.pop() || S.VALUE;\n          } else if(c === Char.comma) {\n            if(parser.state === S.CLOSE_OBJECT)\n              parser.stack.push(S.CLOSE_OBJECT);\n            closeValue(parser);\n            parser.state  = S.OPEN_KEY;\n          } else error(parser, 'Bad object');\n        continue;\n\n        case S.OPEN_ARRAY: // after an array there always a value\n        case S.VALUE:\n          if (isWhitespace(c)) continue;\n          if(parser.state===S.OPEN_ARRAY) {\n            emit(parser, 'onopenarray');\n            this.depth++;\n            parser.state = S.VALUE;\n            if(c === Char.closeBracket) {\n              emit(parser, 'onclosearray');\n              this.depth--;\n              parser.state = parser.stack.pop() || S.VALUE;\n              continue;\n            } else {\n              parser.stack.push(S.CLOSE_ARRAY);\n            }\n          }\n               if(c === Char.doubleQuote) parser.state = S.STRING;\n          else if(c === Char.openBrace) parser.state = S.OPEN_OBJECT;\n          else if(c === Char.openBracket) parser.state = S.OPEN_ARRAY;\n          else if(c === Char.t) parser.state = S.TRUE;\n          else if(c === Char.f) parser.state = S.FALSE;\n          else if(c === Char.n) parser.state = S.NULL;\n          else if(c === Char.minus) { // keep and continue\n            parser.numberNode += \"-\";\n          } else if(Char._0 <= c && c <= Char._9) {\n            parser.numberNode += String.fromCharCode(c);\n            parser.state = S.NUMBER_DIGIT;\n          } else               error(parser, \"Bad value\");\n        continue;\n\n        case S.CLOSE_ARRAY:\n          if(c === Char.comma) {\n            parser.stack.push(S.CLOSE_ARRAY);\n            closeValue(parser, 'onvalue');\n            parser.state  = S.VALUE;\n          } else if (c === Char.closeBracket) {\n            emitNode(parser, 'onclosearray');\n            this.depth--;\n            parser.state = parser.stack.pop() || S.VALUE;\n          } else if (isWhitespace(c))\n              continue;\n          else error(parser, 'Bad array');\n        continue;\n\n        case S.STRING:\n          if (parser.textNode === undefined) {\n            parser.textNode = \"\";\n          }\n\n          // thanks thejh, this is an about 50% performance improvement.\n          var starti              = i-1\n            , slashed = parser.slashed\n            , unicodeI = parser.unicodeI\n            ;\n          STRING_BIGLOOP: while (true) {\n            if (clarinet.DEBUG)\n              console.log(i,c,clarinet.STATE[parser.state]\n                         ,slashed);\n            // zero means \"no unicode active\". 1-4 mean \"parse some more\". end after 4.\n            while (unicodeI > 0) {\n              parser.unicodeS += String.fromCharCode(c);\n              c = chunk.charCodeAt(i++);\n              parser.position++;\n              if (unicodeI === 4) {\n                // TODO this might be slow? well, probably not used too often anyway\n                parser.textNode += String.fromCharCode(parseInt(parser.unicodeS, 16));\n                unicodeI = 0;\n                starti = i-1;\n              } else {\n                unicodeI++;\n              }\n              // we can just break here: no stuff we skipped that still has to be sliced out or so\n              if (!c) break STRING_BIGLOOP;\n            }\n            if (c === Char.doubleQuote && !slashed) {\n              parser.state = parser.stack.pop() || S.VALUE;\n              parser.textNode += chunk.substring(starti, i-1);\n              parser.position += i - 1 - starti;\n              break;\n            }\n            if (c === Char.backslash && !slashed) {\n              slashed = true;\n              parser.textNode += chunk.substring(starti, i-1);\n              parser.position += i - 1 - starti;\n              c = chunk.charCodeAt(i++);\n              parser.position++;\n              if (!c) break;\n            }\n            if (slashed) {\n              slashed = false;\n                   if (c === Char.n) { parser.textNode += '\\n'; }\n              else if (c === Char.r) { parser.textNode += '\\r'; }\n              else if (c === Char.t) { parser.textNode += '\\t'; }\n              else if (c === Char.f) { parser.textNode += '\\f'; }\n              else if (c === Char.b) { parser.textNode += '\\b'; }\n              else if (c === Char.u) {\n                // \\uxxxx. meh!\n                unicodeI = 1;\n                parser.unicodeS = '';\n              } else {\n                parser.textNode += String.fromCharCode(c);\n              }\n              c = chunk.charCodeAt(i++);\n              parser.position++;\n              starti = i-1;\n              if (!c) break;\n              else continue;\n            }\n\n            stringTokenPattern.lastIndex = i;\n            var reResult = stringTokenPattern.exec(chunk);\n            if (reResult === null) {\n              i = chunk.length+1;\n              parser.textNode += chunk.substring(starti, i-1);\n              parser.position += i - 1 - starti;\n              break;\n            }\n            i = reResult.index+1;\n            c = chunk.charCodeAt(reResult.index);\n            if (!c) {\n              parser.textNode += chunk.substring(starti, i-1);\n              parser.position += i - 1 - starti;\n              break;\n            }\n          }\n          parser.slashed = slashed;\n          parser.unicodeI = unicodeI;\n        continue;\n\n        case S.TRUE:\n          if (c === Char.r) parser.state = S.TRUE2;\n          else error(parser, 'Invalid true started with t'+ c);\n        continue;\n\n        case S.TRUE2:\n          if (c === Char.u) parser.state = S.TRUE3;\n          else error(parser, 'Invalid true started with tr'+ c);\n        continue;\n\n        case S.TRUE3:\n          if(c === Char.e) {\n            emit(parser, \"onvalue\", true);\n            parser.state = parser.stack.pop() || S.VALUE;\n          } else error(parser, 'Invalid true started with tru'+ c);\n        continue;\n\n        case S.FALSE:\n          if (c === Char.a) parser.state = S.FALSE2;\n          else error(parser, 'Invalid false started with f'+ c);\n        continue;\n\n        case S.FALSE2:\n          if (c === Char.l) parser.state = S.FALSE3;\n          else error(parser, 'Invalid false started with fa'+ c);\n        continue;\n\n        case S.FALSE3:\n          if (c === Char.s) parser.state = S.FALSE4;\n          else error(parser, 'Invalid false started with fal'+ c);\n        continue;\n\n        case S.FALSE4:\n          if (c === Char.e) {\n            emit(parser, \"onvalue\", false);\n            parser.state = parser.stack.pop() || S.VALUE;\n          } else error(parser, 'Invalid false started with fals'+ c);\n        continue;\n\n        case S.NULL:\n          if (c === Char.u) parser.state = S.NULL2;\n          else error(parser, 'Invalid null started with n'+ c);\n        continue;\n\n        case S.NULL2:\n          if (c === Char.l) parser.state = S.NULL3;\n          else error(parser, 'Invalid null started with nu'+ c);\n        continue;\n\n        case S.NULL3:\n          if(c === Char.l) {\n            emit(parser, \"onvalue\", null);\n            parser.state = parser.stack.pop() || S.VALUE;\n          } else error(parser, 'Invalid null started with nul'+ c);\n        continue;\n\n        case S.NUMBER_DECIMAL_POINT:\n          if(c === Char.period) {\n            parser.numberNode += \".\";\n            parser.state       = S.NUMBER_DIGIT;\n          } else error(parser, 'Leading zero not followed by .');\n        continue;\n\n        case S.NUMBER_DIGIT:\n          if(Char._0 <= c && c <= Char._9) parser.numberNode += String.fromCharCode(c);\n          else if (c === Char.period) {\n            if(parser.numberNode.indexOf('.')!==-1)\n              error(parser, 'Invalid number has two dots');\n            parser.numberNode += \".\";\n          } else if (c === Char.e || c === Char.E) {\n            if(parser.numberNode.indexOf('e')!==-1 ||\n               parser.numberNode.indexOf('E')!==-1 )\n               error(parser, 'Invalid number has two exponential');\n            parser.numberNode += \"e\";\n          } else if (c === Char.plus || c === Char.minus) {\n            if(!(p === Char.e || p === Char.E))\n              error(parser, 'Invalid symbol in number');\n            parser.numberNode += String.fromCharCode(c);\n          } else {\n            closeNumber(parser);\n            i--; // go back one\n            parser.state = parser.stack.pop() || S.VALUE;\n          }\n        continue;\n\n        default:\n          error(parser, \"Unknown state: \" + parser.state);\n      }\n    }\n    if (parser.position >= parser.bufferCheckPosition)\n      checkBufferLength(parser);\n    return parser;\n  }\n\n})(typeof exports === \"undefined\" ? clarinet = {} : exports);\n", "import clarinet from 'clarinet';\nimport { readBlobAsync, readBlobSync } from './helpers';\n\nexport interface JsonStream<T> {\n  pullAsync(numBytes: number): Promise<Partial<T>>;\n  pullSync(numBytes: number): Partial<T>;\n  done(): boolean;\n  eof(): boolean;\n  result: Partial<T>;\n}\n\nexport function JsonStream<T>(blob: Blob):  JsonStream<T> {\n  let pos = 0;\n  const parser = JsonParser(true);\n\n  const rv = {\n    async pullAsync(numBytes: number): Promise<Partial<T>> {\n      const slize = blob.slice(pos, pos + numBytes);\n      pos += numBytes;\n      const jsonPart = await readBlobAsync(slize, 'text');\n      const result = parser.write(jsonPart);\n      rv.result = result || {};\n      return result;\n    },\n    pullSync(numBytes: number): Partial<T> {\n      const slize = blob.slice(pos, pos + numBytes);\n      pos += numBytes;\n      const jsonPart = readBlobSync(slize, 'text');\n      const result = parser.write(jsonPart);\n      rv.result = result || {};\n      return result;\n    },\n    done() {\n      return parser.done();\n    },\n    eof() {\n      return pos >= blob.size;\n    },\n    result: {}\n  }\n\n  return rv;\n}\n\n\nexport function JsonParser (allowPartial: boolean) {\n  const parser = (clarinet as any).parser();\n  let level = 0;\n  let result: any;\n  const stack: any[][] = [];\n  let obj: any;\n  let key: string | null;\n  let done = false;\n  let array = false;\n\n  parser.onopenobject = newKey => {\n    const newObj = {};\n    (newObj as any).incomplete = true;\n    if (!result) result = newObj;\n    if (obj) {\n      stack.push([key,obj,array])\n      if (allowPartial) {\n        if (array) {\n          obj.push(newObj);\n        } else {\n          obj[key!] = newObj;\n        }\n      }\n    }\n    obj = newObj;\n    key = newKey;\n    array = false;\n    ++level;\n  }\n  parser.onkey = newKey => key = newKey;\n  parser.onvalue = value => array ? obj.push(value) : obj[key!] = value;\n  parser.oncloseobject = ()=>{\n    delete obj.incomplete;\n    key = null;\n    if (--level === 0) {\n      done = true;\n    } else {\n      const completedObj = obj;\n      [key, obj, array] = stack.pop()!;\n      if (!allowPartial) {\n        if (array) {\n          obj.push(completedObj);\n        } else {\n          obj[key!] = completedObj;\n        }\n      }\n    }\n  }\n  parser.onopenarray = () => {\n    const newObj = [];\n    (newObj as any).incomplete = true;\n    if (!result) result = newObj;\n    if (obj) {\n      stack.push([key,obj,array])\n      if (allowPartial) {\n        if (array) {\n          obj.push(newObj);\n        } else {\n          obj[key!] = newObj;\n        }\n      }\n    }\n    obj = newObj;\n    array = true;\n    key = null;\n    ++level;\n  }\n  parser.onclosearray = () => {\n    delete obj.incomplete;\n    key = null;\n    if (--level === 0) {\n      done = true;\n    } else {\n      const completedObj = obj;\n      [key, obj, array] = stack.pop()!;\n      if (!allowPartial) {\n        if (array) {\n          obj.push(completedObj);\n        } else {\n          obj[key!] = completedObj;\n        }\n      }\n    }\n  }\n\n  return {\n    write(jsonPart: string) {\n      parser.write(jsonPart);\n      return result;\n    },\n    done() {\n      return done;\n    }\n  }\n}\n", "import Dexie from 'dexie';\nimport { extractDbSchema } from './helpers';\nimport { DexieExportJsonMeta, DexieExportJsonStructure, VERSION } from './json-structure';\nimport { TSON } from './tson';\nimport { JsonStream } from './json-stream';\n\nexport interface StaticImportOptions {\n  noTransaction?: boolean;\n  chunkSizeBytes?: number; // Default: DEFAULT_KILOBYTES_PER_CHUNK ( 1MB )\n  filter?: (table: string, value: any, key?: any) => boolean;\n  transform?: (table: string, value: any, key?: any) => ({value: any, key?: any});\n  progressCallback?: (progress: ImportProgress) => boolean;\n}\n\nexport interface ImportOptions extends StaticImportOptions {\n  acceptMissingTables?: boolean;\n  acceptVersionDiff?: boolean;\n  acceptNameDiff?: boolean;\n  acceptChangedPrimaryKey?: boolean;\n  overwriteValues?: boolean;\n  clearTablesBeforeImport?: boolean;\n  skipTables?: string[],\n  noTransaction?: boolean;\n  chunkSizeBytes?: number; // Default: DEFAULT_KILOBYTES_PER_CHUNK ( 1MB )\n  filter?: (table: string, value: any, key?: any) => boolean;\n  transform?: (table: string, value: any, key?: any) => ({value: any, key?: any});\n  progressCallback?: (progress: ImportProgress) => boolean;\n}\n\nconst DEFAULT_KILOBYTES_PER_CHUNK = 1024;\n\nexport interface ImportProgress {\n  totalTables: number;\n  completedTables: number;\n  totalRows: number | undefined;\n  completedRows: number;\n  done: boolean;\n}\n\nexport async function importDB(exportedData: Blob | JsonStream<DexieExportJsonStructure>, options?: StaticImportOptions): Promise<Dexie> {\n  options = options || {}; // All booleans defaults to false.\n  const CHUNK_SIZE = options!.chunkSizeBytes || (DEFAULT_KILOBYTES_PER_CHUNK * 1024);\n  const stream = await loadUntilWeGotEnoughData(exportedData, CHUNK_SIZE);\n  const dbExport = stream.result.data!;\n  const db = new Dexie(dbExport.databaseName);\n  db.version(dbExport.databaseVersion).stores(extractDbSchema(dbExport));\n  await importInto(db, stream, options);\n  return db;\n}\n\nexport async function peakImportFile(exportedData: Blob): Promise<DexieExportJsonMeta> {\n  const stream = JsonStream<DexieExportJsonStructure>(exportedData);\n  while (!stream.eof()) {\n    await stream.pullAsync(5 * 1024); // 5 k is normally enough for the headers. If not, it will just do another go.\n    if (stream.result.data && stream.result.data!.data) {\n      // @ts-ignore - TS won't allow us to delete a required property - but we are going to cast it.\n      delete stream.result.data.data; // Don't return half-baked data array.\n      break;\n    }\n  }\n  return stream.result as DexieExportJsonMeta;\n}\n\nexport async function importInto(db: Dexie, exportedData: Blob | JsonStream<DexieExportJsonStructure>, options?: ImportOptions): Promise<void> {\n  options = options || {}; // All booleans defaults to false.\n  const CHUNK_SIZE = options!.chunkSizeBytes || (DEFAULT_KILOBYTES_PER_CHUNK * 1024);\n  const jsonStream = await loadUntilWeGotEnoughData(exportedData, CHUNK_SIZE);\n  let dbExportFile = jsonStream.result;\n  const readBlobsSynchronously = 'FileReaderSync' in self; // true in workers only.\n\n  const dbExport = dbExportFile.data!;\n  const skipTables = options.skipTables? options.skipTables: []\n\n  if (!options!.acceptNameDiff && db.name !== dbExport.databaseName)\n    throw new Error(`Name differs. Current database name is ${db.name} but export is ${dbExport.databaseName}`);\n  if (!options!.acceptVersionDiff && db.verno !== dbExport.databaseVersion) {\n    // Possible feature: Call upgraders in some isolated way if this happens... ?\n    throw new Error(`Database version differs. Current database is in version ${db.verno} but export is ${dbExport.databaseVersion}`);\n  }\n  \n  const { progressCallback } = options;\n  const progress: ImportProgress = {\n    done: false,\n    completedRows: 0,\n    completedTables: 0,\n    totalRows: dbExport.tables.reduce((p, c) => p + c.rowCount, 0),\n    totalTables: dbExport.tables.length\n  };\n  if (progressCallback) {\n    // Keep ongoing transaction private\n    Dexie.ignoreTransaction(()=>progressCallback(progress));\n  }\n\n  if (options!.clearTablesBeforeImport) {\n    for (const table of db.tables) {\n      if(skipTables.includes(table.name) ) continue;\n      await table.clear();\n    }\n  }\n\n  if (options.noTransaction) {\n    await importAll();\n  } else {\n    await db.transaction('rw', db.tables, importAll);\n  }  \n\n  async function importAll () {\n    do {\n      for (const tableExport of dbExport.data) {\n        if(skipTables.includes(tableExport.tableName)) continue;\n        if (!tableExport.rows) break; // Need to pull more!\n        if (!(tableExport.rows as any).incomplete && tableExport.rows.length === 0)\n          continue;\n\n        if (progressCallback) {\n          // Keep ongoing transaction private\n          Dexie.ignoreTransaction(()=>progressCallback(progress));\n        }\n        const tableName = tableExport.tableName;\n        const table = db.table(tableName);\n        const tableSchemaStr = dbExport.tables.filter(t => t.name === tableName)[0].schema;\n        if (!table) {\n          if (!options!.acceptMissingTables)\n            throw new Error(`Exported table ${tableExport.tableName} is missing in installed database`);\n          else\n            continue;\n        }\n        if (!options!.acceptChangedPrimaryKey &&\n          tableSchemaStr.split(',')[0] != table.schema.primKey.src) {\n          throw new Error(`Primary key differs for table ${tableExport.tableName}. `);\n        }\n\n        const sourceRows = tableExport.rows\n        \n        // Our rows may be partial, so we need to ensure each one is completed before using it\n        const rows: any[] = [];\n        for(let i = 0; i < sourceRows.length; i++) {\n          const obj = sourceRows[i];\n          if (!obj.incomplete) {\n            rows.push(TSON.revive(obj));\n          } else {\n            break;\n          }\n        }\n\n        const filter = options!.filter;\n        const transform = options!.transform;\n\n        let filteredRows = filter ?\n          tableExport.inbound ?\n            rows.filter(value => filter(tableName, value)) :\n            rows.filter(([key, value]) => filter(tableName, value, key)) :\n          rows;\n        if (transform) {\n          filteredRows = filteredRows.map(tableExport.inbound ?\n            value => transform(tableName, value).value :\n            ([key, value]) => {\n              const res = transform(tableName, value, key)\n              return [res.key, res.value];\n            });\n        }\n        const [keys, values] = tableExport.inbound ?\n          [undefined, filteredRows] :\n          [filteredRows.map(row=>row[0]), rows.map(row=>row[1])];\n\n        if (options!.overwriteValues)\n          await table.bulkPut(values, keys);\n        else\n          await table.bulkAdd(values, keys);\n          \n        progress.completedRows += rows.length;\n        if (!(rows as any).incomplete) {\n          progress.completedTables += 1;\n        }\n        sourceRows.splice(0, rows.length); // Free up RAM, keep existing array instance.\n      }\n\n      // Avoid unnescessary loops in \"for (const tableExport of dbExport.data)\" \n      while (dbExport.data.length > 0 && dbExport.data[0].rows && !(dbExport.data[0].rows as any).incomplete) {\n        // We've already imported all rows from the first table. Delete its occurrence\n        dbExport.data.splice(0, 1); \n      }\n      if (!jsonStream.done() && !jsonStream.eof()) {\n        // Pull some more (keeping transaction alive)\n        if (readBlobsSynchronously) {\n          // If we can pull from blob synchronically, we don't have to\n          // keep transaction alive using Dexie.waitFor().\n          // This will only be possible in workers.\n          jsonStream.pullSync(CHUNK_SIZE);\n        } else {\n          await Dexie.waitFor(jsonStream.pullAsync(CHUNK_SIZE));\n        }\n      } else break;\n    } while (true)\n  }\n  progress.done = true;\n  if (progressCallback) {\n    // Keep ongoing transaction private\n    Dexie.ignoreTransaction(()=>progressCallback(progress));\n  }\n}\n\nasync function loadUntilWeGotEnoughData(exportedData: Blob | JsonStream<DexieExportJsonStructure>, CHUNK_SIZE: number): Promise<JsonStream<DexieExportJsonStructure>> {\n  const stream = ('slice' in exportedData ?\n    JsonStream<DexieExportJsonStructure>(exportedData) :\n    exportedData);\n\n  while (!stream.eof()) {\n    await stream.pullAsync(CHUNK_SIZE);\n\n    if (stream.result.data && stream.result.data!.data)\n      break;\n  }\n  const dbExportFile = stream.result;\n  if (!dbExportFile || dbExportFile.formatName != \"dexie\")\n    throw new Error(`Given file is not a dexie export`);\n  if (dbExportFile.formatVersion! > VERSION) {\n    throw new Error(`Format version ${dbExportFile.formatVersion} not supported`);\n  }\n  if (!dbExportFile.data!) {\n    throw new Error(`No data in export file`);\n  }\n  if (!dbExportFile.data!.databaseName) {\n    throw new Error(`Missing databaseName in export file`);\n  }\n  if (!dbExportFile.data!.databaseVersion) {\n    throw new Error(`Missing databaseVersion in export file`);\n  }\n  if (!dbExportFile.data!.tables) {\n    throw new Error(`Missing tables in export file`);\n  }\n  return stream;  \n}\n", "import Dexie from 'dexie';\nimport { ExportOptions, ExportProgress, exportDB } from './export';\nimport { importDB, peakImportFile, ImportOptions, importInto, StaticImportOptions } from './import';\nimport { DexieExportJsonMeta } from './json-structure';\n\nexport { exportDB, ExportOptions, ExportProgress};\nexport { importDB, importInto, peakImportFile, ImportOptions, DexieExportJsonMeta};\n\n//\n// Extend Dexie interface (typescript-wise)\n//\ndeclare module 'dexie' {\n  // Extend methods on db\n  interface Dexie {\n    export(options?: ExportOptions): Promise<Blob>;\n    import(blob: Blob, options?: ImportOptions): Promise<void>;\n  }\n  interface DexieConstructor {\n    import(blob: Blob, options?: StaticImportOptions): Promise<Dexie>;\n  }\n}\n\n//\n// Extend Dexie interface (runtime wise)\n//\n\nDexie.prototype.export = function (this: Dexie, options?: ExportOptions) {\n  return exportDB(this, options);\n};\nDexie.prototype.import = function (this: Dexie, blob: Blob, options?: ImportOptions) {\n  return importInto(this, blob, options);\n};\nDexie.import = (blob: Blob, options?: StaticImportOptions) => importDB(blob, options);\n\nexport default ()=>{\n  throw new Error(\"This addon extends Dexie.prototype globally and does not have be included in Dexie constructor's addons options.\")\n};\n"],
  "mappings": "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",
  "names": ["global", "this", "obj", "self", "keys", "TypesonPromise", "Typeson", "ret", "_ref", "cyclic", "stateObj", "_loop", "key", "_loop2", "i", "type", "possibleTypesonPromise", "val", "newVal", "k", "set", "test", "replace", "revive", "Undefined", "_typeof", "Symbol", "iterator", "constructor", "prototype", "_classCallCheck", "instance", "Constructor", "TypeError", "_defineProperties", "target", "props", "length", "descriptor", "enumerable", "configurable", "writable", "Object", "defineProperty", "_defineProperty", "value", "ownKeys", "object", "enumerableOnly", "getOwnPropertySymbols", "symbols", "filter", "sym", "getOwnPropertyDescriptor", "push", "apply", "_objectSpread2", "arguments", "source", "forEach", "getOwnPropertyDescriptors", "defineProperties", "_slicedToArray", "arr", "_arrayWithHoles", "Array", "isArray", "_iterableToArrayLimit", "_arr", "_n", "_d", "_e", "_s", "_i", "next", "done", "err", "_unsupportedIterableToArray", "_nonIterableRest", "_toConsumableArray", "_arrayWithoutHoles", "_arrayLikeToArray", "_iterableToArray", "iter", "from", "_nonIterableSpread", "o", "minLen", "n", "toString", "call", "slice", "name", "len", "arr2", "f", "p", "Promise", "__typeson__type__", "toStringTag", "then", "onFulfilled", "onRejected", "_this", "typesonResolve", "typesonReject", "res", "reject", "resolve", "v", "meth", "promArr", "map", "prom", "toStr", "hasOwn$1", "hasOwnProperty", "getProto", "getPrototypeOf", "fnToString", "isThenable", "catchCheck", "isObject", "hasConstructorOf", "a", "b", "proto", "Ctor", "isPlainObject", "escapeKeyPathComponent", "keyPathComponent", "unescapeKeyPathComponent", "getByKeyPath", "keyPath", "period", "indexOf", "innerObj", "undefined", "setAtKeyPath", "_await", "direct", "hasOwn", "internalStateObjPropsToIgnore", "_async", "args", "e", "nestedPathsFirst", "keypath", "as", "match", "bs", "options", "plainObjectReplacers", "nonplainObjectReplacers", "revivers", "types", "_createClass", "protoProps", "staticProps", "stringify", "replacer", "space", "opts", "stringification", "encapsulated", "encapsulate", "JSON", "stringifySync", "throwOnBadSyncType", "sync", "stringifyAsync", "parse", "text", "reviver", "parseSync", "parseAsync", "specialTypeNames", "returnTypeNames", "rootTypeName", "iterateNone", "checkPromises", "promisesData", "all", "pd", "promResults", "promResult", "_exit", "newPromisesData", "_promisesData$splice2", "splice", "_prData", "parentObj", "detectedType", "encaps", "_encapsulate", "isTypesonPromise", "_invoke", "body", "result", "encaps2", "_result", "that", "refObjs", "refKeys", "promisesDataRoot", "encapsulateObserver", "finish", "typeNames", "values", "getJSONType", "Set", "$types", "$", "_adaptBuiltinStateObjectProperties", "ownKeysObj", "cb", "assign", "vals", "prop", "tmp", "resolvingTypesonPromise", "observerData", "$typeof", "runObserver", "awaitingTypesonPromise", "includes", "Number", "isNaN", "NEGATIVE_INFINITY", "POSITIVE_INFINITY", "replaced", "iterateIn", "iterateUnsetNumeric", "refIndex", "cyclicKeypath", "clone", "isPlainObj", "isArr", "ArrayBuffer", "addLength", "kp", "Boolean", "endIterateIn", "end", "endIterateOwn", "vl", "endIterateUnsetNumeric", "plainObject", "replacers", "existing", "concat", "replaceAsync", "replacing", "typeDetected", "encapsulateSync", "encapsulateAsync", "keyPathResolutions", "ignore$Types", "executeReviver", "Error", "reviveAsync", "revivalPromises", "checkUndefined", "retrn", "revivePlainObjects", "plainObjectTypes", "entries", "_ref3", "_ref4", "plain", "sort", "reduce", "reducer", "_ref7", "_revive", "_clone", "_keyPathResolutions$", "_target", "_clone2", "_ret", "typ", "r", "_ref8", "reviveSync", "register", "typeSpecSets", "R", "typeSpec", "typSpec", "typeId", "JSON_TYPES", "spec", "testPlainObjects", "existingReplacer", "Class", "x", "create", "_spec2", "replacerObj", "bind", "start", "fallback", "reviverObj", "isUserObject", "userObject", "s", "arrayNonindexKeys", "some", "String", "parseInt", "sparseUndefined", "undef", "primitiveObjects", "StringObject", "BooleanObject", "NumberObject", "specialNumbers", "nan", "NaN", "infinity", "negativeInfinity", "date", "dt", "time", "getTime", "Date", "regexp", "rexp", "flags", "ignoreCase", "multiline", "sticky", "unicode", "RegExp", "mp", "Map", "st", "chars", "lookup", "Uint8Array", "charCodeAt", "encode", "arraybuffer", "byteOffset", "lngth", "byteLength", "bytes", "base64", "decode", "encoded1", "encoded2", "encoded3", "encoded4", "bufferLength", "_i2", "buffers", "index", "b64", "buffer", "_global", "typedArrays", "typeName", "arrType", "TypedArray", "toLowerCase", "l", "encoded", "b64Obj", "dataview", "DataView", "intlTypes", "IntlCollator", "Intl", "Collator", "c", "resolvedOptions", "locale", "IntlDateTimeFormat", "DateTimeFormat", "dtf", "IntlNumberFormat", "NumberFormat", "nf", "string2arraybuffer", "str", "array", "file", "req", "XMLHttpRequest", "overrideMimeType", "open", "URL", "createObjectURL", "send", "status", "stringContents", "responseText", "lastModified", "File", "reader", "FileReader", "addEventListener", "error", "readAsBinaryString", "bigint", "BigInt", "bigintObject", "cryptokey", "extractable", "crypto", "subtle", "exportKey", "jwk", "algorithm", "usages", "importKey", "imagedata", "d", "data", "width", "height", "ImageData", "Uint8ClampedArray", "imagebitmap", "dataset", "bm", "canvas", "document", "createElement", "getContext", "drawImage", "toDataURL", "ctx", "img", "src", "createImageBitmap", "filelist", "fl", "item", "_files", "t", "blob", "Blob", "StructuredCloning", "typedArray", "encodeB64", "decodeB64", "tableName", "_a", "require$$0", "clarinet", "tableExport", "table", "readBlobsSynchronously"]
}
