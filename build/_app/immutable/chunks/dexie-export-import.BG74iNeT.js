var Gt=(xe,Qe)=>()=>(Qe||xe((Qe={exports:{}}).exports,Qe),Qe.exports);var Yt=Gt((gt,jt)=>{var It={};(function(xe,Qe){typeof gt=="object"&&typeof jt<"u"?Qe(gt,require("dexie")):typeof define=="function"&&define.amd?define(["exports","dexie"],Qe):(xe=typeof globalThis<"u"?globalThis:xe||self,Qe(xe.DexieExportImport={},xe.Dexie))})(void 0,function(xe,Qe){function Bt(b){return b&&typeof b=="object"&&"default"in b?b:{default:b}}var Be=Bt(Qe);/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function Ze(b,h,u,g){function w(p){return p instanceof u?p:new u(function(o){o(p)})}return new(u||(u=Promise))(function(p,o){function I(_){try{s(g.next(_))}catch(F){o(F)}}function R(_){try{s(g.throw(_))}catch(F){o(F)}}function s(_){_.done?p(_.value):w(_.value).then(I,R)}s((g=g.apply(b,[])).next())})}function Ve(b,h){var u={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},g,w,p,o;return o={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function I(s){return function(_){return R([s,_])}}function R(s){if(g)throw new TypeError("Generator is already executing.");for(;u;)try{if(g=1,w&&(p=s[0]&2?w.return:s[0]?w.throw||((p=w.return)&&p.call(w),0):w.next)&&!(p=p.call(w,s[1])).done)return p;switch(w=0,p&&(s=[s[0]&2,p.value]),s[0]){case 0:case 1:p=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,w=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(p=u.trys,!(p=p.length>0&&p[p.length-1])&&(s[0]===6||s[0]===2)){u=0;continue}if(s[0]===3&&(!p||s[1]>p[0]&&s[1]<p[3])){u.label=s[1];break}if(s[0]===6&&u.label<p[1]){u.label=p[1],p=s;break}if(p&&u.label<p[2]){u.label=p[2],u.ops.push(s);break}p[2]&&u.ops.pop(),u.trys.pop();continue}s=h.call(b,u)}catch(_){s=[6,_],w=0}finally{g=p=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function Ct(b){var h=[b.schema.primKey].concat(b.schema.indexes);return h.map(function(u){return u.src}).join(",")}function kt(b){for(var h={},u=0,g=b.tables;u<g.length;u++){var w=g[u];h[w.name]=w.schema}return h}function wt(b,h){return new Promise(function(u,g){var w=new FileReader;w.onabort=function(p){return g(new Error("file read aborted"))},w.onerror=function(p){return g(p.target.error)},w.onload=function(p){return u(p.target.result)},h==="binary"?w.readAsArrayBuffer(b):w.readAsText(b)})}function Ot(b,h){if(typeof FileReaderSync>"u")throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var u=new FileReaderSync,g=h==="binary"?u.readAsArrayBuffer(b):u.readAsText(b);return g}var pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yt(b,h){return h={exports:{}},b(h,h.exports),h.exports}for(var st=yt(function(b,h){(function(u,g){b.exports=g()})(pt,function(){function u(l){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u=function(y){return typeof y}:u=function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},u(l)}function g(l,y,d,v,A,G,H){try{var W=l[G](H),C=W.value}catch(Ae){d(Ae);return}W.done?y(C):Promise.resolve(C).then(v,A)}function w(l){return function(){var y=this,d=arguments;return new Promise(function(v,A){var G=l.apply(y,d);function H(C){g(G,v,A,H,W,"next",C)}function W(C){g(G,v,A,H,W,"throw",C)}H(void 0)})}}function p(l,y){if(!(l instanceof y))throw new TypeError("Cannot call a class as a function")}function o(l,y){for(var d=0;d<y.length;d++){var v=y[d];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(l,v.key,v)}}function I(l,y,d){return y&&o(l.prototype,y),l}function R(l,y,d){return y in l?Object.defineProperty(l,y,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[y]=d,l}function s(l,y){var d=Object.keys(l);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(l);y&&(v=v.filter(function(A){return Object.getOwnPropertyDescriptor(l,A).enumerable})),d.push.apply(d,v)}return d}function _(l){for(var y=1;y<arguments.length;y++){var d=arguments[y]!=null?arguments[y]:{};y%2?s(Object(d),!0).forEach(function(v){R(l,v,d[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(d)):s(Object(d)).forEach(function(v){Object.defineProperty(l,v,Object.getOwnPropertyDescriptor(d,v))})}return l}function F(l,y){return J(l)||ee(l,y)||be()}function he(l){return Oe(l)||V(l)||Ee()}function Oe(l){if(Array.isArray(l)){for(var y=0,d=new Array(l.length);y<l.length;y++)d[y]=l[y];return d}}function J(l){if(Array.isArray(l))return l}function V(l){if(Symbol.iterator in Object(l)||Object.prototype.toString.call(l)==="[object Arguments]")return Array.from(l)}function ee(l,y){if(Symbol.iterator in Object(l)||Object.prototype.toString.call(l)==="[object Arguments]"){var d=[],v=!0,A=!1,G=void 0;try{for(var H=l[Symbol.iterator](),W;!(v=(W=H.next()).done)&&(d.push(W.value),!(y&&d.length===y));v=!0);}catch(C){A=!0,G=C}finally{try{!v&&H.return!=null&&H.return()}finally{if(A)throw G}}return d}}function Ee(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function be(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var N=function l(y){p(this,l),this.p=new Promise(y)};N.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(N.prototype[Symbol.toStringTag]="TypesonPromise"),N.prototype.then=function(l,y){var d=this;return new N(function(v,A){d.p.then(function(G){v(l?l(G):G)}).catch(function(G){return y?y(G):Promise.reject(G)}).then(v,A)})},N.prototype.catch=function(l){return this.then(null,l)},N.resolve=function(l){return new N(function(y){y(l)})},N.reject=function(l){return new N(function(y,d){d(l)})},["all","race"].forEach(function(l){N[l]=function(y){return new N(function(d,v){Promise[l](y.map(function(A){return A&&A.constructor&&A.constructor.__typeson__type__==="TypesonPromise"?A.p:A})).then(d,v)})}});var Ne={},K=Ne.toString,ne={}.hasOwnProperty,re=Object.getPrototypeOf,Pe=ne.toString;function c(l,y){return M(l)&&typeof l.then=="function"&&(!y||typeof l.catch=="function")}function r(l){return K.call(l).slice(8,-1)}function m(l,y){if(!l||u(l)!=="object")return!1;var d=re(l);if(!d)return y===null;var v=ne.call(d,"constructor")&&d.constructor;return typeof v!="function"?y===null:y===v||y!==null&&Pe.call(v)===Pe.call(y)||typeof y=="function"&&typeof v.__typeson__type__=="string"&&v.__typeson__type__===y.__typeson__type__}function f(l){if(!l||r(l)!=="Object")return!1;var y=re(l);return y?m(l,Object):!0}function Z(l){if(!l||r(l)!=="Object")return!1;var y=re(l);return y?m(l,Object)||Z(y):!0}function M(l){return l&&u(l)==="object"}function ie(l){return l.replace(/~/g,"~0").replace(/\./g,"~1")}function ve(l){return l.replace(/~1/g,".").replace(/~0/g,"~")}function Se(l,y){if(y==="")return l;var d=y.indexOf(".");if(d>-1){var v=l[ve(y.slice(0,d))];return v===void 0?void 0:Se(v,y.slice(d+1))}return l[ve(y)]}function Ce(l,y,d){if(y==="")return d;var v=y.indexOf(".");if(v>-1){var A=l[ve(y.slice(0,v))];return Ce(A,y.slice(v+1),d)}return l[ve(y)]=d,l}function _e(l){return l===null?"null":Array.isArray(l)?"array":u(l)}var ce=Object.keys,de=Array.isArray,ke={}.hasOwnProperty,Ye=["type","replaced","iterateIn","iterateUnsetNumeric"];function D(l,y){if(l.keypath==="")return-1;var d=l.keypath.match(/\./g)||0,v=y.keypath.match(/\./g)||0;return d&&(d=d.length),v&&(v=v.length),d>v?-1:d<v?1:l.keypath<y.keypath?-1:l.keypath>y.keypath}var pe=function(){function l(y){p(this,l),this.options=y,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return I(l,[{key:"stringify",value:function(d,v,A,G){G=_({},this.options,{},G,{stringification:!0});var H=this.encapsulate(d,null,G);return de(H)?JSON.stringify(H[0],v,A):H.then(function(W){return JSON.stringify(W,v,A)})}},{key:"stringifySync",value:function(d,v,A,G){return this.stringify(d,v,A,_({throwOnBadSyncType:!0},G,{sync:!0}))}},{key:"stringifyAsync",value:function(d,v,A,G){return this.stringify(d,v,A,_({throwOnBadSyncType:!0},G,{sync:!1}))}},{key:"parse",value:function(d,v,A){return A=_({},this.options,{},A,{parse:!0}),this.revive(JSON.parse(d,v),A)}},{key:"parseSync",value:function(d,v,A){return this.parse(d,v,_({throwOnBadSyncType:!0},A,{sync:!0}))}},{key:"parseAsync",value:function(d,v,A){return this.parse(d,v,_({throwOnBadSyncType:!0},A,{sync:!1}))}},{key:"specialTypeNames",value:function(d,v){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return A.returnTypeNames=!0,this.encapsulate(d,v,A)}},{key:"rootTypeName",value:function(d,v){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return A.iterateNone=!0,this.encapsulate(d,v,A)}},{key:"encapsulate",value:function(d,v,A){A=_({sync:!0},this.options,{},A);var G=A,H=G.sync,W=this,C={},Ae=[],Ue=[],Fe=[],qe="cyclic"in A?A.cyclic:!0,ze=A,et=ze.encapsulateObserver,Ke=se("",d,qe,v||{},Fe);function He(j){var n=Object.values(C);if(A.iterateNone)return n.length?n[0]:l.getJSONType(j);if(n.length){if(A.returnTypeNames)return he(new Set(n));!j||!f(j)||ke.call(j,"$types")?j={$:j,$types:{$:C}}:j.$types=C}else M(j)&&ke.call(j,"$types")&&(j={$:j,$types:!0});return A.returnTypeNames?!1:j}function me(j,n){return oe.apply(this,arguments)}function oe(){return oe=w(regeneratorRuntime.mark(function j(n,e){var t;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(e.map(function(O){return O[1].p}));case 2:return t=a.sent,a.next=5,Promise.all(t.map(function(){var O=w(regeneratorRuntime.mark(function T(B){var E,U,Y,q,ae,Q,X,fe,le,$,Te,P,S,L;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(E=[],U=e.splice(0,1),Y=F(U,1),q=Y[0],ae=F(q,7),Q=ae[0],X=ae[2],fe=ae[3],le=ae[4],$=ae[5],Te=ae[6],P=se(Q,B,X,fe,E,!0,Te),S=m(P,N),!(Q&&S)){x.next=11;break}return x.next=8,P.p;case 8:return L=x.sent,le[$]=L,x.abrupt("return",me(n,E));case 11:return Q?le[$]=P:S?n=P.p:n=P,x.abrupt("return",me(n,E));case 13:case"end":return x.stop()}},T)}));return function(T){return O.apply(this,arguments)}}()));case 5:return a.abrupt("return",n);case 6:case"end":return a.stop()}},j)})),oe.apply(this,arguments)}function te(j,n,e){Object.assign(j,n);var t=Ye.map(function(i){var a=j[i];return delete j[i],a});e(),Ye.forEach(function(i,a){j[i]=t[a]})}function se(j,n,e,t,i,a,O){var T,B={},E=u(n),U=et?function(S){var L=O||t.type||l.getJSONType(n);et(Object.assign(S||B,{keypath:j,value:n,cyclic:e,stateObj:t,promisesData:i,resolvingTypesonPromise:a,awaitingTypesonPromise:m(n,N)},{type:L}))}:null;if(["string","boolean","number","undefined"].includes(E))return n===void 0||E==="number"&&(isNaN(n)||n===-1/0||n===1/0)?(t.replaced?T=n:T=ge(j,n,t,i,!1,a,U),T!==n&&(B={replaced:T})):T=n,U&&U(),T;if(n===null)return U&&U(),n;if(e&&!t.iterateIn&&!t.iterateUnsetNumeric&&n&&u(n)==="object"){var Y=Ae.indexOf(n);if(Y<0)e===!0&&(Ae.push(n),Ue.push(j));else return C[j]="#",U&&U({cyclicKeypath:Ue[Y]}),"#"+Ue[Y]}var q=f(n),ae=de(n),Q=(q||ae)&&(!W.plainObjectReplacers.length||t.replaced)||t.iterateIn?n:ge(j,n,t,i,q||ae,null,U),X;if(Q!==n?(T=Q,B={replaced:Q}):j===""&&m(n,N)?(i.push([j,n,e,t,void 0,void 0,t.type]),T=n):ae&&t.iterateIn!=="object"||t.iterateIn==="array"?(X=new Array(n.length),B={clone:X}):!["function","symbol"].includes(u(n))&&!("toJSON"in n)&&!m(n,N)&&!m(n,Promise)&&!m(n,ArrayBuffer)||q||t.iterateIn==="object"?(X={},t.addLength&&(X.length=n.length),B={clone:X}):T=n,U&&U(),A.iterateNone)return X||T;if(!X)return T;if(t.iterateIn){var fe=function(L){var k={ownKeys:ke.call(n,L)};te(t,k,function(){var x=j+(j?".":"")+ie(L),z=se(x,n[L],!!e,t,i,a);m(z,N)?i.push([x,z,!!e,t,X,L,t.type]):z!==void 0&&(X[L]=z)})};for(var le in n)fe(le);U&&U({endIterateIn:!0,end:!0})}else ce(n).forEach(function(S){var L=j+(j?".":"")+ie(S),k={ownKeys:!0};te(t,k,function(){var x=se(L,n[S],!!e,t,i,a);m(x,N)?i.push([L,x,!!e,t,X,S,t.type]):x!==void 0&&(X[S]=x)})}),U&&U({endIterateOwn:!0,end:!0});if(t.iterateUnsetNumeric){for(var $=n.length,Te=function(L){if(!(L in n)){var k=j+(j?".":"")+L,x={ownKeys:!1};te(t,x,function(){var z=se(k,void 0,!!e,t,i,a);m(z,N)?i.push([k,z,!!e,t,X,L,t.type]):z!==void 0&&(X[L]=z)})}},P=0;P<$;P++)Te(P);U&&U({endIterateUnsetNumeric:!0,end:!0})}return X}function ge(j,n,e,t,i,a,O){for(var T=i?W.plainObjectReplacers:W.nonplainObjectReplacers,B=T.length;B--;){var E=T[B];if(E.test(n,e)){var U=E.type;if(W.revivers[U]){var Y=C[j];C[j]=Y?[U].concat(Y):U}if(Object.assign(e,{type:U,replaced:!0}),(H||!E.replaceAsync)&&!E.replace)return O&&O({typeDetected:!0}),se(j,n,qe&&"readonly",e,t,a,U);O&&O({replacing:!0});var q=H||!E.replaceAsync?"replace":"replaceAsync";return se(j,E[q](n,e),qe&&"readonly",e,t,a,U)}}return n}return Fe.length?H&&A.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(me(Ke,Fe)).then(He):!H&&A.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():A.stringification&&H?[He(Ke)]:H?He(Ke):Promise.resolve(He(Ke))}},{key:"encapsulateSync",value:function(d,v,A){return this.encapsulate(d,v,_({throwOnBadSyncType:!0},A,{sync:!0}))}},{key:"encapsulateAsync",value:function(d,v,A){return this.encapsulate(d,v,_({throwOnBadSyncType:!0},A,{sync:!1}))}},{key:"revive",value:function(d,v){var A=d&&d.$types;if(!A)return d;if(A===!0)return d.$;v=_({sync:!0},this.options,{},v);var G=v,H=G.sync,W=[],C={},Ae=!0;A.$&&f(A.$)&&(d=d.$,A=A.$,Ae=!1);var Ue=this;function Fe(oe,te){var se=Ue.revivers[oe]||[],ge=F(se,1),j=ge[0];if(!j)throw new Error("Unregistered type: "+oe);return H&&!("revive"in j)?te:j[H&&j.revive?"revive":!H&&j.reviveAsync?"reviveAsync":"revive"](te,C)}function qe(){var oe=[];if(Object.entries(A).forEach(function(te){var se=F(te,2),ge=se[0],j=se[1];j!=="#"&&[].concat(j).forEach(function(n){var e=Ue.revivers[n]||[null,{}],t=F(e,2),i=t[1].plain;i&&(oe.push({keypath:ge,type:n}),delete A[ge])})}),!!oe.length)return oe.sort(D).reduce(function te(se,ge){var j=ge.keypath,n=ge.type;if(c(se))return se.then(function(i){return te(i,{keypath:j,type:n})});var e=Se(d,j);if(e=Fe(n,e),m(e,N))return e.then(function(i){var a=Ce(d,j,i);a===i&&(d=a)});var t=Ce(d,j,e);t===e&&(d=t)},void 0)}var ze=[];function et(oe,te,se,ge,j){if(!(Ae&&oe==="$types")){var n=A[oe],e=de(te);if(e||f(te)){var t=e?new Array(te.length):{};for(ce(te).forEach(function(Y){var q=et(oe+(oe?".":"")+ie(Y),te[Y],se||t,t,Y),ae=function(X){return m(X,Le)?t[Y]=void 0:X!==void 0&&(t[Y]=X),X};m(q,N)?ze.push(q.then(function(Q){return ae(Q)})):ae(q)}),te=t;W.length;){var i=F(W[0],4),a=i[0],O=i[1],T=i[2],B=i[3],E=Se(a,O);if(E!==void 0)T[B]=E;else break;W.splice(0,1)}}if(!n)return te;if(n==="#"){var U=Se(se,te.slice(1));return U===void 0&&W.push([se,te.slice(1),ge,j]),U}return[].concat(n).reduce(function Y(q,ae){return m(q,N)?q.then(function(Q){return Y(Q,ae)}):Fe(ae,q)},te)}}function Ke(oe){return m(oe,Le)?void 0:oe}var He=qe(),me;return m(He,N)?me=He.then(function(){return d}):(me=et("",d,null),ze.length&&(me=N.resolve(me).then(function(oe){return N.all([oe].concat(ze))}).then(function(oe){var te=F(oe,1),se=te[0];return se}))),c(me)?H&&v.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():m(me,N)?me.p.then(Ke):me:!H&&v.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():H?Ke(me):Promise.resolve(Ke(me))}},{key:"reviveSync",value:function(d,v){return this.revive(d,_({throwOnBadSyncType:!0},v,{sync:!0}))}},{key:"reviveAsync",value:function(d,v){return this.revive(d,_({throwOnBadSyncType:!0},v,{sync:!1}))}},{key:"register",value:function(d,v){return v=v||{},[].concat(d).forEach(function A(G){var H=this;if(de(G))return G.map(function(W){return A.call(H,W)});G&&ce(G).forEach(function(W){if(W==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(l.JSON_TYPES.includes(W))throw new TypeError("Plain JSON object types are reserved as type names");var C=G[W],Ae=C&&C.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,Ue=Ae.filter(function(se){return se.type===W});if(Ue.length&&(Ae.splice(Ae.indexOf(Ue[0]),1),delete this.revivers[W],delete this.types[W]),typeof C=="function"){var Fe=C;C={test:function(ge){return ge&&ge.constructor===Fe},replace:function(ge){return _({},ge)},revive:function(ge){return Object.assign(Object.create(Fe.prototype),ge)}}}else if(de(C)){var qe=C,ze=F(qe,3),et=ze[0],Ke=ze[1],He=ze[2];C={test:et,replace:Ke,revive:He}}if(!(!C||!C.test)){var me={type:W,test:C.test.bind(C)};C.replace&&(me.replace=C.replace.bind(C)),C.replaceAsync&&(me.replaceAsync=C.replaceAsync.bind(C));var oe=typeof v.fallback=="number"?v.fallback:v.fallback?0:1/0;if(C.testPlainObjects?this.plainObjectReplacers.splice(oe,0,me):this.nonplainObjectReplacers.splice(oe,0,me),C.revive||C.reviveAsync){var te={};C.revive&&(te.revive=C.revive.bind(C)),C.reviveAsync&&(te.reviveAsync=C.reviveAsync.bind(C)),this.revivers[W]=[te,{plain:C.testPlainObjects}]}this.types[W]=C}},this)},this),this}}]),l}(),Le=function l(){p(this,l)};return Le.__typeson__type__="TypesonUndefined",pe.Undefined=Le,pe.Promise=N,pe.isThenable=c,pe.toStringTag=r,pe.hasConstructorOf=m,pe.isObject=M,pe.isPlainObject=f,pe.isUserObject=Z,pe.escapeKeyPathComponent=ie,pe.unescapeKeyPathComponent=ve,pe.getByKeyPath=Se,pe.getJSONType=_e,pe.JSON_TYPES=["null","boolean","number","string","array","object"],pe})}),Lt=yt(function(b,h){(function(u,g){b.exports=g()})(pt,function(){function u(n){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function g(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function w(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function p(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function I(n){return function(t){if(Array.isArray(t))return R(t)}(n)||function(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,i){if(t){if(typeof t=="string")return R(t,i);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return R(t,i)}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function R(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function s(n){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function _(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function F(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function he(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Oe(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function J(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Oe(Object(t),!0).forEach(function(i){he(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function V(n,e){return function(i){if(Array.isArray(i))return i}(n)||function(i,a){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var O=[],T=!0,B=!1,E=void 0;try{for(var U,Y=i[Symbol.iterator]();!(T=(U=Y.next()).done)&&(O.push(U.value),!a||O.length!==a);T=!0);}catch(q){B=!0,E=q}finally{try{T||Y.return==null||Y.return()}finally{if(B)throw E}}return O}}(n,e)||Ee(n,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ee(n){return function(t){if(Array.isArray(t))return be(t)}(n)||function(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||Ee(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ee(n,e){if(n){if(typeof n=="string")return be(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?be(n,e):void 0}}function be(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}var N=function n(e){_(this,n),this.p=new Promise(e)};N.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(N.prototype[Symbol.toStringTag]="TypesonPromise"),N.prototype.then=function(n,e){var t=this;return new N(function(i,a){t.p.then(function(O){i(n?n(O):O)}).catch(function(O){return e?e(O):Promise.reject(O)}).then(i,a)})},N.prototype.catch=function(n){return this.then(null,n)},N.resolve=function(n){return new N(function(e){e(n)})},N.reject=function(n){return new N(function(e,t){t(n)})},["all","race"].forEach(function(n){N[n]=function(e){return new N(function(t,i){Promise[n](e.map(function(a){return a&&a.constructor&&a.constructor.__typeson__type__==="TypesonPromise"?a.p:a})).then(t,i)})}});var Ne={}.toString,K={}.hasOwnProperty,ne=Object.getPrototypeOf,re=K.toString;function Pe(n,e){return f(n)&&typeof n.then=="function"&&(!e||typeof n.catch=="function")}function c(n){return Ne.call(n).slice(8,-1)}function r(n,e){if(!n||s(n)!=="object")return!1;var t=ne(n);if(!t)return e===null;var i=K.call(t,"constructor")&&t.constructor;return typeof i!="function"?e===null:e===i||e!==null&&re.call(i)===re.call(e)||typeof e=="function"&&typeof i.__typeson__type__=="string"&&i.__typeson__type__===e.__typeson__type__}function m(n){return!(!n||c(n)!=="Object")&&(!ne(n)||r(n,Object))}function f(n){return n&&s(n)==="object"}function Z(n){return n.replace(/~/g,"~0").replace(/\./g,"~1")}function M(n){return n.replace(/~1/g,".").replace(/~0/g,"~")}function ie(n,e){if(e==="")return n;var t=e.indexOf(".");if(t>-1){var i=n[M(e.slice(0,t))];return i===void 0?void 0:ie(i,e.slice(t+1))}return n[M(e)]}function ve(n,e,t){if(e==="")return t;var i=e.indexOf(".");return i>-1?ve(n[M(e.slice(0,i))],e.slice(i+1),t):(n[M(e)]=t,n)}function Se(n,e,t){return n&&n.then||(n=Promise.resolve(n)),e?n.then(e):n}var Ce=Object.keys,_e=Array.isArray,ce={}.hasOwnProperty,de=["type","replaced","iterateIn","iterateUnsetNumeric"];function ke(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(i){return Promise.reject(i)}}}function Ye(n,e){if(n.keypath==="")return-1;var t=n.keypath.match(/\./g)||0,i=e.keypath.match(/\./g)||0;return t&&(t=t.length),i&&(i=i.length),t>i?-1:t<i?1:n.keypath<e.keypath?-1:n.keypath>e.keypath}var D=function(){function n(e){_(this,n),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function(t,i,a){return i&&F(t.prototype,i),t}(n,[{key:"stringify",value:function(t,i,a,O){O=J(J(J({},this.options),O),{},{stringification:!0});var T=this.encapsulate(t,null,O);return _e(T)?JSON.stringify(T[0],i,a):T.then(function(B){return JSON.stringify(B,i,a)})}},{key:"stringifySync",value:function(t,i,a,O){return this.stringify(t,i,a,J(J({throwOnBadSyncType:!0},O),{},{sync:!0}))}},{key:"stringifyAsync",value:function(t,i,a,O){return this.stringify(t,i,a,J(J({throwOnBadSyncType:!0},O),{},{sync:!1}))}},{key:"parse",value:function(t,i,a){return a=J(J(J({},this.options),a),{},{parse:!0}),this.revive(JSON.parse(t,i),a)}},{key:"parseSync",value:function(t,i,a){return this.parse(t,i,J(J({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"parseAsync",value:function(t,i,a){return this.parse(t,i,J(J({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"specialTypeNames",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.returnTypeNames=!0,this.encapsulate(t,i,a)}},{key:"rootTypeName",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.iterateNone=!0,this.encapsulate(t,i,a)}},{key:"encapsulate",value:function(t,i,a){var O=ke(function(P,S){return Se(Promise.all(S.map(function(L){return L[1].p})),function(L){return Se(Promise.all(L.map(ke(function(k){var x=!1,z=[],De=V(S.splice(0,1),1),we=V(De[0],7),Re=we[0],Me=we[2],ue=we[3],Ge=we[4],ye=we[5],$e=we[6],Ie=$(Re,k,Me,ue,z,!0,$e),We=r(Ie,N);return function(bt,ft){var at=bt();return at&&at.then?at.then(ft):ft(at)}(function(){if(Re&&We)return Se(Ie.p,function(Xe){return Ge[ye]=Xe,x=!0,O(P,z)})},function(Xe){return x?Xe:(Re?Ge[ye]=Ie:P=We?Ie.p:Ie,O(P,z))})}))),function(){return P})})}),T=(a=J(J({sync:!0},this.options),a)).sync,B=this,E={},U=[],Y=[],q=[],ae=!("cyclic"in a)||a.cyclic,Q=a.encapsulateObserver,X=$("",t,ae,i||{},q);function fe(P){var S=Object.values(E);if(a.iterateNone)return S.length?S[0]:n.getJSONType(P);if(S.length){if(a.returnTypeNames)return ee(new Set(S));P&&m(P)&&!ce.call(P,"$types")?P.$types=E:P={$:P,$types:{$:E}}}else f(P)&&ce.call(P,"$types")&&(P={$:P,$types:!0});return!a.returnTypeNames&&P}function le(P,S,L){Object.assign(P,S);var k=de.map(function(x){var z=P[x];return delete P[x],z});L(),de.forEach(function(x,z){P[x]=k[z]})}function $(P,S,L,k,x,z,De){var we,Re={},Me=s(S),ue=Q?function(nt){var je=De||k.type||n.getJSONType(S);Q(Object.assign(nt||Re,{keypath:P,value:S,cyclic:L,stateObj:k,promisesData:x,resolvingTypesonPromise:z,awaitingTypesonPromise:r(S,N)},{type:je}))}:null;if(["string","boolean","number","undefined"].includes(Me))return S===void 0||Number.isNaN(S)||S===Number.NEGATIVE_INFINITY||S===Number.POSITIVE_INFINITY?(we=k.replaced?S:Te(P,S,k,x,!1,z,ue))!==S&&(Re={replaced:we}):we=S,ue&&ue(),we;if(S===null)return ue&&ue(),S;if(L&&!k.iterateIn&&!k.iterateUnsetNumeric&&S&&s(S)==="object"){var Ge=U.indexOf(S);if(!(Ge<0))return E[P]="#",ue&&ue({cyclicKeypath:Y[Ge]}),"#"+Y[Ge];L===!0&&(U.push(S),Y.push(P))}var ye,$e=m(S),Ie=_e(S),We=($e||Ie)&&(!B.plainObjectReplacers.length||k.replaced)||k.iterateIn?S:Te(P,S,k,x,$e||Ie,null,ue);if(We!==S?(we=We,Re={replaced:We}):P===""&&r(S,N)?(x.push([P,S,L,k,void 0,void 0,k.type]),we=S):Ie&&k.iterateIn!=="object"||k.iterateIn==="array"?(ye=new Array(S.length),Re={clone:ye}):(["function","symbol"].includes(s(S))||"toJSON"in S||r(S,N)||r(S,Promise)||r(S,ArrayBuffer))&&!$e&&k.iterateIn!=="object"?we=S:(ye={},k.addLength&&(ye.length=S.length),Re={clone:ye}),ue&&ue(),a.iterateNone)return ye||we;if(!ye)return we;if(k.iterateIn){var Xe=function(je){var tt={ownKeys:ce.call(S,je)};le(k,tt,function(){var rt=P+(P?".":"")+Z(je),lt=$(rt,S[je],!!L,k,x,z);r(lt,N)?x.push([rt,lt,!!L,k,ye,je,k.type]):lt!==void 0&&(ye[je]=lt)})};for(var bt in S)Xe(bt);ue&&ue({endIterateIn:!0,end:!0})}else Ce(S).forEach(function(nt){var je=P+(P?".":"")+Z(nt);le(k,{ownKeys:!0},function(){var tt=$(je,S[nt],!!L,k,x,z);r(tt,N)?x.push([je,tt,!!L,k,ye,nt,k.type]):tt!==void 0&&(ye[nt]=tt)})}),ue&&ue({endIterateOwn:!0,end:!0});if(k.iterateUnsetNumeric){for(var ft=S.length,at=function(je){if(!(je in S)){var tt=P+(P?".":"")+je;le(k,{ownKeys:!1},function(){var rt=$(tt,void 0,!!L,k,x,z);r(rt,N)?x.push([tt,rt,!!L,k,ye,je,k.type]):rt!==void 0&&(ye[je]=rt)})}},mt=0;mt<ft;mt++)at(mt);ue&&ue({endIterateUnsetNumeric:!0,end:!0})}return ye}function Te(P,S,L,k,x,z,De){for(var we=x?B.plainObjectReplacers:B.nonplainObjectReplacers,Re=we.length;Re--;){var Me=we[Re];if(Me.test(S,L)){var ue=Me.type;if(B.revivers[ue]){var Ge=E[P];E[P]=Ge?[ue].concat(Ge):ue}return Object.assign(L,{type:ue,replaced:!0}),!T&&Me.replaceAsync||Me.replace?(De&&De({replacing:!0}),$(P,Me[T||!Me.replaceAsync?"replace":"replaceAsync"](S,L),ae&&"readonly",L,k,z,ue)):(De&&De({typeDetected:!0}),$(P,S,ae&&"readonly",L,k,z,ue))}}return S}return q.length?T&&a.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(O(X,q)).then(fe):!T&&a.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():a.stringification&&T?[fe(X)]:T?fe(X):Promise.resolve(fe(X))}},{key:"encapsulateSync",value:function(t,i,a){return this.encapsulate(t,i,J(J({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(t,i,a){return this.encapsulate(t,i,J(J({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"revive",value:function(t,i){var a=t&&t.$types;if(!a)return t;if(a===!0)return t.$;var O=(i=J(J({sync:!0},this.options),i)).sync,T=[],B={},E=!0;a.$&&m(a.$)&&(t=t.$,a=a.$,E=!1);var U=this;function Y(fe,le){var $=V(U.revivers[fe]||[],1)[0];if(!$)throw new Error("Unregistered type: "+fe);return O&&!("revive"in $)?le:$[O&&$.revive?"revive":!O&&$.reviveAsync?"reviveAsync":"revive"](le,B)}var q=[];function ae(fe){return r(fe,pe)?void 0:fe}var Q,X=function(){var le=[];if(Object.entries(a).forEach(function($){var Te=V($,2),P=Te[0],S=Te[1];S!=="#"&&[].concat(S).forEach(function(L){V(U.revivers[L]||[null,{}],2)[1].plain&&(le.push({keypath:P,type:L}),delete a[P])})}),le.length)return le.sort(Ye).reduce(function $(Te,P){var S=P.keypath,L=P.type;if(Pe(Te))return Te.then(function(z){return $(z,{keypath:S,type:L})});var k=ie(t,S);if(r(k=Y(L,k),N))return k.then(function(z){var De=ve(t,S,z);De===z&&(t=De)});var x=ve(t,S,k);x===k&&(t=x)},void 0)}();return r(X,N)?Q=X.then(function(){return t}):(Q=function fe(le,$,Te,P,S){if(!E||le!=="$types"){var L=a[le],k=_e($);if(k||m($)){var x=k?new Array($.length):{};for(Ce($).forEach(function(ye){var $e=fe(le+(le?".":"")+Z(ye),$[ye],Te||x,x,ye),Ie=function(Xe){return r(Xe,pe)?x[ye]=void 0:Xe!==void 0&&(x[ye]=Xe),Xe};r($e,N)?q.push($e.then(function(We){return Ie(We)})):Ie($e)}),$=x;T.length;){var z=V(T[0],4),De=z[0],we=z[1],Re=z[2],Me=z[3],ue=ie(De,we);if(ue===void 0)break;Re[Me]=ue,T.splice(0,1)}}if(!L)return $;if(L==="#"){var Ge=ie(Te,$.slice(1));return Ge===void 0&&T.push([Te,$.slice(1),P,S]),Ge}return[].concat(L).reduce(function ye($e,Ie){return r($e,N)?$e.then(function(We){return ye(We,Ie)}):Y(Ie,$e)},$)}}("",t,null),q.length&&(Q=N.resolve(Q).then(function(fe){return N.all([fe].concat(q))}).then(function(fe){return V(fe,1)[0]}))),Pe(Q)?O&&i.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():r(Q,N)?Q.p.then(ae):Q:!O&&i.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():O?ae(Q):Promise.resolve(ae(Q))}},{key:"reviveSync",value:function(t,i){return this.revive(t,J(J({throwOnBadSyncType:!0},i),{},{sync:!0}))}},{key:"reviveAsync",value:function(t,i){return this.revive(t,J(J({throwOnBadSyncType:!0},i),{},{sync:!1}))}},{key:"register",value:function(t,i){return i=i||{},[].concat(t).forEach(function a(O){var T=this;if(_e(O))return O.map(function(B){return a.call(T,B)});O&&Ce(O).forEach(function(B){if(B==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(n.JSON_TYPES.includes(B))throw new TypeError("Plain JSON object types are reserved as type names");var E=O[B],U=E&&E.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,Y=U.filter(function(le){return le.type===B});if(Y.length&&(U.splice(U.indexOf(Y[0]),1),delete this.revivers[B],delete this.types[B]),typeof E=="function"){var q=E;E={test:function($){return $&&$.constructor===q},replace:function($){return J({},$)},revive:function($){return Object.assign(Object.create(q.prototype),$)}}}else if(_e(E)){var ae=V(E,3);E={test:ae[0],replace:ae[1],revive:ae[2]}}if(E&&E.test){var Q={type:B,test:E.test.bind(E)};E.replace&&(Q.replace=E.replace.bind(E)),E.replaceAsync&&(Q.replaceAsync=E.replaceAsync.bind(E));var X=typeof i.fallback=="number"?i.fallback:i.fallback?0:Number.POSITIVE_INFINITY;if(E.testPlainObjects?this.plainObjectReplacers.splice(X,0,Q):this.nonplainObjectReplacers.splice(X,0,Q),E.revive||E.reviveAsync){var fe={};E.revive&&(fe.revive=E.revive.bind(E)),E.reviveAsync&&(fe.reviveAsync=E.reviveAsync.bind(E)),this.revivers[B]=[fe,{plain:E.testPlainObjects}]}this.types[B]=E}},this)},this),this}}]),n}(),pe=function n(){_(this,n)};pe.__typeson__type__="TypesonUndefined",D.Undefined=pe,D.Promise=N,D.isThenable=Pe,D.toStringTag=c,D.hasConstructorOf=r,D.isObject=f,D.isPlainObject=m,D.isUserObject=function n(e){if(!e||c(e)!=="Object")return!1;var t=ne(e);return!t||r(e,Object)||n(t)},D.escapeKeyPathComponent=Z,D.unescapeKeyPathComponent=M,D.getByKeyPath=ie,D.getJSONType=function(e){return e===null?"null":Array.isArray(e)?"array":s(e)},D.JSON_TYPES=["null","boolean","number","string","array","object"];for(var Le={userObject:{test:function(e,t){return D.isUserObject(e)},replace:function(e){return function(i){for(var a=1;a<arguments.length;a++){var O=arguments[a]!=null?arguments[a]:{};a%2?o(Object(O),!0).forEach(function(T){p(i,T,O[T])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(O)):o(Object(O)).forEach(function(T){Object.defineProperty(i,T,Object.getOwnPropertyDescriptor(O,T))})}return i}({},e)},revive:function(e){return e}}},l=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(e,t){return!!Array.isArray(e)&&(Object.keys(e).some(function(i){return String(Number.parseInt(i))!==i})&&(t.iterateIn="object",t.addLength=!0),!0)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e},revive:function(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach(function(i){var a=e[i];t[i]=a}),t}}},{sparseUndefined:{test:function(e,t){return e===void 0&&t.ownKeys===!1},replace:function(e){return 0},revive:function(e){}}}],y={undef:{test:function(e,t){return e===void 0&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return 0},revive:function(e){return new D.Undefined}}},d={StringObject:{test:function(e){return D.toStringTag(e)==="String"&&u(e)==="object"},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(e){return D.toStringTag(e)==="Boolean"&&u(e)==="object"},replace:function(e){return!!e},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(e){return D.toStringTag(e)==="Number"&&u(e)==="object"},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},v=[{nan:{test:function(e){return Number.isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return Number.NaN}}},{infinity:{test:function(e){return e===Number.POSITIVE_INFINITY},replace:function(e){return"Infinity"},revive:function(e){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(e){return e===Number.NEGATIVE_INFINITY},replace:function(e){return"-Infinity"},revive:function(e){return Number.NEGATIVE_INFINITY}}}],A={date:{test:function(e){return D.toStringTag(e)==="Date"},replace:function(e){var t=e.getTime();return Number.isNaN(t)?"NaN":t},revive:function(e){return e==="NaN"?new Date(Number.NaN):new Date(e)}}},G={regexp:{test:function(e){return D.toStringTag(e)==="RegExp"},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,i=e.flags;return new RegExp(t,i)}}},H={map:{test:function(e){return D.toStringTag(e)==="Map"},replace:function(e){return I(e.entries())},revive:function(e){return new Map(e)}}},W={set:{test:function(e){return D.toStringTag(e)==="Set"},replace:function(e){return I(e.values())},revive:function(e){return new Set(e)}}},C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ae=new Uint8Array(256),Ue=0;Ue<C.length;Ue++)Ae[C.charCodeAt(Ue)]=Ue;var Fe=function(e,t,i){i==null&&(i=e.byteLength);for(var a=new Uint8Array(e,0,i),O=a.length,T="",B=0;B<O;B+=3)T+=C[a[B]>>2],T+=C[(3&a[B])<<4|a[B+1]>>4],T+=C[(15&a[B+1])<<2|a[B+2]>>6],T+=C[63&a[B+2]];return O%3==2?T=T.slice(0,-1)+"=":O%3==1&&(T=T.slice(0,-2)+"=="),T},qe=function(e){var t,i,a,O,T=e.length,B=.75*e.length,E=0;e[e.length-1]==="="&&(B--,e[e.length-2]==="="&&B--);for(var U=new ArrayBuffer(B),Y=new Uint8Array(U),q=0;q<T;q+=4)t=Ae[e.charCodeAt(q)],i=Ae[e.charCodeAt(q+1)],a=Ae[e.charCodeAt(q+2)],O=Ae[e.charCodeAt(q+3)],Y[E++]=t<<2|i>>4,Y[E++]=(15&i)<<4|a>>2,Y[E++]=(3&a)<<6|63&O;return U},ze={arraybuffer:{test:function(e){return D.toStringTag(e)==="ArrayBuffer"},replace:function(e,t){t.buffers||(t.buffers=[]);var i=t.buffers.indexOf(e);return i>-1?{index:i}:(t.buffers.push(e),Fe(e))},revive:function(e,t){if(t.buffers||(t.buffers=[]),u(e)==="object")return t.buffers[e.index];var i=qe(e);return t.buffers.push(i),i}}},et=typeof self>"u"?pt:self,Ke={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(n){var e=n,t=et[e];t&&(Ke[n.toLowerCase()]={test:function(a){return D.toStringTag(a)===e},replace:function(a,O){var T=a.buffer,B=a.byteOffset,E=a.length;O.buffers||(O.buffers=[]);var U=O.buffers.indexOf(T);return U>-1?{index:U,byteOffset:B,length:E}:(O.buffers.push(T),{encoded:Fe(T),byteOffset:B,length:E})},revive:function(a,O){O.buffers||(O.buffers=[]);var T,B=a.byteOffset,E=a.length,U=a.encoded,Y=a.index;return"index"in a?T=O.buffers[Y]:(T=qe(U),O.buffers.push(T)),new t(T,B,E)}})});var He={dataview:{test:function(e){return D.toStringTag(e)==="DataView"},replace:function(e,t){var i=e.buffer,a=e.byteOffset,O=e.byteLength;t.buffers||(t.buffers=[]);var T=t.buffers.indexOf(i);return T>-1?{index:T,byteOffset:a,byteLength:O}:(t.buffers.push(i),{encoded:Fe(i),byteOffset:a,byteLength:O})},revive:function(e,t){t.buffers||(t.buffers=[]);var i,a=e.byteOffset,O=e.byteLength,T=e.encoded,B=e.index;return"index"in e?i=t.buffers[B]:(i=qe(T),t.buffers.push(i)),new DataView(i,a,O)}}},me={IntlCollator:{test:function(e){return D.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return D.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return D.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}};function oe(n){for(var e=new Uint8Array(n.length),t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer}var te={file:{test:function(e){return D.toStringTag(e)==="File"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad File access: "+t.status);return{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,i=e.type,a=e.stringContents,O=e.lastModified;return new File([oe(a)],t,{type:i,lastModified:O})},replaceAsync:function(e){return new D.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result,name:e.name,lastModified:e.lastModified})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}},se={bigint:{test:function(e){return typeof e=="bigint"},replace:function(e){return String(e)},revive:function(e){return BigInt(e)}}},ge={bigintObject:{test:function(e){return u(e)==="object"&&D.hasConstructorOf(e,BigInt)},replace:function(e){return String(e)},revive:function(e){return new Object(BigInt(e))}}},j={cryptokey:{test:function(e){return D.toStringTag(e)==="CryptoKey"&&e.extractable},replaceAsync:function(e){return new D.Promise(function(t,i){crypto.subtle.exportKey("jwk",e).catch(function(a){i(a)}).then(function(a){t({jwk:a,algorithm:e.algorithm,usages:e.usages})})})},revive:function(e){var t=e.jwk,i=e.algorithm,a=e.usages;return crypto.subtle.importKey("jwk",t,i,!0,a)}}};return[Le,y,l,d,v,A,G,{imagedata:{test:function(e){return D.toStringTag(e)==="ImageData"},replace:function(e){return{array:I(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return D.toStringTag(e)==="ImageBitmap"||e&&e.dataset&&e.dataset.toStringTag==="ImageBitmap"},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,createImageBitmap(t)}}},te,{file:te.file,filelist:{test:function(e){return D.toStringTag(e)==="FileList"},replace:function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e.item(i);return t},revive:function(e){return new(function(){function t(){g(this,t),this._files=arguments[0],this.length=this._files.length}return function(a,O,T){return O&&w(a.prototype,O),a}(t,[{key:"item",value:function(a){return this._files[a]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),t}())(e)}}},{blob:{test:function(e){return D.toStringTag(e)==="Blob"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad Blob access: "+t.status);return{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,i=e.stringContents;return new Blob([oe(i)],{type:t})},replaceAsync:function(e){return new D.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}}].concat(typeof Map=="function"?H:[],typeof Set=="function"?W:[],typeof ArrayBuffer=="function"?ze:[],typeof Uint8Array=="function"?Ke:[],typeof DataView=="function"?He:[],typeof Intl<"u"?me:[],typeof crypto<"u"?j:[],typeof BigInt<"u"?[se,ge]:[])})}),it="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ot=new Uint8Array(256),ut=0;ut<it.length;ut++)ot[it.codePointAt(ut)]=ut;var vt=function(h,u,g){g==null&&(g=h.byteLength);for(var w=new Uint8Array(h,0,g),p=w.length,o="",I=0;I<p;I+=3)o+=it[w[I]>>2],o+=it[(w[I]&3)<<4|w[I+1]>>4],o+=it[(w[I+1]&15)<<2|w[I+2]>>6],o+=it[w[I+2]&63];return p%3===2?o=o.slice(0,-1)+"=":p%3===1&&(o=o.slice(0,-2)+"=="),o},St=function(h){var u=h.length,g=h.length*.75,w=0,p,o,I,R;h[h.length-1]==="="&&(g--,h[h.length-2]==="="&&g--);for(var s=new ArrayBuffer(g),_=new Uint8Array(s),F=0;F<u;F+=4)p=ot[h.codePointAt(F)],o=ot[h.codePointAt(F+1)],I=ot[h.codePointAt(F+2)],R=ot[h.codePointAt(F+3)],_[w++]=p<<2|o>>4,_[w++]=(o&15)<<4|I>>2,_[w++]=(I&3)<<6|R&63;return s},Ut=typeof self>"u"?global:self,At={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(b){var h=b,u=Ut[h];u&&(At[b.toLowerCase()+"2"]={test:function(g){return st.toStringTag(g)===h},replace:function(g){var w=g.buffer,p=g.byteOffset,o=g.length;return{buffer:w,byteOffset:p,length:o}},revive:function(g){var w=g.buffer,p=g.byteOffset,o=g.length;return new u(w,p,o)}})});var Rt={arraybuffer:{test:function(b){return st.toStringTag(b)==="ArrayBuffer"},replace:function(b){return vt(b,0,b.byteLength)},revive:function(b){var h=St(b);return h}}},Je=new st().register(Lt),xt="FileReaderSync"in self,ct=[],dt=0;Je.register([Rt,At,{blob2:{test:function(b){return st.toStringTag(b)==="Blob"},replace:function(b){if(b.isClosed)throw new Error("The Blob is closed");if(xt){var h=Ot(b,"binary"),u=vt(h,0,h.byteLength);return{type:b.type,data:u}}else{ct.push(b);var g={type:b.type,data:{start:dt,end:dt+b.size}};return dt+=b.size,g}},finalize:function(b,h){b.data=vt(h,0,h.byteLength)},revive:function(b){var h=b.type,u=b.data;return new Blob([St(u)],{type:h})}}}]),Je.mustFinalize=function(){return ct.length>0},Je.finalize=function(b){return Ze(void 0,void 0,void 0,function(){var h,u,g,w,p,o,I,R,s,_;return Ve(this,function(F){switch(F.label){case 0:return[4,wt(new Blob(ct),"binary")];case 1:if(h=F.sent(),b){for(u=0,g=b;u<g.length;u++)if(w=g[u],w.$types){p=w.$types,o=p.$,o&&(p=p.$);for(I in p)R=p[I],s=Je.types[R],s&&s.finalize&&(_=Be.default.getByKeyPath(w,o?"$."+I:I),s.finalize(_,h.slice(_.start,_.end)))}}return ct=[],[2]}})})};var Ft=2e3;function Tt(b,h){return Ze(this,void 0,void 0,function(){function u(){return Ze(this,void 0,void 0,function(){var F,he,Oe,J,V,ee,Ee,be,N,Ne;return Ve(this,function(K){switch(K.label){case 0:return[4,Promise.all(w.map(function(ne){return ne.count()}))];case 1:F=K.sent(),F.forEach(function(ne,re){return o[re].rowCount=ne}),_.totalRows=F.reduce(function(ne,re){return ne+re}),he=JSON.stringify(R,void 0,I?2:void 0),Oe=he.lastIndexOf("]"),J=he.substring(0,Oe),p.push(J),V=h.filter,ee=h.transform,Ee=function(ne){var re,Pe,c,r,m,f,Z,M,ie,ve,Se,Ce;return Ve(this,function(_e){switch(_e.label){case 0:re=b.table(ne),Pe=re.schema.primKey,c=!!Pe.keyPath,r=h.numRowsPerChunk||Ft,m=c?{tableName:re.name,inbound:!0,rows:[]}:{tableName:re.name,inbound:!1,rows:[]},f=JSON.stringify(m,void 0,I?2:void 0),I&&(f=f.split(`
`).join(`
    `)),Z=f.lastIndexOf("]"),p.push(f.substring(0,Z)),M=null,ie=0,ve=!0,Se=function(){var ce,de,ke,Ye,D,y,pe,Le,l,y;return Ve(this,function(d){switch(d.label){case 0:return s&&Be.default.ignoreTransaction(function(){return s(_)}),ce=M==null?re.limit(r):re.where(":id").above(M).limit(r),[4,ce.toArray()];case 1:return de=d.sent(),de.length===0?[2,"break"]:(M!=null&&ie>0&&(p.push(","),I&&p.push(`
      `)),ve=de.length===r,c?(ke=V?de.filter(function(v){return V(ne,v)}):de,Ye=ee?ke.map(function(v){return ee(ne,v).value}):ke,D=Ye.map(function(v){return Je.encapsulate(v)}),Je.mustFinalize()?[4,Be.default.waitFor(Je.finalize(D))]:[3,3]):[3,4]);case 2:d.sent(),d.label=3;case 3:return y=JSON.stringify(D,void 0,I?2:void 0),I&&(y=y.split(`
`).join(`
      `)),p.push(new Blob([y.substring(1,y.length-1)])),ie=Ye.length,M=de.length>0?Be.default.getByKeyPath(de[de.length-1],Pe.keyPath):null,[3,8];case 4:return[4,ce.primaryKeys()];case 5:return pe=d.sent(),Le=pe.map(function(v,A){return[v,de[A]]}),V&&(Le=Le.filter(function(v){var A=v[0],G=v[1];return V(ne,G,A)})),ee&&(Le=Le.map(function(v){var A=v[0],G=v[1],H=ee(ne,G,A);return[H.key,H.value]})),l=Le.map(function(v){return Je.encapsulate(v)}),Je.mustFinalize()?[4,Be.default.waitFor(Je.finalize(l))]:[3,7];case 6:d.sent(),d.label=7;case 7:y=JSON.stringify(l,void 0,I?2:void 0),I&&(y=y.split(`
`).join(`
      `)),p.push(new Blob([y.substring(1,y.length-1)])),ie=Le.length,M=pe.length>0?pe[pe.length-1]:null,d.label=8;case 8:return _.completedRows+=de.length,[2]}})},_e.label=1;case 1:return ve?[5,Se()]:[3,3];case 2:return Ce=_e.sent(),Ce==="break"?[3,3]:[3,1];case 3:return p.push(f.substr(Z)),_.completedTables+=1,_.completedTables<_.totalTables&&p.push(","),[2]}})},be=0,N=o,K.label=2;case 2:return be<N.length?(Ne=N[be].name,[5,Ee(Ne)]):[3,5];case 3:K.sent(),K.label=4;case 4:return be++,[3,2];case 5:return p.push(he.substr(Oe)),_.done=!0,s&&Be.default.ignoreTransaction(function(){return s(_)}),[2]}})})}var g,w,p,o,I,R,s,_;return Ve(this,function(F){switch(F.label){case 0:h=h||{},g=h.skipTables?h.skipTables:[],w=b.tables.filter(function(he){return!g.includes(he.name)}),p=[],o=w.map(function(he){return{name:he.name,schema:Ct(he),rowCount:0}}),I=h.prettyJson,R={formatName:"dexie",formatVersion:1,data:{databaseName:b.name,databaseVersion:b.verno,tables:o,data:[]}},s=h.progressCallback,_={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:o.length},F.label=1;case 1:return F.trys.push([1,,6,7]),h.noTransaction?[4,u()]:[3,3];case 2:return F.sent(),[3,5];case 3:return[4,b.transaction("r",b.tables,u)];case 4:F.sent(),F.label=5;case 5:return[3,7];case 6:return Je.finalize(),[7];case 7:return[2,new Blob(p,{type:"text/json"})]}})})}var Kt=1,Dt={Stream:function(){}},$t=yt(function(b,h){(function(u){var g=typeof process=="object"&&It?It:self;u.parser=function(c){return new Oe(c)},u.CParser=Oe,u.CStream=V,u.createStream=J,u.MAX_BUFFER_LENGTH=10*1024*1024,u.DEBUG=g.CDEBUG==="debug",u.INFO=g.CDEBUG==="debug"||g.CDEBUG==="info",u.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var w={textNode:void 0,numberNode:""},p=u.EVENTS.filter(function(c){return c!=="error"&&c!=="end"}),o=0,I;u.STATE={BEGIN:o++,VALUE:o++,OPEN_OBJECT:o++,CLOSE_OBJECT:o++,OPEN_ARRAY:o++,CLOSE_ARRAY:o++,TEXT_ESCAPE:o++,STRING:o++,BACKSLASH:o++,END:o++,OPEN_KEY:o++,CLOSE_KEY:o++,TRUE:o++,TRUE2:o++,TRUE3:o++,FALSE:o++,FALSE2:o++,FALSE3:o++,FALSE4:o++,NULL:o++,NULL2:o++,NULL3:o++,NUMBER_DECIMAL_POINT:o++,NUMBER_DIGIT:o++};for(var R in u.STATE)u.STATE[u.STATE[R]]=R;o=u.STATE;const s={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(c){function r(){this.__proto__=c}return r.prototype=c,new r}),Object.getPrototypeOf||(Object.getPrototypeOf=function(c){return c.__proto__}),Object.keys||(Object.keys=function(c){var r=[];for(var m in c)c.hasOwnProperty(m)&&r.push(m);return r});function _(c){var r=Math.max(u.MAX_BUFFER_LENGTH,10),m=0;for(var f in w){var Z=c[f]===void 0?0:c[f].length;if(Z>r)switch(f){case"text":closeText(c);break;default:K(c,"Max buffer length exceeded: "+f)}m=Math.max(m,Z)}c.bufferCheckPosition=u.MAX_BUFFER_LENGTH-m+c.position}function F(c){for(var r in w)c[r]=w[r]}var he=/[\\"\n]/g;function Oe(c){if(!(this instanceof Oe))return new Oe(c);var r=this;F(r),r.bufferCheckPosition=u.MAX_BUFFER_LENGTH,r.q=r.c=r.p="",r.opt=c||{},r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.state=o.BEGIN,r.stack=new Array,r.position=r.column=0,r.line=1,r.slashed=!1,r.unicodeI=0,r.unicodeS=null,r.depth=0,ee(r,"onready")}Oe.prototype={end:function(){ne(this)},write:Pe,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{I=Dt.Stream}catch{I=function(){}}function J(c){return new V(c)}function V(c){if(!(this instanceof V))return new V(c);this._parser=new Oe(c),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var r=this;I.apply(r),this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(m){r.emit("error",m),r._parser.error=null},p.forEach(function(m){Object.defineProperty(r,"on"+m,{get:function(){return r._parser["on"+m]},set:function(f){if(!f)return r.removeAllListeners(m),r._parser["on"+m]=f,f;r.on(m,f)},enumerable:!0,configurable:!1})})}V.prototype=Object.create(I.prototype,{constructor:{value:V}}),V.prototype.write=function(c){c=new Buffer(c);for(var r=0;r<c.length;r++){var m=c[r];if(this.bytes_remaining>0){for(var f=0;f<this.bytes_remaining;f++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+f]=c[f];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,r=r+f-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&m>=128)if(m>=194&&m<=223&&(this.bytes_in_sequence=2),m>=224&&m<=239&&(this.bytes_in_sequence=3),m>=240&&m<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+r>c.length){for(var Z=0;Z<=c.length-1-r;Z++)this.temp_buffs[this.bytes_in_sequence][Z]=c[r+Z];return this.bytes_remaining=r+this.bytes_in_sequence-c.length,!0}else{this.string=c.slice(r,r+this.bytes_in_sequence).toString(),r=r+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var M=r;M<c.length&&!(c[M]>=128);M++);this.string=c.slice(r,M).toString(),this._parser.write(this.string),this.emit("data",this.string),r=M-1}},V.prototype.end=function(c){return c&&c.length&&this._parser.write(c.toString()),this._parser.end(),!0},V.prototype.on=function(c,r){var m=this;return!m._parser["on"+c]&&p.indexOf(c)!==-1&&(m._parser["on"+c]=function(){var f=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);f.splice(0,0,c),m.emit.apply(m,f)}),I.prototype.on.call(m,c,r)},V.prototype.destroy=function(){F(this._parser),this.emit("close")};function ee(c,r,m){u.INFO&&console.log("-- emit",r,m),c[r]&&c[r](m)}function Ee(c,r,m){be(c),ee(c,r,m)}function be(c,r){c.textNode=Ne(c.opt,c.textNode),c.textNode!==void 0&&ee(c,r||"onvalue",c.textNode),c.textNode=void 0}function N(c){c.numberNode&&ee(c,"onvalue",parseFloat(c.numberNode)),c.numberNode=""}function Ne(c,r){return r===void 0||(c.trim&&(r=r.trim()),c.normalize&&(r=r.replace(/\s+/g," "))),r}function K(c,r){return be(c),r+=`
Line: `+c.line+`
Column: `+c.column+`
Char: `+c.c,r=new Error(r),c.error=r,ee(c,"onerror",r),c}function ne(c){return(c.state!==o.VALUE||c.depth!==0)&&K(c,"Unexpected end"),be(c),c.c="",c.closed=!0,ee(c,"onend"),Oe.call(c,c.opt),c}function re(c){return c===s.carriageReturn||c===s.lineFeed||c===s.space||c===s.tab}function Pe(c){var r=this;if(this.error)throw this.error;if(r.closed)return K(r,"Cannot write after close. Assign an onready handler.");if(c===null)return ne(r);var m=0,f=c.charCodeAt(0),Z=r.p;for(u.DEBUG&&console.log("write -> ["+c+"]");f&&(Z=f,r.c=f=c.charCodeAt(m++),Z!==f?r.p=Z:Z=r.p,!!f);)switch(u.DEBUG&&console.log(m,f,u.STATE[r.state]),r.position++,f===s.lineFeed?(r.line++,r.column=0):r.column++,r.state){case o.BEGIN:f===s.openBrace?r.state=o.OPEN_OBJECT:f===s.openBracket?r.state=o.OPEN_ARRAY:re(f)||K(r,"Non-whitespace before {[.");continue;case o.OPEN_KEY:case o.OPEN_OBJECT:if(re(f))continue;if(r.state===o.OPEN_KEY)r.stack.push(o.CLOSE_KEY);else if(f===s.closeBrace){ee(r,"onopenobject"),this.depth++,ee(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_OBJECT);f===s.doubleQuote?r.state=o.STRING:K(r,'Malformed object key should start with "');continue;case o.CLOSE_KEY:case o.CLOSE_OBJECT:if(re(f))continue;r.state,o.CLOSE_KEY,f===s.colon?(r.state===o.CLOSE_OBJECT?(r.stack.push(o.CLOSE_OBJECT),be(r,"onopenobject"),this.depth++):be(r,"onkey"),r.state=o.VALUE):f===s.closeBrace?(Ee(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE):f===s.comma?(r.state===o.CLOSE_OBJECT&&r.stack.push(o.CLOSE_OBJECT),be(r),r.state=o.OPEN_KEY):K(r,"Bad object");continue;case o.OPEN_ARRAY:case o.VALUE:if(re(f))continue;if(r.state===o.OPEN_ARRAY)if(ee(r,"onopenarray"),this.depth++,r.state=o.VALUE,f===s.closeBracket){ee(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_ARRAY);f===s.doubleQuote?r.state=o.STRING:f===s.openBrace?r.state=o.OPEN_OBJECT:f===s.openBracket?r.state=o.OPEN_ARRAY:f===s.t?r.state=o.TRUE:f===s.f?r.state=o.FALSE:f===s.n?r.state=o.NULL:f===s.minus?r.numberNode+="-":s._0<=f&&f<=s._9?(r.numberNode+=String.fromCharCode(f),r.state=o.NUMBER_DIGIT):K(r,"Bad value");continue;case o.CLOSE_ARRAY:if(f===s.comma)r.stack.push(o.CLOSE_ARRAY),be(r,"onvalue"),r.state=o.VALUE;else if(f===s.closeBracket)Ee(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;else{if(re(f))continue;K(r,"Bad array")}continue;case o.STRING:r.textNode===void 0&&(r.textNode="");var M=m-1,ie=r.slashed,ve=r.unicodeI;e:for(;;){for(u.DEBUG&&console.log(m,f,u.STATE[r.state],ie);ve>0;)if(r.unicodeS+=String.fromCharCode(f),f=c.charCodeAt(m++),r.position++,ve===4?(r.textNode+=String.fromCharCode(parseInt(r.unicodeS,16)),ve=0,M=m-1):ve++,!f)break e;if(f===s.doubleQuote&&!ie){r.state=r.stack.pop()||o.VALUE,r.textNode+=c.substring(M,m-1),r.position+=m-1-M;break}if(f===s.backslash&&!ie&&(ie=!0,r.textNode+=c.substring(M,m-1),r.position+=m-1-M,f=c.charCodeAt(m++),r.position++,!f))break;if(ie){if(ie=!1,f===s.n?r.textNode+=`
`:f===s.r?r.textNode+="\r":f===s.t?r.textNode+="	":f===s.f?r.textNode+="\f":f===s.b?r.textNode+="\b":f===s.u?(ve=1,r.unicodeS=""):r.textNode+=String.fromCharCode(f),f=c.charCodeAt(m++),r.position++,M=m-1,f)continue;break}he.lastIndex=m;var Se=he.exec(c);if(Se===null){m=c.length+1,r.textNode+=c.substring(M,m-1),r.position+=m-1-M;break}if(m=Se.index+1,f=c.charCodeAt(Se.index),!f){r.textNode+=c.substring(M,m-1),r.position+=m-1-M;break}}r.slashed=ie,r.unicodeI=ve;continue;case o.TRUE:f===s.r?r.state=o.TRUE2:K(r,"Invalid true started with t"+f);continue;case o.TRUE2:f===s.u?r.state=o.TRUE3:K(r,"Invalid true started with tr"+f);continue;case o.TRUE3:f===s.e?(ee(r,"onvalue",!0),r.state=r.stack.pop()||o.VALUE):K(r,"Invalid true started with tru"+f);continue;case o.FALSE:f===s.a?r.state=o.FALSE2:K(r,"Invalid false started with f"+f);continue;case o.FALSE2:f===s.l?r.state=o.FALSE3:K(r,"Invalid false started with fa"+f);continue;case o.FALSE3:f===s.s?r.state=o.FALSE4:K(r,"Invalid false started with fal"+f);continue;case o.FALSE4:f===s.e?(ee(r,"onvalue",!1),r.state=r.stack.pop()||o.VALUE):K(r,"Invalid false started with fals"+f);continue;case o.NULL:f===s.u?r.state=o.NULL2:K(r,"Invalid null started with n"+f);continue;case o.NULL2:f===s.l?r.state=o.NULL3:K(r,"Invalid null started with nu"+f);continue;case o.NULL3:f===s.l?(ee(r,"onvalue",null),r.state=r.stack.pop()||o.VALUE):K(r,"Invalid null started with nul"+f);continue;case o.NUMBER_DECIMAL_POINT:f===s.period?(r.numberNode+=".",r.state=o.NUMBER_DIGIT):K(r,"Leading zero not followed by .");continue;case o.NUMBER_DIGIT:s._0<=f&&f<=s._9?r.numberNode+=String.fromCharCode(f):f===s.period?(r.numberNode.indexOf(".")!==-1&&K(r,"Invalid number has two dots"),r.numberNode+="."):f===s.e||f===s.E?((r.numberNode.indexOf("e")!==-1||r.numberNode.indexOf("E")!==-1)&&K(r,"Invalid number has two exponential"),r.numberNode+="e"):f===s.plus||f===s.minus?(Z===s.e||Z===s.E||K(r,"Invalid symbol in number"),r.numberNode+=String.fromCharCode(f)):(N(r),m--,r.state=r.stack.pop()||o.VALUE);continue;default:K(r,"Unknown state: "+r.state)}return r.position>=r.bufferCheckPosition&&_(r),r}})(h)});function Et(b){var h=0,u=Vt(),g={pullAsync:function(w){return Ze(this,void 0,void 0,function(){var p,o,I;return Ve(this,function(R){switch(R.label){case 0:return p=b.slice(h,h+w),h+=w,[4,wt(p,"text")];case 1:return o=R.sent(),I=u.write(o),g.result=I||{},[2,I]}})})},pullSync:function(w){var p=b.slice(h,h+w);h+=w;var o=Ot(p,"text"),I=u.write(o);return g.result=I||{},I},done:function(){return u.done()},eof:function(){return h>=b.size},result:{}};return g}function Vt(b){var h=$t.parser(),u=0,g,w=[],p,o,I=!1,R=!1;return h.onopenobject=function(s){var _={};_.incomplete=!0,g||(g=_),p&&(w.push([o,p,R]),R?p.push(_):p[o]=_),p=_,o=s,R=!1,++u},h.onkey=function(s){return o=s},h.onvalue=function(s){return R?p.push(s):p[o]=s},h.oncloseobject=function(){var s;delete p.incomplete,o=null,--u===0?I=!0:(s=w.pop(),o=s[0],p=s[1],R=s[2])},h.onopenarray=function(){var s=[];s.incomplete=!0,g||(g=s),p&&(w.push([o,p,R]),R?p.push(s):p[o]=s),p=s,R=!0,o=null,++u},h.onclosearray=function(){var s;delete p.incomplete,o=null,--u===0?I=!0:(s=w.pop(),o=s[0],p=s[1],R=s[2])},{write:function(s){return h.write(s),g},done:function(){return I}}}var _t=1024;function Nt(b,h){return Ze(this,void 0,void 0,function(){var u,g,w,p;return Ve(this,function(o){switch(o.label){case 0:return h=h||{},u=h.chunkSizeBytes||_t*1024,[4,Pt(b,u)];case 1:return g=o.sent(),w=g.result.data,p=new Be.default(w.databaseName),p.version(w.databaseVersion).stores(kt(w)),[4,ht(p,g,h)];case 2:return o.sent(),[2,p]}})})}function Jt(b){return Ze(this,void 0,void 0,function(){var h;return Ve(this,function(u){switch(u.label){case 0:h=Et(b),u.label=1;case 1:return h.eof()?[3,3]:[4,h.pullAsync(5*1024)];case 2:return u.sent(),h.result.data&&h.result.data.data?(delete h.result.data.data,[3,3]):[3,1];case 3:return[2,h.result]}})})}function ht(b,h,u){return Ze(this,void 0,void 0,function(){function g(){return Ze(this,void 0,void 0,function(){var V,ee,Ee,be,N;return Ve(this,function(Ne){switch(Ne.label){case 0:V=function(K){var ne,re,Pe,c,r,m,f,Z,M,ie,ve,Se,Ce;return Ve(this,function(_e){switch(_e.label){case 0:if(s.includes(K.tableName))return[2,"continue"];if(!K.rows)return[2,"break"];if(!K.rows.incomplete&&K.rows.length===0)return[2,"continue"];if(_&&Be.default.ignoreTransaction(function(){return _(F)}),ne=K.tableName,re=b.table(ne),Pe=R.tables.filter(function(ce){return ce.name===ne})[0].schema,!re){if(u.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(K.tableName," is missing in installed database"))}if(!u.acceptChangedPrimaryKey&&Pe.split(",")[0]!=re.schema.primKey.src)throw new Error("Primary key differs for table ".concat(K.tableName,". "));for(c=K.rows,r=[],m=0;m<c.length&&(f=c[m],!f.incomplete);m++)r.push(Je.revive(f));return Z=u.filter,M=u.transform,ie=Z?K.inbound?r.filter(function(ce){return Z(ne,ce)}):r.filter(function(ce){var de=ce[0],ke=ce[1];return Z(ne,ke,de)}):r,M&&(ie=ie.map(K.inbound?function(ce){return M(ne,ce).value}:function(ce){var de=ce[0],ke=ce[1],Ye=M(ne,ke,de);return[Ye.key,Ye.value]})),ve=K.inbound?[void 0,ie]:[ie.map(function(ce){return ce[0]}),r.map(function(ce){return ce[1]})],Se=ve[0],Ce=ve[1],u.overwriteValues?[4,re.bulkPut(Ce,Se)]:[3,2];case 1:return _e.sent(),[3,4];case 2:return[4,re.bulkAdd(Ce,Se)];case 3:_e.sent(),_e.label=4;case 4:return F.completedRows+=r.length,r.incomplete||(F.completedTables+=1),c.splice(0,r.length),[2]}})},ee=0,Ee=R.data,Ne.label=1;case 1:return ee<Ee.length?(be=Ee[ee],[5,V(be)]):[3,4];case 2:if(N=Ne.sent(),N==="break")return[3,4];Ne.label=3;case 3:return ee++,[3,1];case 4:for(;R.data.length>0&&R.data[0].rows&&!R.data[0].rows.incomplete;)R.data.splice(0,1);return!p.done()&&!p.eof()?I?(p.pullSync(w),[3,7]):[3,5]:[3,8];case 5:return[4,Be.default.waitFor(p.pullAsync(w))];case 6:Ne.sent(),Ne.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var w,p,o,I,R,s,_,F,he,Oe,J;return Ve(this,function(V){switch(V.label){case 0:return u=u||{},w=u.chunkSizeBytes||_t*1024,[4,Pt(h,w)];case 1:if(p=V.sent(),o=p.result,I="FileReaderSync"in self,R=o.data,s=u.skipTables?u.skipTables:[],!u.acceptNameDiff&&b.name!==R.databaseName)throw new Error("Name differs. Current database name is ".concat(b.name," but export is ").concat(R.databaseName));if(!u.acceptVersionDiff&&b.verno!==R.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(b.verno," but export is ").concat(R.databaseVersion));if(_=u.progressCallback,F={done:!1,completedRows:0,completedTables:0,totalRows:R.tables.reduce(function(ee,Ee){return ee+Ee.rowCount},0),totalTables:R.tables.length},_&&Be.default.ignoreTransaction(function(){return _(F)}),!u.clearTablesBeforeImport)return[3,5];he=0,Oe=b.tables,V.label=2;case 2:return he<Oe.length?(J=Oe[he],s.includes(J.name)?[3,4]:[4,J.clear()]):[3,5];case 3:V.sent(),V.label=4;case 4:return he++,[3,2];case 5:return u.noTransaction?[4,g()]:[3,7];case 6:return V.sent(),[3,9];case 7:return[4,b.transaction("rw",b.tables,g)];case 8:V.sent(),V.label=9;case 9:return F.done=!0,_&&Be.default.ignoreTransaction(function(){return _(F)}),[2]}})})}function Pt(b,h){return Ze(this,void 0,void 0,function(){var u,g;return Ve(this,function(w){switch(w.label){case 0:u="slice"in b?Et(b):b,w.label=1;case 1:return u.eof()?[3,3]:[4,u.pullAsync(h)];case 2:return w.sent(),u.result.data&&u.result.data.data?[3,3]:[3,1];case 3:if(g=u.result,!g||g.formatName!="dexie")throw new Error("Given file is not a dexie export");if(g.formatVersion>Kt)throw new Error("Format version ".concat(g.formatVersion," not supported"));if(!g.data)throw new Error("No data in export file");if(!g.data.databaseName)throw new Error("Missing databaseName in export file");if(!g.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!g.data.tables)throw new Error("Missing tables in export file");return[2,u]}})})}Be.default.prototype.export=function(b){return Tt(this,b)},Be.default.prototype.import=function(b,h){return ht(this,b,h)},Be.default.import=function(b,h){return Nt(b,h)};var Mt=function(){throw new Error("This addon extends Dexie.prototype globally and does not have be included in Dexie constructor's addons options.")};xe.default=Mt,xe.exportDB=Tt,xe.importDB=Nt,xe.importInto=ht,xe.peakImportFile=Jt,Object.defineProperty(xe,"__esModule",{value:!0})})});export default Yt();
